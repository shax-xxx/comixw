<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ComixWall ISG Administration Interface: Apachelogs Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li class="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>Apachelogs Class Reference</h1><!-- doxytag: class="Apachelogs" --><!-- doxytag: inherits="View,Apache" --><div class="dynheader">
Inheritance diagram for Apachelogs:</div>
<div class="dynsection">
<p><center><img src="classApachelogs__inherit__graph.png" border="0" usemap="#Apachelogs__inherit__map" alt="Inheritance graph"></center>
<map name="Apachelogs__inherit__map">
<area shape="rect" href="classView.html" title="View" alt="" coords="5,7,56,33"><area shape="rect" href="classApache.html" title="Apache" alt="" coords="68,84,137,111"><area shape="rect" href="classModel.html" title="Model" alt="" coords="80,7,139,33"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for Apachelogs:</div>
<div class="dynsection">
<p><center><img src="classApachelogs__coll__graph.png" border="0" usemap="#Apachelogs__coll__map" alt="Collaboration graph"></center>
<map name="Apachelogs__coll__map">
<area shape="rect" href="classView.html" title="View" alt="" coords="5,103,56,129"><area shape="rect" href="classApache.html" title="Apache" alt="" coords="68,183,137,209"><area shape="rect" href="classModel.html" title="Model" alt="" coords="80,103,139,129"><area shape="rect" title="PROC_STAT_TIMEOUT" alt="" coords="105,31,113,39"><area shape="rect" title="PROC_STAT_TIMEOUT" alt="" coords="105,99,113,107"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classApachelogs-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#ce114fa7c97b8948b923637bed3f0409">ParseLogLine</a> ($logline, &amp;$cols)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log parser.  <a href="#ce114fa7c97b8948b923637bed3f0409"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#6a610b45210a1224d1d7ae0406bc923a">Apachelogs</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#d46ae5dc57aa6f030305d49183ff743c">FormatDate</a> ($date)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generic date array to string formatter.  <a href="#d46ae5dc57aa6f030305d49183ff743c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#af30d16eeca570bc1110e829e20954e1">FormatDateArray</a> ($datestr, &amp;$date)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Date string to array formatter.  <a href="#af30d16eeca570bc1110e829e20954e1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#71f084fa15e3c3c811cd73a5516fcd15">$Name</a> = 'apachelogs'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#f6126a5b3bab3dcda4296803b0f5d995">$LogFile</a> = '/var/www/logs/access_log'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classApachelogs.html#07fdabfe0d39ac4dcb19c8da0d3514d0">$Model</a> = 'apachelogs'</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="apachelogs_8php-source.html#l00042">42</a> of file <a class="el" href="apachelogs_8php-source.html">apachelogs.php</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="ce114fa7c97b8948b923637bed3f0409"></a><!-- doxytag: member="Apachelogs::ParseLogLine" ref="ce114fa7c97b8948b923637bed3f0409" args="($logline, &amp;$cols)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::ParseLogLine           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>cols</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Log parser. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logline</em>&nbsp;</td><td>string Log line </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$cols</em>&nbsp;</td><td>array Parsed fields </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if log line is parsed </dd></dl>

<p>Reimplemented from <a class="el" href="classApache.html#e19dcac31ffb3970b0f513692d953e60">Apache</a>.</p>

<p>Definition at line <a class="el" href="apachelogs_8php-source.html#l00048">48</a> of file <a class="el" href="apachelogs_8php-source.html">apachelogs.php</a>.</p>

<p>References <a class="el" href="defs_8php-source.html#l00153">$Re_Ip</a>, and <a class="el" href="model_8php-source.html#l01910">Model::ParseSyslogLine()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00049"></a>00049     {
<a name="l00050"></a>00050         global <a class="code" href="defs_8php.html#d4c5dcc02e4d7d3548d600b54b954bcd" title="Common regexps.">$Re_Ip</a>;
<a name="l00051"></a>00051     
<a name="l00052"></a>00052         <span class="comment">//10.0.0.11 - - [26/Sep/2009:03:03:45 +0300] "GET /symon/graph.php?61ea9e7cb820b19cc116fc5eb37490de HTTP/1.1" 200 31949</span>
<a name="l00053"></a>00053         <span class="comment">//10.0.0.11 - - [26/Sep/2009:03:04:23 +0300] "GET /images/run.png HTTP/1.1" 304 -</span>
<a name="l00054"></a>00054         <span class="comment">//10.0.0.11 - - [25/Sep/2009:20:05:54 +0300] "POST /snortips/conf.php HTTP/1.1" 200 11063</span>
<a name="l00055"></a>00055         <span class="comment">//10.0.0.11 - - [08/Oct/2009:12:56:03 +0300] "GET / HTTP/1.1" 302 5</span>
<a name="l00056"></a>00056         $datetime= '\[(\d+\/\w+\/\d+):(\d+:\d+:\d+)\s*[\w+]*\]';
<a name="l00057"></a>00057         $ip= <span class="stringliteral">"($Re_Ip)"</span>;
<a name="l00058"></a>00058         $mtd= '(GET|POST|\S+)';
<a name="l00059"></a>00059         $link= '(\S*)';
<a name="l00060"></a>00060         $code= '(\d+)';
<a name="l00061"></a>00061         $size= '(\d+|-)';
<a name="l00062"></a>00062 
<a name="l00063"></a>00063         $re= <span class="stringliteral">"/^$ip\s+.*\s+$datetime\s+\"$mtd\s+$link\s+HTTP\/\d+\.\d+\"\s+$code\s+$size$/"</span>;
<a name="l00064"></a>00064         <span class="keywordflow">if</span> (preg_match($re, $logline, $match)) {
<a name="l00065"></a>00065             $cols['<a class="code" href="defs_8php.html#16e3cb232d173c8a2ef726cc184d5c38">IP</a>']= $match[1];
<a name="l00066"></a>00066             $cols['Date']= $match[2];
<a name="l00067"></a>00067             $cols['Time']= $match[3];
<a name="l00068"></a>00068             $cols['DateTime']= $cols['Date'].<span class="charliteral">' '</span>.$cols['Time'];;
<a name="l00069"></a>00069             $cols['Mtd']= $match[4];
<a name="l00070"></a>00070             $cols['Link']= $match[5];
<a name="l00071"></a>00071             $cols['Code']= $match[6];
<a name="l00072"></a>00072             $cols['Size']= $match[7];
<a name="l00073"></a>00073             <span class="keywordflow">if</span> ($cols['Size'] == <span class="charliteral">'-'</span>) {
<a name="l00074"></a>00074                 $cols['Size']= 0;
<a name="l00075"></a>00075             }
<a name="l00076"></a>00076             <span class="keywordflow">return</span> TRUE;
<a name="l00077"></a>00077         }
<a name="l00078"></a>00078         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line.">ParseSyslogLine</a>($logline, $cols)) {
<a name="l00079"></a>00079             $cols['DateTime']= $cols['Date'].<span class="charliteral">' '</span>.$cols['Time'];
<a name="l00080"></a>00080             $cols['<a class="code" href="defs_8php.html#16e3cb232d173c8a2ef726cc184d5c38">IP</a>']= _('NA');
<a name="l00081"></a>00081             <span class="keywordflow">return</span> TRUE;
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083         <span class="keywordflow">return</span> FALSE;
<a name="l00084"></a>00084     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classApachelogs_ce114fa7c97b8948b923637bed3f0409_cgraph.png" border="0" usemap="#classApachelogs_ce114fa7c97b8948b923637bed3f0409_cgraph_map" alt=""></center>
<map name="classApachelogs_ce114fa7c97b8948b923637bed3f0409_cgraph_map">
<area shape="rect" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line." alt="" coords="247,5,420,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="6a610b45210a1224d1d7ae0406bc923a"></a><!-- doxytag: member="Apachelogs::Apachelogs" ref="6a610b45210a1224d1d7ae0406bc923a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::Apachelogs           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="apache_2include_8accesslogs_8php-source.html#l00043">43</a> of file <a class="el" href="apache_2include_8accesslogs_8php-source.html">include.accesslogs.php</a>.</p>

<p>References <a class="el" href="lib_2lib_8php-source.html#l00128">_HELPWINDOW()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00044"></a>00044     {
<a name="l00045"></a>00045         $this-&gt;LogsHelpMsg= <a class="code" href="lib_2lib_8php.html#249b79962f39cf1d037dfa8095060820" title="For classifying gettext strings into files.">_HELPWINDOW</a>('These are access logs of the <a class="code" href="classApache.html">Apache</a> web server. Logs contain logged-in users, client <a class="code" href="defs_8php.html#16e3cb232d173c8a2ef726cc184d5c38">IP</a> addresses, and pages accessed.');
<a name="l00046"></a>00046     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classApachelogs_6a610b45210a1224d1d7ae0406bc923a_cgraph.png" border="0" usemap="#classApachelogs_6a610b45210a1224d1d7ae0406bc923a_cgraph_map" alt=""></center>
<map name="classApachelogs_6a610b45210a1224d1d7ae0406bc923a_cgraph_map">
<area shape="rect" href="lib_2lib_8php.html#249b79962f39cf1d037dfa8095060820" title="For classifying gettext strings into files." alt="" coords="229,5,355,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="d46ae5dc57aa6f030305d49183ff743c"></a><!-- doxytag: member="Apachelogs::FormatDate" ref="d46ae5dc57aa6f030305d49183ff743c" args="($date)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::FormatDate           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>date</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generic date array to string formatter. 
<p>
Assumes standard syslog date format for the output string.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$date</em>&nbsp;</td><td>array Datetime struct </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>string Date string </dd></dl>

<p>Reimplemented from <a class="el" href="classView.html#015b13618aa2332a7f096b8c628ed61b">View</a>.</p>

<p>Definition at line <a class="el" href="apache_2include_8accesslogs_8php-source.html#l00048">48</a> of file <a class="el" href="apache_2include_8accesslogs_8php-source.html">include.accesslogs.php</a>.</p>

<p>References <a class="el" href="defs_8php-source.html#l00101">$MonthNames</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00049"></a>00049     {
<a name="l00050"></a>00050         global <a class="code" href="defs_8php.html#4ce923af45f11d3c8c5488c75cdefbb5" title="Used for months translation from number to string.">$MonthNames</a>;
<a name="l00051"></a>00051         
<a name="l00052"></a>00052         <span class="keywordflow">return</span> $date['Day'].<span class="charliteral">'/'</span>.$MonthNames[$date['Month']].<span class="charliteral">'/'</span>.date(<span class="charliteral">'Y'</span>);
<a name="l00053"></a>00053     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="af30d16eeca570bc1110e829e20954e1"></a><!-- doxytag: member="Apachelogs::FormatDateArray" ref="af30d16eeca570bc1110e829e20954e1" args="($datestr, &amp;$date)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::FormatDateArray           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>datestr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>date</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Date string to array formatter. 
<p>
Assumes standard syslog date format for the output string. Does the opposite of <a class="el" href="classApachelogs.html#d46ae5dc57aa6f030305d49183ff743c" title="Generic date array to string formatter.">FormatDate()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$datestr</em>&nbsp;</td><td>string Date as string </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$date</em>&nbsp;</td><td>array Datetime output</td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000049">Todo:</a></b></dt><dd>Check if empty Year is ok around new year's day </dd></dl>

<p>Reimplemented from <a class="el" href="classView.html#ac88ee7a096cd098b4d6d85deec9bedb">View</a>.</p>

<p>Definition at line <a class="el" href="apache_2include_8accesslogs_8php-source.html#l00055">55</a> of file <a class="el" href="apache_2include_8accesslogs_8php-source.html">include.accesslogs.php</a>.</p>

<p>References <a class="el" href="defs_8php-source.html#l00117">$MonthNumbers</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00056"></a>00056     {
<a name="l00057"></a>00057         global <a class="code" href="defs_8php.html#4281598b07b2ade20b01086ecbd3417e" title="Used for months translation from string to number.">$MonthNumbers</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059         <span class="keywordflow">if</span> (preg_match('/^(\d+)\/(\w+)\/(\d+)$/', $datestr, $match)) {
<a name="l00060"></a>00060             $date['Day']= $match[1];
<a name="l00061"></a>00061             $date['Month']= $MonthNumbers[$match[2]];
<a name="l00062"></a>00062             <span class="keywordflow">return</span> TRUE;
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preg_match('/(\w+)\s+(\d+)/', $datestr, $match)) {
<a name="l00065"></a>00065             <span class="keywordflow">if</span> (array_key_exists($match[1], $MonthNumbers)) {
<a name="l00066"></a>00066                 $date['Month']= sprintf('%02d', $MonthNumbers[$match[1]]);
<a name="l00067"></a>00067                 $date['Day']= sprintf('%02d', $match[2]);
<a name="l00068"></a>00068                 <span class="keywordflow">return</span> TRUE;
<a name="l00069"></a>00069             }
<a name="l00070"></a>00070         }
<a name="l00071"></a>00071         <span class="keywordflow">return</span> FALSE;
<a name="l00072"></a>00072     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="71f084fa15e3c3c811cd73a5516fcd15"></a><!-- doxytag: member="Apachelogs::$Name" ref="71f084fa15e3c3c811cd73a5516fcd15" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::$Name = 'apachelogs'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented from <a class="el" href="classApache.html#d9e31dee6882f67b0b3f449615c1a543">Apache</a>.</p>

<p>Definition at line <a class="el" href="apachelogs_8php-source.html#l00044">44</a> of file <a class="el" href="apachelogs_8php-source.html">apachelogs.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="f6126a5b3bab3dcda4296803b0f5d995"></a><!-- doxytag: member="Apachelogs::$LogFile" ref="f6126a5b3bab3dcda4296803b0f5d995" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::$LogFile = '/var/www/logs/access_log'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented from <a class="el" href="classApache.html#fe01aa85ca55dc2c29f2523abb0dce78">Apache</a>.</p>

<p>Definition at line <a class="el" href="apachelogs_8php-source.html#l00046">46</a> of file <a class="el" href="apachelogs_8php-source.html">apachelogs.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="07fdabfe0d39ac4dcb19c8da0d3514d0"></a><!-- doxytag: member="Apachelogs::$Model" ref="07fdabfe0d39ac4dcb19c8da0d3514d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Apachelogs::$<a class="el" href="classModel.html">Model</a> = 'apachelogs'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented from <a class="el" href="classApache.html#37a6e301a57271be0e3dae039958777d">Apache</a>.</p>

<p>Definition at line <a class="el" href="apache_2include_8accesslogs_8php-source.html#l00041">41</a> of file <a class="el" href="apache_2include_8accesslogs_8php-source.html">include.accesslogs.php</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Model/<a class="el" href="apachelogs_8php-source.html">apachelogs.php</a><li>View/apache/<a class="el" href="apache_2include_8accesslogs_8php-source.html">include.accesslogs.php</a></ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Dec 8 14:10:29 2009 for ComixWall ISG Administration Interface by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
