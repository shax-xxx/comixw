<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ComixWall ISG Administration Interface: Model Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li class="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>Model Class Reference</h1><!-- doxytag: class="Model" --><div class="dynheader">
Inheritance diagram for Model:</div>
<div class="dynsection">
<p><center><img src="classModel__inherit__graph.png" border="0" usemap="#Model__inherit__map" alt="Inheritance graph"></center>
<map name="Model__inherit__map">
<area shape="rect" href="classApache.html" title="Apache" alt="" coords="137,31,207,57"><area shape="rect" href="classClamav.html" title="Clamav" alt="" coords="136,81,208,108"><area shape="rect" href="classClamd.html" title="Clamd" alt="" coords="140,132,204,159"><area shape="rect" href="classDansguardian.html" title="Dansguardian" alt="" coords="117,183,227,209"><area shape="rect" href="classDante.html" title="Dante" alt="" coords="141,233,203,260"><area shape="rect" href="classDhcpd.html" title="Dhcpd" alt="" coords="141,284,203,311"><area shape="rect" href="classDocs.html" title="Docs" alt="" coords="145,335,199,361"><area shape="rect" href="classFreshclam.html" title="Freshclam" alt="" coords="128,385,216,412"><area shape="rect" href="classFtpproxy.html" title="Ftpproxy" alt="" coords="132,436,212,463"><area shape="rect" href="classImlogs.html" title="Imlogs" alt="" coords="140,487,204,513"><area shape="rect" href="classImspector.html" title="Imspector" alt="" coords="129,537,215,564"><area shape="rect" href="classMonitoring.html" title="Monitoring" alt="" coords="128,588,216,615"><area shape="rect" href="classNamed.html" title="Named" alt="" coords="137,639,207,665"><area shape="rect" href="classOpenssh.html" title="Openssh" alt="" coords="133,689,211,716"><area shape="rect" href="classOpenvpn.html" title="Openvpn" alt="" coords="132,740,212,767"><area shape="rect" href="classP3scan.html" title="P3scan" alt="" coords="139,791,205,817"><area shape="rect" href="classPf.html" title="Pf" alt="" coords="153,841,191,868"><area shape="rect" href="classPmacct.html" title="Pmacct" alt="" coords="137,892,207,919"><area shape="rect" href="classSmtpgated.html" title="Smtpgated" alt="" coords="125,943,219,969"><area shape="rect" href="classSnort.html" title="Snort" alt="" coords="144,993,200,1020"><area shape="rect" href="classSnortips.html" title="Snortips" alt="" coords="135,1044,209,1071"><area shape="rect" href="classSpamassassin.html" title="Spamassassin" alt="" coords="116,1095,228,1121"><area shape="rect" href="classSpamd.html" title="Spamd" alt="" coords="139,1145,205,1172"><area shape="rect" href="classSquid.html" title="Squid" alt="" coords="144,1196,200,1223"><area shape="rect" href="classSymon.html" title="Symon" alt="" coords="139,1247,205,1273"><area shape="rect" href="classSymux.html" title="Symux" alt="" coords="139,1297,205,1324"><area shape="rect" href="classSystem.html" title="System" alt="" coords="136,1348,208,1375"><area shape="rect" href="classApachelogs.html" title="Apachelogs" alt="" coords="299,5,392,32"><area shape="rect" href="classCwlogs.html" title="Cwlogs" alt="" coords="312,56,379,83"><area shape="rect" href="classCwc.html" title="Cwc" alt="" coords="469,31,517,57"><area shape="rect" href="classCwwui.html" title="Cwwui" alt="" coords="461,81,525,108"><area shape="rect" href="classBlacklists.html" title="Blacklists" alt="" coords="307,157,384,184"><area shape="rect" href="classDansguardianlogs.html" title="Dansguardianlogs" alt="" coords="277,208,413,235"><area shape="rect" href="classSnortalerts.html" title="Snortalerts" alt="" coords="299,993,392,1020"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for Model:</div>
<div class="dynsection">
<p><center><img src="classModel__coll__graph.png" border="0" usemap="#Model__coll__map" alt="Collaboration graph"></center>
<map name="Model__coll__map">
<area shape="rect" title="PROC_STAT_TIMEOUT" alt="" coords="31,31,39,39"><area shape="rect" title="PROC_STAT_TIMEOUT" alt="" coords="31,99,39,107"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classModel-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#e3b375de5f6df4faf74a95d64748e048">Model</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#769e2fd12ca0ef7003ca4abdb86168cb">GetIntIf</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get int_if.  <a href="#769e2fd12ca0ef7003ca4abdb86168cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a4b322dc7d0a9d3da132f5149880d437">GetExtIf</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get ext_if.  <a href="#a4b322dc7d0a9d3da132f5149880d437"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#c95892eaf9c6371e23720359a3ce8004">Restart</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Restart module processes.  <a href="#c95892eaf9c6371e23720359a3ce8004"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#2b5091c9fb872dccd476b2147d163e0d">GetStatsLogLines</a> ($logfile, $tail=-1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Builds generic grep command to extract log lines.  <a href="#2b5091c9fb872dccd476b2147d163e0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1">SearchFile</a> ($file, $re, $set=1, $trimchars= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Searches a given file with a given regexp.  <a href="#f2576452d0c09887bf098e304ab6d3e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#48a3385112dc3651c42b170325903ab1">SearchFileAll</a> ($file, $re, $set=1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Multi-searches a given file with a given regexp.  <a href="#48a3385112dc3651c42b170325903ab1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#3a3a50b49511d0d5f4373a15c83f60a8">ReplaceRegexp</a> ($file, $matchre, $replacere)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search and replace.  <a href="#3a3a50b49511d0d5f4373a15c83f60a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#2d12753c999aac330108a00dd0f3abec">RunShellCommand</a> ($cmd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Runs given shell command and returns its output as string.  <a href="#2d12753c999aac330108a00dd0f3abec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#9beaec250eb1d242282695035de7e01d">AppendToFile</a> ($file, $line)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Appends a string to a file.  <a href="#9beaec250eb1d242282695035de7e01d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#55b3f40ec612727a645a77896163f1d9">GetFiles</a> ($filepath)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns files with the given filepath pattern.  <a href="#55b3f40ec612727a645a77896163f1d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1">GetConfigValues</a> ($conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns all configuration for a given configuration type.  <a href="#4e346106b6f66e18e88b9d6c330655d1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd">GetValue</a> ($name, $conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns all enabled configuration for a given configuration type.  <a href="#bf6ca5f5f6d8e69581e3e8e190df92cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#bf62334346f19c56c5ed701af936ce66">GetDisabledValue</a> ($name, $conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns all disabled configuration for a given configuration type.  <a href="#bf62334346f19c56c5ed701af936ce66"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#f029e9daf3e62424861794f377f49ed6">GetNVP</a> ($file, $name, $trimchars= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads value of NVP.  <a href="#f029e9daf3e62424861794f377f49ed6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#651763904d218ee52464b258498c0255">GetDisabledNVP</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads value of commented-out NVP.  <a href="#651763904d218ee52464b258498c0255"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e">GetName</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if Name exists.  <a href="#fc563954e2d371ee98dce6b41b639e9e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f">GetDisabledName</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if commented-out Name exists.  <a href="#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#38785ba7c6f768435ca036c8377083b4">SetConfValue</a> ($name, $newvalue, $conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the value of NVP configuration.  <a href="#38785ba7c6f768435ca036c8377083b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#799897eaa58becf38f093bd89a3eb519">SetNVP</a> ($file, $name, $newvalue)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Changes value of NVP.  <a href="#799897eaa58becf38f093bd89a3eb519"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#d2e2c0802bba9a76b1fba3c9c9e31e6f">EnableConf</a> ($name, $conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables a configuration item in conf file.  <a href="#d2e2c0802bba9a76b1fba3c9c9e31e6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#20f53926124c84fffd476021fd6d58d7">DisableConf</a> ($name, $conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disables a configuration item in conf file.  <a href="#20f53926124c84fffd476021fd6d58d7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#2cf1196e1cd1e3a9a9e563ad2fbb6d94">EnableNVP</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables an NVP: configuration item with value.  <a href="#2cf1196e1cd1e3a9a9e563ad2fbb6d94"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ca7b6388df3d0c63a53fdf3a0c9704f1">EnableName</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables a Name: configuration item without value.  <a href="#ca7b6388df3d0c63a53fdf3a0c9704f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#da73681b1ab900e3a3065464ccc85bb9">DisableNVP</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disables an NVP.  <a href="#da73681b1ab900e3a3065464ccc85bb9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab46785c290382866a4696ef0e5df9ec">DisableName</a> ($file, $name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disables a Name.  <a href="#ab46785c290382866a4696ef0e5df9ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#26aeff109e6dbc24a2f7053966132b23">GetConfFile</a> ($conf, $group)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns configuration file of the module.  <a href="#26aeff109e6dbc24a2f7053966132b23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321">SetConfig</a> ($confname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets configuration file based on config type provided.  <a href="#b65c89562f51a2ec2c46ed622bfcd321"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#f50a822f45c1cd3b8aa5931d70e065c3">GetIpAddr</a> ($if)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extracts IP address assigned to an interface.  <a href="#f50a822f45c1cd3b8aa5931d70e065c3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#13d954623f5fdc936047f3273a20abd8">CheckAuthentication</a> ($user, $passwd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks user's password supplied against the one in htpasswd file.  <a href="#13d954623f5fdc936047f3273a20abd8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#66be6edcbd364e21485e03144cfa2a46">GetLogStartDate</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extracts the datetime of the first line in the log file.  <a href="#66be6edcbd364e21485e03144cfa2a46"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#3251fdfaf9bdde5a6ffb16a6b13e9717">GetFileFirstLine</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets first line of file.  <a href="#3251fdfaf9bdde5a6ffb16a6b13e9717"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28">GetFileLineCount</a> ($file, $re= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets line count of file.  <a href="#0e43ca38ee4cee9f29e6b8192024dc28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7f8992e5e1ce2fb1252e28a4697e1d8d">GetLogs</a> ($file, $end, $count, $re= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets lines in file.  <a href="#7f8992e5e1ce2fb1252e28a4697e1d8d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#4795ba110e63f9818b053f98bafb380e">GetLiveLogs</a> ($file, $count, $re= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets logs for live logs pages.  <a href="#4795ba110e63f9818b053f98bafb380e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7b9bda42c0ab93f85ad329597d8c7093">Reload</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends HUP to the module pid.  <a href="#7b9bda42c0ab93f85ad329597d8c7093"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#4cdbaac69ea2e094a98caae1cbb7f2aa">Start</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start module process(es).  <a href="#4cdbaac69ea2e094a98caae1cbb7f2aa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#abaab1028bd3cbc20d4bc77f8a222f98">Stop</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stops module process(es).  <a href="#abaab1028bd3cbc20d4bc77f8a222f98"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#9ae213c714d91523d650b34cea11dd75">Pkill</a> ($proc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stops the given process.  <a href="#9ae213c714d91523d650b34cea11dd75"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#0da158bc289bbdfdf7000f7466d90bbd">Kill</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stops module's parent process with its pid.  <a href="#0da158bc289bbdfdf7000f7466d90bbd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#facf369640096d263c1a6685f444d1d0">KillPid</a> ($pid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Kills process with the given pid.  <a href="#facf369640096d263c1a6685f444d1d0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a8e65c65a217937e4d65ed0be05b30c8">IsModulePidRunning</a> ($pid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the pid is running.  <a href="#a8e65c65a217937e4d65ed0be05b30c8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0">IsRunning</a> ($proc= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the process(es) is running.  <a href="#b72b9a2165463d9ed74e2387ad8902f0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#8e4d47e167d2ee8325f09289c7538c02">GetProcList</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the list of processes running.  <a href="#8e4d47e167d2ee8325f09289c7538c02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#87f2eb3dfeadfafef73376a1d5f23dbd">SelectProcesses</a> ($psout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Selects user processes from ps output.  <a href="#87f2eb3dfeadfafef73376a1d5f23dbd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#53a0b80bb9ba660edf934fcded32e1f4">GetVersion</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets software version string.  <a href="#53a0b80bb9ba660edf934fcded32e1f4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#647435ed6c63149c209b093518623a2e">GetServiceStatus</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets service statuses.  <a href="#647435ed6c63149c209b093518623a2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#e6a13e22597651045ca35dc07f71564b">GetProcStatLines</a> ($logfile)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Collects text statistics for the proc stats general page.  <a href="#e6a13e22597651045ca35dc07f71564b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#879745650e422e04795c973810fbf221">CopyLogFileToTmp</a> ($file, $tmpdir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uncompresses gzipped log file to tmp dir.  <a href="#879745650e422e04795c973810fbf221"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7af16fa26a00320fe042c822deebfab4">GetFileCvsTag</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns ComixWall cvs tag in the given file, if any.  <a href="#7af16fa26a00320fe042c822deebfab4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#0ae50b6dbbd53cc2db879f2aad4a6bb3">GetSysCtl</a> ($option)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets sysctl output for the given arg.  <a href="#0ae50b6dbbd53cc2db879f2aad4a6bb3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#79a6802745276910632fee29f9585495">GetFile</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads file contents.  <a href="#79a6802745276910632fee29f9585495"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7b4dfa63dc1823462b18efadd16b88b6">GetDefaultLogFile</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#3ff7381593aee6c57361809ac2a15228">SelectLogFile</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns log file under tmp location.  <a href="#3ff7381593aee6c57361809ac2a15228"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758">UpdateTmpLogFile</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copies original log file to tmp location.  <a href="#ad5ea6ecfd799e86a4bf8d951f377758"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#29102c6076b42c9519b995bc28aa979d">GetTmpLogFileName</a> ($file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the log file name in the tmp location.  <a href="#29102c6076b42c9519b995bc28aa979d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#d45004479b64ebb94297aa6b27ede5a8">GetLogFilesList</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets log files list with start dates.  <a href="#d45004479b64ebb94297aa6b27ede5a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#d3f83a4279c60fb4246e97f7fddd8863">DeleteFile</a> ($path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes file or dir.  <a href="#d3f83a4279c60fb4246e97f7fddd8863"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#cdf121f58a23152dcc4071dfe70db060">PutFile</a> ($file, $contents)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes contents to file.  <a href="#cdf121f58a23152dcc4071dfe70db060"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#26a9043009ddbda075cf8e890dbd28d9">GetPhyIfs</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract physical interface names from ifconfig output.  <a href="#26a9043009ddbda075cf8e890dbd28d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb">GetAllStats</a> ($logfile, $collecthours= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns both brief and full statistics.  <a href="#a2edac23e52476f8e5c70d9893bc1fcb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ffd6bba4698ad739939497598cadde66">GetStats</a> ($logfile, $date, $collecthours= '')</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main statistics collector, as module data set.  <a href="#ffd6bba4698ad739939497598cadde66"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13">CountDiffLogLines</a> ($logfile, &amp;$count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the number of lines added to log files since last tmp update.  <a href="#e87cab614cb0dda5a48a0483ad20bb13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f">UpdateStats</a> ($logfile, &amp;$stats, &amp;$briefstats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates statistics incrementally, both brief and full.  <a href="#2de95faa4fc211f54fcc882609ca4d7f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#96cdbca1cb750f08af734720ce035527">GetDateRegexp</a> ($date)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates date regexp to be used by statistics functions.  <a href="#96cdbca1cb750f08af734720ce035527"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#06a223ba294ce4dedc681900919c35b5">GetHourRegexp</a> ($date)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates hour regexp to be used by statistics functions.  <a href="#06a223ba294ce4dedc681900919c35b5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#71879d121d5eb29eefaca11136b08239">GetSavedStats</a> ($logfile, &amp;$stats, &amp;$briefstats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets saved statistics for the given log file.  <a href="#71879d121d5eb29eefaca11136b08239"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b">IsLogFileModified</a> ($logfile)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the given log file has been updated.  <a href="#5b128ecbe8f5dba639ac124a1306be2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb">GetStatsFileInfo</a> ($logfile, &amp;$linecount, &amp;$filestat)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets previous line count and stat() from statistics file.  <a href="#63f975dc16ccd933fe89d6c7b78b2ffb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#9832a4bcb216f976db39555e231ec2b5">GetStatsFileName</a> ($logfile)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets name of the tmp statistics file for the given log file.  <a href="#9832a4bcb216f976db39555e231ec2b5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f">GetOrigFileName</a> ($logfile)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the original file name for the given log file.  <a href="#7c82d9c0848789a5b3cc4be23c58f13f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#61048fb2a76e82a62bc1cb060f956846">SaveStats</a> ($logfile, $stats, $briefstats, $linecount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Saves collected statistics with current line count and stat() output.  <a href="#61048fb2a76e82a62bc1cb060f956846"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db">CollectDayStats</a> ($statsdefs, $values, $line, &amp;$stats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Day statistics collector.  <a href="#d94e185c4edbac25ceabb66fe5c7f4db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302">CollectHourStats</a> ($statsdefs, $<a class="el" href="pf_2graphs_8php.html#3bd52b79215c01cef0300d17ed34f299">hour</a>, $min, $values, $line, &amp;$daystats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hour statistics collector.  <a href="#eee718dc90c3fc97b8e613e5f5a0a302"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d">IncStats</a> ($line, $values, $statsdefs, &amp;$stats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increments stats for the given values.  <a href="#da770adbe085197a1fc3b64fc3fde31d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a">CollectMinuteStats</a> ($statsdefs, $min, $values, $line, &amp;$hourstats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Minute statistics collector.  <a href="#d11bfed931dee6dcda7576ab5a0d950a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#580c841570e910e36dbf9879e96ec7c7">ParseLogLine</a> ($logline, &amp;$cols)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log parser.  <a href="#580c841570e910e36dbf9879e96ec7c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#f0db0d28b44c9a296eea592c5c551969">ParseSyslogLine</a> ($logline, &amp;$cols)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parses standard syslog line.  <a href="#f0db0d28b44c9a296eea592c5c551969"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#b36f902ed1a1e77d4318d579fed718bc">$Name</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#dba4944c66dd108992af2cb507665c0e">$User</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#5e090e5f9335929f5d55d6b1d7a631af">$Proc</a> = ''</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><dl class="attention" compact><dt><b>Attention:</b></dt><dd>Should be updated in constructors of children </dd></dl>
 <a href="#5e090e5f9335929f5d55d6b1d7a631af"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#79553c4d5567284cae411eb24f02fb62">$NVPS</a> = '='</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#c89bbfa238d98b1caade5ce37a974d35">$COMC</a> = '#'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ffbf15b1c593584d9fc04185d70670d8">$ConfFile</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#7829b0e83a1ea86feed9cc9c7991c6ee">$Config</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#13a81d956649e70801f3f3a1781df1ab">$LogFile</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#3ba349aefdae544f17c56d9c3a1c5039">PROC_STAT_TIMEOUT</a> = 100</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Max number of iterations to try while starting or stopping processes.  <a href="#3ba349aefdae544f17c56d9c3a1c5039"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#8abff66b55e247f682f88c00e8f672a1">$CmdLogStart</a> = '/usr/bin/head -1 &lt;LF&gt;'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#40a24e5aafaaedbcfec96fabe72948c0">$VersionCmd</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ab3d4a12e5551e969b1b6a0e41963cd0">$StartCmd</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#4dc0ebdad4164197e5e8f30f1befea10">$PidFile</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#679e45c31619091fa5373874a18d201b">$TmpLogsDir</a> = ''</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#3234e8f3250cb93c8ec12a31d6557dc7">$PfRulesFile</a> = '/etc/pf.conf'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#06e22b4cd51d43fdd86c29712451b18e">$Commands</a> = array()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Argument lists and descriptions of commands.  <a href="#06e22b4cd51d43fdd86c29712451b18e"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ff07a2406d3ec8292cbba44852e4ee6e">$psCmd</a> = '/bin/ps arwwx -o pid,start,%cpu,time,%mem,rss,vsz,stat,pri,nice,tty,user,group,command | /usr/bin/grep -E &lt;PROC&gt;'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#f3d21f5d44702b4acc73ecf8b03ce61c">$passwdFile</a> = '/var/www/conf/.htpasswd'</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classApache.html">Apache</a> password file pathname.  <a href="#f3d21f5d44702b4acc73ecf8b03ce61c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#ac4f5362135543524c2c4012aaa55630">$newSyslogConf</a> = '/etc/newsyslog.conf'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classModel.html#2696bf46a626c73cf6952b40ac5fcea5">$rcConfLocal</a> = '/etc/rc.conf.local'</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="model_8php-source.html#l00040">40</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e3b375de5f6df4faf74a95d64748e048"></a><!-- doxytag: member="Model::Model" ref="e3b375de5f6df4faf74a95d64748e048" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Model           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>Is there any pattern or size for new value, 2nd param? </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00089">89</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="apache_8php-source.html#l00128">$ModelConfig</a>, <a class="el" href="model_8php-source.html#l00708">CheckAuthentication()</a>, <a class="el" href="dansguardian_2conf_8php-source.html#l00068">Config</a>, <a class="el" href="model_8php-source.html#l00620">DisableConf()</a>, <a class="el" href="model_8php-source.html#l00607">EnableConf()</a>, <a class="el" href="model_8php-source.html#l01396">GetAllStats()</a>, <a class="el" href="model_8php-source.html#l00437">GetConfigValues()</a>, <a class="el" href="model_8php-source.html#l01260">GetDefaultLogFile()</a>, <a class="el" href="model_8php-source.html#l00290">GetExtIf()</a>, <a class="el" href="model_8php-source.html#l01225">GetFileCvsTag()</a>, <a class="el" href="model_8php-source.html#l00784">GetFileLineCount()</a>, <a class="el" href="model_8php-source.html#l00283">GetIntIf()</a>, <a class="el" href="model_8php-source.html#l00837">GetLiveLogs()</a>, <a class="el" href="model_8php-source.html#l01331">GetLogFilesList()</a>, <a class="el" href="model_8php-source.html#l00806">GetLogs()</a>, <a class="el" href="model_8php-source.html#l00745">GetLogStartDate()</a>, <a class="el" href="model_8php-source.html#l01385">GetPhyIfs()</a>, <a class="el" href="model_8php-source.html#l01059">GetProcList()</a>, <a class="el" href="model_8php-source.html#l01157">GetProcStatLines()</a>, <a class="el" href="model_8php-source.html#l01122">GetServiceStatus()</a>, <a class="el" href="model_8php-source.html#l01424">GetStats()</a>, <a class="el" href="model_8php-source.html#l01242">GetSysCtl()</a>, <a class="el" href="model_8php-source.html#l01112">GetVersion()</a>, <a class="el" href="model_8php-source.html#l01040">IsRunning()</a>, <a class="el" href="model_8php-source.html#l00857">Reload()</a>, <a class="el" href="model_8php-source.html#l00297">Restart()</a>, <a class="el" href="model_8php-source.html#l01274">SelectLogFile()</a>, <a class="el" href="model_8php-source.html#l00544">SetConfValue()</a>, <a class="el" href="model_8php-source.html#l00877">Start()</a>, and <a class="el" href="model_8php-source.html#l00912">Stop()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00090"></a>00090     {
<a name="l00091"></a>00091         global <a class="code" href="apache_8php.html#7791894e7e1929c1d4d6df1961938101" title="Configuration.">$ModelConfig</a>;
<a name="l00092"></a>00092         
<a name="l00093"></a>00093         $this-&gt;Proc= $this-&gt;Name;
<a name="l00094"></a>00094         
<a name="l00095"></a>00095         $this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>= $ModelConfig;
<a name="l00096"></a>00096         
<a name="l00097"></a>00097         $this-&gt;TmpLogsDir= '/var/tmp/comixwall/logs/'.get_class($this).<span class="charliteral">'/'</span>;
<a name="l00098"></a>00098         
<a name="l00099"></a>00099         $this-&gt;Commands= array_merge(
<a name="l00100"></a>00100             $this-&gt;Commands,
<a name="l00101"></a>00101             array(
<a name="l00102"></a>00102                 '<a class="code" href="classModel.html#769e2fd12ca0ef7003ca4abdb86168cb" title="Get int_if.">GetIntIf</a>'=&gt;    array(
<a name="l00103"></a>00103                     'argv'  =&gt;  array(),
<a name="l00104"></a>00104                     'desc'  =&gt;  _('Get int_if'),
<a name="l00105"></a>00105                     ),
<a name="l00106"></a>00106                 
<a name="l00107"></a>00107                 '<a class="code" href="classModel.html#a4b322dc7d0a9d3da132f5149880d437" title="Get ext_if.">GetExtIf</a>'=&gt;    array(
<a name="l00108"></a>00108                     'argv'  =&gt;  array(),
<a name="l00109"></a>00109                     'desc'  =&gt;  _('Get ext_if'),
<a name="l00110"></a>00110                     ),
<a name="l00111"></a>00111                 
<a name="l00112"></a>00112                 '<a class="code" href="classModel.html#53a0b80bb9ba660edf934fcded32e1f4" title="Gets software version string.">GetVersion</a>'    =&gt;  array(
<a name="l00113"></a>00113                     'argv'  =&gt;  array(),
<a name="l00114"></a>00114                     'desc'  =&gt;  _('Get software version'),
<a name="l00115"></a>00115                     ),
<a name="l00116"></a>00116 
<a name="l00117"></a>00117                 '<a class="code" href="classModel.html#7b9bda42c0ab93f85ad329597d8c7093" title="Sends HUP to the module pid.">Reload</a>'    =&gt;  array(
<a name="l00118"></a>00118                     'argv'  =&gt;  array(),
<a name="l00119"></a>00119                     'desc'  =&gt;  _('<a class="code" href="classModel.html#7b9bda42c0ab93f85ad329597d8c7093" title="Sends HUP to the module pid.">Reload</a> '.get_class($this)),
<a name="l00120"></a>00120                     ),
<a name="l00121"></a>00121                 
<a name="l00122"></a>00122                 '<a class="code" href="classModel.html#4cdbaac69ea2e094a98caae1cbb7f2aa" title="Start module process(es).">Start</a>' =&gt;  array(
<a name="l00123"></a>00123                     'argv'  =&gt;  array(),
<a name="l00124"></a>00124                     'desc'  =&gt;  _('<a class="code" href="classModel.html#4cdbaac69ea2e094a98caae1cbb7f2aa" title="Start module process(es).">Start</a> '.get_class($this)),
<a name="l00125"></a>00125                     ),
<a name="l00126"></a>00126                 
<a name="l00127"></a>00127                 '<a class="code" href="classModel.html#c95892eaf9c6371e23720359a3ce8004" title="Restart module processes.">Restart</a>'   =&gt; array(
<a name="l00128"></a>00128                     'argv'  =&gt; array(),
<a name="l00129"></a>00129                     'desc'  =&gt; _('<a class="code" href="classModel.html#c95892eaf9c6371e23720359a3ce8004" title="Restart module processes.">Restart</a> '.get_class($this)),
<a name="l00130"></a>00130                     ),
<a name="l00131"></a>00131 
<a name="l00132"></a>00132                 '<a class="code" href="classModel.html#abaab1028bd3cbc20d4bc77f8a222f98" title="Stops module process(es).">Stop</a>'  =&gt;  array(
<a name="l00133"></a>00133                     'argv'  =&gt;  array(),
<a name="l00134"></a>00134                     'desc'  =&gt; _('<a class="code" href="classModel.html#abaab1028bd3cbc20d4bc77f8a222f98" title="Stops module process(es).">Stop</a> '.get_class($this)),
<a name="l00135"></a>00135                     ),
<a name="l00136"></a>00136                 
<a name="l00137"></a>00137                 '<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>' =&gt;  array(
<a name="l00138"></a>00138                     'argv'  =&gt;  array(),
<a name="l00139"></a>00139                     'desc'  =&gt;  _('Check <span class="keywordflow">if</span> process running'),
<a name="l00140"></a>00140                     ),
<a name="l00141"></a>00141 
<a name="l00142"></a>00142                 '<a class="code" href="classModel.html#8e4d47e167d2ee8325f09289c7538c02" title="Gets the list of processes running.">GetProcList</a>'   =&gt;  array(
<a name="l00143"></a>00143                     'argv'  =&gt;  array(),
<a name="l00144"></a>00144                     'desc'  =&gt;  _('Get process list'),
<a name="l00145"></a>00145                     ),
<a name="l00146"></a>00146 
<a name="l00147"></a>00147                 '<a class="code" href="classModel.html#647435ed6c63149c209b093518623a2e" title="Gets service statuses.">GetServiceStatus</a>'  =&gt;  array(
<a name="l00148"></a>00148                     'argv'  =&gt;  array(),
<a name="l00149"></a>00149                     'desc'  =&gt;  _('Get service status'),
<a name="l00150"></a>00150                     ),
<a name="l00151"></a>00151                 
<a name="l00152"></a>00152                 '<a class="code" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics.">GetAllStats</a>'=&gt; array(
<a name="l00153"></a>00153                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>, <a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00154"></a>00154                     'desc'  =&gt;  _('Get all stats'),
<a name="l00155"></a>00155                     ),
<a name="l00156"></a>00156                 
<a name="l00157"></a>00157                 '<a class="code" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set.">GetStats</a>'=&gt;    array(
<a name="l00158"></a>00158                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>, <a class="code" href="Controller_2lib_8php.html#9b5fac37f2254a4242eec95be9335c1c">SERIALARRAY</a>, <a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00159"></a>00159                     'desc'  =&gt;  _('Get stats'),
<a name="l00160"></a>00160                     ),
<a name="l00161"></a>00161                 
<a name="l00162"></a>00162                 '<a class="code" href="classModel.html#26a9043009ddbda075cf8e890dbd28d9" title="Extract physical interface names from ifconfig output.">GetPhyIfs</a>'     =&gt;  array(
<a name="l00163"></a>00163                     'argv'  =&gt;  array(),
<a name="l00164"></a>00164                     'desc'  =&gt;  _('List physical interfaces'),
<a name="l00165"></a>00165                     ),
<a name="l00166"></a>00166 
<a name="l00167"></a>00167                 '<a class="code" href="classModel.html#7af16fa26a00320fe042c822deebfab4" title="Returns ComixWall cvs tag in the given file, if any.">GetFileCvsTag</a>'=&gt;   array(
<a name="l00168"></a>00168                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>),
<a name="l00169"></a>00169                     'desc'  =&gt;  _('Get source file CVS tag'),
<a name="l00170"></a>00170                     ),
<a name="l00171"></a>00171 
<a name="l00172"></a>00172                 '<a class="code" href="classModel.html#7b4dfa63dc1823462b18efadd16b88b6">GetDefaultLogFile</a>' =&gt;  array(
<a name="l00173"></a>00173                     'argv'  =&gt;  array(),
<a name="l00174"></a>00174                     'desc'  =&gt;  _('Get log file'),
<a name="l00175"></a>00175                     ),
<a name="l00176"></a>00176 
<a name="l00177"></a>00177                 '<a class="code" href="classModel.html#3ff7381593aee6c57361809ac2a15228" title="Returns log file under tmp location.">SelectLogFile</a>' =&gt;  array(
<a name="l00178"></a>00178                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00179"></a>00179                     'desc'  =&gt;  _('Select log file'),
<a name="l00180"></a>00180                     ),
<a name="l00181"></a>00181 
<a name="l00182"></a>00182                 '<a class="code" href="classModel.html#d45004479b64ebb94297aa6b27ede5a8" title="Gets log files list with start dates.">GetLogFilesList</a>'   =&gt;  array(
<a name="l00183"></a>00183                     'argv'  =&gt;  array(),
<a name="l00184"></a>00184                     'desc'  =&gt;  _('Get log files list'),
<a name="l00185"></a>00185                     ),
<a name="l00186"></a>00186 
<a name="l00187"></a>00187                 '<a class="code" href="classModel.html#e6a13e22597651045ca35dc07f71564b" title="Collects text statistics for the proc stats general page.">GetProcStatLines</a>'  =&gt;  array(
<a name="l00188"></a>00188                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>|<a class="code" href="Controller_2lib_8php.html#899caa602e4fff675b17cdbab33607ec" title="PHP is not compiled, otherwise would use bindec()">NONE</a>),
<a name="l00189"></a>00189                     'desc'  =&gt;  _('Get stat lines'),
<a name="l00190"></a>00190                     ),
<a name="l00191"></a>00191                             
<a name="l00192"></a>00192                 '<a class="code" href="classModel.html#0ae50b6dbbd53cc2db879f2aad4a6bb3" title="Gets sysctl output for the given arg.">GetSysCtl</a>' =&gt;  array(
<a name="l00193"></a>00193                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>),
<a name="l00194"></a>00194                     'desc'  =&gt;  _('Get sysctl values'),
<a name="l00195"></a>00195                     ),
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                 '<a class="code" href="classModel.html#13d954623f5fdc936047f3273a20abd8" title="Checks user&amp;#39;s password supplied against the one in htpasswd file.">CheckAuthentication</a>'   =&gt;  array(
<a name="l00198"></a>00198                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>, <a class="code" href="Controller_2lib_8php.html#168b8cedbbd7d2f792548c3695533d9a">SHA1STR</a>),
<a name="l00199"></a>00199                     'desc'  =&gt;  _('Check authentication'),
<a name="l00200"></a>00200                     ),
<a name="l00201"></a>00201                 
<a name="l00202"></a>00202                 '<a class="code" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type.">GetConfigValues</a>'   =&gt;  array(
<a name="l00203"></a>00203                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00204"></a>00204                     'desc'  =&gt;  _('Get config values'),
<a name="l00205"></a>00205                     ),
<a name="l00206"></a>00206 
<a name="l00207"></a>00207                 '<a class="code" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration.">SetConfValue</a>'  =&gt;  array(
<a name="l00209"></a>00209                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#4b4c398e4f254a3144833a9d537f746e">CONFNAME</a>, <a class="code" href="Controller_2lib_8php.html#5c9ef9e2baf68f1a9dcd4ecdf3ca538a">STR</a>, <a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00210"></a>00210                     'desc'  =&gt;  _('Set name value pair'),
<a name="l00211"></a>00211                     ),
<a name="l00212"></a>00212 
<a name="l00213"></a>00213                 '<a class="code" href="classModel.html#d2e2c0802bba9a76b1fba3c9c9e31e6f" title="Enables a configuration item in conf file.">EnableConf</a>'    =&gt;  array(
<a name="l00214"></a>00214                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#4b4c398e4f254a3144833a9d537f746e">CONFNAME</a>, <a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00215"></a>00215                     'desc'  =&gt;  _('Enable config'),
<a name="l00216"></a>00216                     ),
<a name="l00217"></a>00217 
<a name="l00218"></a>00218                 '<a class="code" href="classModel.html#20f53926124c84fffd476021fd6d58d7" title="Disables a configuration item in conf file.">DisableConf</a>'   =&gt;  array(
<a name="l00219"></a>00219                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#4b4c398e4f254a3144833a9d537f746e">CONFNAME</a>, <a class="code" href="Controller_2lib_8php.html#57972b9e70d3db965db541436673dcc3">NAME</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>|<a class="code" href="Controller_2lib_8php.html#ccb11c21b4d8dd996d4f12a147b7b45e">EMPTYSTR</a>),
<a name="l00220"></a>00220                     'desc'  =&gt;  _('Disable config'),
<a name="l00221"></a>00221                     ),
<a name="l00222"></a>00222 
<a name="l00223"></a>00223                 '<a class="code" href="classModel.html#66be6edcbd364e21485e03144cfa2a46" title="Extracts the datetime of the first line in the log file.">GetLogStartDate</a>'   =&gt;  array(
<a name="l00224"></a>00224                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>),
<a name="l00225"></a>00225                     'desc'  =&gt;  _('Get log start date'),
<a name="l00226"></a>00226                     ),
<a name="l00227"></a>00227 
<a name="l00228"></a>00228                 '<a class="code" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file.">GetFileLineCount</a>'  =&gt;  array(
<a name="l00229"></a>00229                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>, <a class="code" href="Controller_2lib_8php.html#58e4c338ccc3ae4ddcc88da480e0acff">REGEXP</a>|<a class="code" href="Controller_2lib_8php.html#899caa602e4fff675b17cdbab33607ec" title="PHP is not compiled, otherwise would use bindec()">NONE</a>),
<a name="l00230"></a>00230                     'desc'  =&gt;  _('Gets line count'),
<a name="l00231"></a>00231                     ),
<a name="l00232"></a>00232 
<a name="l00233"></a>00233                 '<a class="code" href="classModel.html#7f8992e5e1ce2fb1252e28a4697e1d8d" title="Gets lines in file.">GetLogs</a>'   =&gt;  array(
<a name="l00234"></a>00234                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>, <a class="code" href="Controller_2lib_8php.html#58e4c338ccc3ae4ddcc88da480e0acff">REGEXP</a>|<a class="code" href="Controller_2lib_8php.html#899caa602e4fff675b17cdbab33607ec" title="PHP is not compiled, otherwise would use bindec()">NONE</a>),
<a name="l00235"></a>00235                     'desc'  =&gt;  _('Get lines'),
<a name="l00236"></a>00236                     ),
<a name="l00237"></a>00237 
<a name="l00238"></a>00238                 '<a class="code" href="classModel.html#4795ba110e63f9818b053f98bafb380e" title="Gets logs for live logs pages.">GetLiveLogs</a>'   =&gt;  array(
<a name="l00239"></a>00239                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>, <a class="code" href="Controller_2lib_8php.html#d44a128141b580357b4ecd438c581eb6">NUM</a>, <a class="code" href="Controller_2lib_8php.html#58e4c338ccc3ae4ddcc88da480e0acff">REGEXP</a>|<a class="code" href="Controller_2lib_8php.html#899caa602e4fff675b17cdbab33607ec" title="PHP is not compiled, otherwise would use bindec()">NONE</a>),
<a name="l00240"></a>00240                     'desc'  =&gt;  _('Get tail'),
<a name="l00241"></a>00241                     ),
<a name="l00242"></a>00242 
<a name="l00243"></a>00243                 'PrepareFileForDownload'    =&gt;  array(
<a name="l00244"></a>00244                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#89d58fada68e965c4762b09bd69c2bba">FILEPATH</a>),
<a name="l00245"></a>00245                     'desc'  =&gt;  _('Prepare file <span class="keywordflow">for</span> download'),
<a name="l00246"></a>00246                     ),
<a name="l00247"></a>00247                 
<a name="l00248"></a>00248                 'GetAllowedIps' =&gt;  array(
<a name="l00249"></a>00249                     'argv'  =&gt;  array(),
<a name="l00250"></a>00250                     'desc'  =&gt;  _('Get PF allowed'),
<a name="l00251"></a>00251                     ),
<a name="l00252"></a>00252 
<a name="l00253"></a>00253                 'AddAllowedIp'  =&gt;  array(
<a name="l00254"></a>00254                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#bd61f6de4486078085d7f4d700b6219b">IPADR</a>|<a class="code" href="Controller_2lib_8php.html#69c2eaa2cba9647f2877ebabf4d48aa3">IPRANGE</a>),
<a name="l00255"></a>00255                     'desc'  =&gt;  _('Set PF allowed'),
<a name="l00256"></a>00256                     ),
<a name="l00257"></a>00257 
<a name="l00258"></a>00258                 'DelAllowedIp'  =&gt;  array(
<a name="l00259"></a>00259                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#bd61f6de4486078085d7f4d700b6219b">IPADR</a>|<a class="code" href="Controller_2lib_8php.html#69c2eaa2cba9647f2877ebabf4d48aa3">IPRANGE</a>),
<a name="l00260"></a>00260                     'desc'  =&gt;  _('Delete PF allowed'),
<a name="l00261"></a>00261                     ),
<a name="l00262"></a>00262 
<a name="l00263"></a>00263                 'GetRestrictedIps'=&gt;    array(
<a name="l00264"></a>00264                     'argv'  =&gt;  array(),
<a name="l00265"></a>00265                     'desc'  =&gt;  _('Get PF restricted'),
<a name="l00266"></a>00266                     ),
<a name="l00267"></a>00267 
<a name="l00268"></a>00268                 'AddRestrictedIp'=&gt; array(
<a name="l00269"></a>00269                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#bd61f6de4486078085d7f4d700b6219b">IPADR</a>|<a class="code" href="Controller_2lib_8php.html#69c2eaa2cba9647f2877ebabf4d48aa3">IPRANGE</a>),
<a name="l00270"></a>00270                     'desc'  =&gt;  _('Set PF restricted'),
<a name="l00271"></a>00271                     ),
<a name="l00272"></a>00272 
<a name="l00273"></a>00273                 'DelRestrictedIp'=&gt; array(
<a name="l00274"></a>00274                     'argv'  =&gt;  array(<a class="code" href="Controller_2lib_8php.html#bd61f6de4486078085d7f4d700b6219b">IPADR</a>|<a class="code" href="Controller_2lib_8php.html#69c2eaa2cba9647f2877ebabf4d48aa3">IPRANGE</a>),
<a name="l00275"></a>00275                     'desc'  =&gt;  _('Delete PF restricted'),
<a name="l00276"></a>00276                     ),
<a name="l00277"></a>00277                 )
<a name="l00278"></a>00278             );
<a name="l00279"></a>00279     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_e3b375de5f6df4faf74a95d64748e048_cgraph.png" border="0" usemap="#classModel_e3b375de5f6df4faf74a95d64748e048_cgraph_map" alt=""></center>
<map name="classModel_e3b375de5f6df4faf74a95d64748e048_cgraph_map">
<area shape="rect" href="classModel.html#13d954623f5fdc936047f3273a20abd8" title="Checks user&#39;s password supplied against the one in htpasswd file." alt="" coords="161,57,361,84"><area shape="rect" href="classModel.html#20f53926124c84fffd476021fd6d58d7" title="Disables a configuration item in conf file." alt="" coords="188,108,335,135"><area shape="rect" href="classModel.html#d2e2c0802bba9a76b1fba3c9c9e31e6f" title="Enables a configuration item in conf file." alt="" coords="189,159,333,185"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="191,209,332,236"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="440,184,565,211"><area shape="rect" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file." alt="" coords="881,197,1060,224"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="173,1324,349,1351"><area shape="rect" href="classModel.html#7b4dfa63dc1823462b18efadd16b88b6" title="Model::GetDefaultLogFile" alt="" coords="169,412,353,439"><area shape="rect" href="classModel.html#a4b322dc7d0a9d3da132f5149880d437" title="Get ext_if." alt="" coords="441,463,564,489"><area shape="rect" href="classModel.html#7af16fa26a00320fe042c822deebfab4" title="Returns ComixWall cvs tag in the given file, if any." alt="" coords="181,513,341,540"><area shape="rect" href="classModel.html#769e2fd12ca0ef7003ca4abdb86168cb" title="Get int_if." alt="" coords="444,361,561,388"><area shape="rect" href="classModel.html#4795ba110e63f9818b053f98bafb380e" title="Gets logs for live logs pages." alt="" coords="187,615,336,641"><area shape="rect" href="classModel.html#d45004479b64ebb94297aa6b27ede5a8" title="Gets log files list with start dates." alt="" coords="179,665,344,692"><area shape="rect" href="classModel.html#7f8992e5e1ce2fb1252e28a4697e1d8d" title="Gets lines in file." alt="" coords="200,716,323,743"><area shape="rect" href="classModel.html#66be6edcbd364e21485e03144cfa2a46" title="Extracts the datetime of the first line in the log file." alt="" coords="171,767,352,793"><area shape="rect" href="classModel.html#26a9043009ddbda075cf8e890dbd28d9" title="Extract physical interface names from ifconfig output." alt="" coords="195,817,328,844"><area shape="rect" href="classModel.html#8e4d47e167d2ee8325f09289c7538c02" title="Gets the list of processes running." alt="" coords="189,868,333,895"><area shape="rect" href="classModel.html#e6a13e22597651045ca35dc07f71564b" title="Collects text statistics for the proc stats general page." alt="" coords="171,919,352,945"><area shape="rect" href="classModel.html#647435ed6c63149c209b093518623a2e" title="Gets service statuses." alt="" coords="171,969,352,996"><area shape="rect" href="classModel.html#0ae50b6dbbd53cc2db879f2aad4a6bb3" title="Gets sysctl output for the given arg." alt="" coords="195,1020,328,1047"><area shape="rect" href="classModel.html#53a0b80bb9ba660edf934fcded32e1f4" title="Gets software version string." alt="" coords="192,1071,331,1097"><area shape="rect" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running." alt="" coords="196,1121,327,1148"><area shape="rect" href="classModel.html#7b9bda42c0ab93f85ad329597d8c7093" title="Sends HUP to the module pid." alt="" coords="205,1172,317,1199"><area shape="rect" href="classModel.html#c95892eaf9c6371e23720359a3ce8004" title="Restart module processes." alt="" coords="204,1223,319,1249"><area shape="rect" href="classModel.html#3ff7381593aee6c57361809ac2a15228" title="Returns log file under tmp location." alt="" coords="185,1273,337,1300"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="183,564,340,591"><area shape="rect" href="classModel.html#4cdbaac69ea2e094a98caae1cbb7f2aa" title="Start module process(es)." alt="" coords="211,1375,312,1401"><area shape="rect" href="classModel.html#abaab1028bd3cbc20d4bc77f8a222f98" title="Stops module process(es)." alt="" coords="212,1425,311,1452"><area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="887,121,1055,148"><area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="1159,223,1249,249"><area shape="rect" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents." alt="" coords="1148,121,1260,148"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="1111,172,1297,199"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="1348,223,1527,249"><area shape="rect" href="classModel.html#96cdbca1cb750f08af734720ce035527" title="Generates date regexp to be used by statistics functions." alt="" coords="651,172,824,199"><area shape="rect" href="classModel.html#06a223ba294ce4dedc681900919c35b5" title="Generates hour regexp to be used by statistics functions." alt="" coords="651,223,824,249"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="881,273,1060,300"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="663,121,812,148"><area shape="rect" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758" title="Copies original log file to tmp location." alt="" coords="643,71,832,97"><area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="412,792,593,819"><area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="439,716,567,743"><area shape="rect" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided." alt="" coords="436,665,569,692"><area shape="rect" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module." alt="" coords="665,716,809,743"><area shape="rect" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" title="Checks if commented&#45;out Name exists." alt="" coords="644,767,831,793"><area shape="rect" href="classModel.html#651763904d218ee52464b258498c0255" title="Reads value of commented&#45;out NVP." alt="" coords="649,817,825,844"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="904,716,1037,743"><area shape="rect" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e" title="Checks if Name exists." alt="" coords="672,665,803,692"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="677,513,797,540"><area shape="rect" href="classModel.html#799897eaa58becf38f093bd89a3eb519" title="Changes value of NVP." alt="" coords="443,513,563,540"><area shape="rect" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message." alt="" coords="460,615,545,641"></map>
</div>

</div>
</div><p>
<a class="anchor" name="769e2fd12ca0ef7003ca4abdb86168cb"></a><!-- doxytag: member="Model::GetIntIf" ref="769e2fd12ca0ef7003ca4abdb86168cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetIntIf           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get int_if. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00283">283</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l00499">GetNVP()</a>.</p>

<p>Referenced by <a class="el" href="system_8php-source.html#l00441">System::GetConfig()</a>, and <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00284"></a>00284     {
<a name="l00285"></a>00285         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP.">GetNVP</a>($this-&gt;PfRulesFile, 'int_if');
<a name="l00286"></a>00286     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_769e2fd12ca0ef7003ca4abdb86168cb_cgraph.png" border="0" usemap="#classModel_769e2fd12ca0ef7003ca4abdb86168cb_cgraph_map" alt=""></center>
<map name="classModel_769e2fd12ca0ef7003ca4abdb86168cb_cgraph_map">
<area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="175,5,295,32"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="345,5,479,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_769e2fd12ca0ef7003ca4abdb86168cb_icgraph.png" border="0" usemap="#classModel_769e2fd12ca0ef7003ca4abdb86168cb_icgraph_map" alt=""></center>
<map name="classModel_769e2fd12ca0ef7003ca4abdb86168cb_icgraph_map">
<area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="173,5,320,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="193,56,300,83"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="368,5,499,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a4b322dc7d0a9d3da132f5149880d437"></a><!-- doxytag: member="Model::GetExtIf" ref="a4b322dc7d0a9d3da132f5149880d437" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetExtIf           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get ext_if. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00290">290</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l00499">GetNVP()</a>.</p>

<p>Referenced by <a class="el" href="system_8php-source.html#l00441">System::GetConfig()</a>, and <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00291"></a>00291     {
<a name="l00292"></a>00292         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP.">GetNVP</a>($this-&gt;PfRulesFile, 'ext_if');
<a name="l00293"></a>00293     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_a4b322dc7d0a9d3da132f5149880d437_cgraph.png" border="0" usemap="#classModel_a4b322dc7d0a9d3da132f5149880d437_cgraph_map" alt=""></center>
<map name="classModel_a4b322dc7d0a9d3da132f5149880d437_cgraph_map">
<area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="180,5,300,32"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="351,5,484,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_a4b322dc7d0a9d3da132f5149880d437_icgraph.png" border="0" usemap="#classModel_a4b322dc7d0a9d3da132f5149880d437_icgraph_map" alt=""></center>
<map name="classModel_a4b322dc7d0a9d3da132f5149880d437_icgraph_map">
<area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="179,5,325,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="199,56,305,83"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="373,5,504,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c95892eaf9c6371e23720359a3ce8004"></a><!-- doxytag: member="Model::Restart" ref="c95892eaf9c6371e23720359a3ce8004" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Restart           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Restart module processes. 
<p>

<p>Reimplemented in <a class="el" href="classApache.html#50d819aea057b80ec4f26f2531b55389">Apache</a>, and <a class="el" href="classSystem.html#38919470d3354c91e7d928b1dc53b3cd">System</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00297">297</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>, and <a class="el" href="openvpn_8php-source.html#l00050">Openvpn::Openvpn()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00298"></a>00298     {
<a name="l00299"></a>00299     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_c95892eaf9c6371e23720359a3ce8004_icgraph.png" border="0" usemap="#classModel_c95892eaf9c6371e23720359a3ce8004_icgraph_map" alt=""></center>
<map name="classModel_c95892eaf9c6371e23720359a3ce8004_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="191,5,297,32"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="171,56,317,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2b5091c9fb872dccd476b2147d163e0d"></a><!-- doxytag: member="Model::GetStatsLogLines" ref="2b5091c9fb872dccd476b2147d163e0d" args="($logfile, $tail=-1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetStatsLogLines           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>tail</em> = <code>-1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Builds generic grep command to extract log lines. 
<p>
The purpose is to get the lines with dates in $re_datetime.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$tail</em>&nbsp;</td><td>int Tail len, new log lines to update stats with </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00308">308</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l02201">$Modules</a>, and <a class="el" href="model_8php-source.html#l00389">RunShellCommand()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00309"></a>00309     {
<a name="l00310"></a>00310         global <a class="code" href="model_8php.html#031ea101a5ccd812c9fd4e900d715215" title="Master module configuration struct.">$Modules</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312         $cmd= $Modules[$this-&gt;Name]['Stats']['Total']['Cmd'];
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="keywordflow">if</span> ($tail &gt; -1) {
<a name="l00315"></a>00315             $cmd.= <span class="stringliteral">" | /usr/bin/tail -$tail"</span>;
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         $cmd= preg_replace('/&lt;LF&gt;/', $logfile, $cmd);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($cmd);
<a name="l00321"></a>00321     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_2b5091c9fb872dccd476b2147d163e0d_cgraph.png" border="0" usemap="#classModel_2b5091c9fb872dccd476b2147d163e0d_cgraph_map" alt=""></center>
<map name="classModel_2b5091c9fb872dccd476b2147d163e0d_cgraph_map">
<area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="239,5,431,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_2b5091c9fb872dccd476b2147d163e0d_icgraph.png" border="0" usemap="#classModel_2b5091c9fb872dccd476b2147d163e0d_icgraph_map" alt=""></center>
<map name="classModel_2b5091c9fb872dccd476b2147d163e0d_icgraph_map">
<area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="239,31,388,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="439,31,564,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="613,5,755,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="803,31,909,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f2576452d0c09887bf098e304ab6d3e1"></a><!-- doxytag: member="Model::SearchFile" ref="f2576452d0c09887bf098e304ab6d3e1" args="($file, $re, $set=1, $trimchars= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SearchFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>set</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>trimchars</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Searches a given file with a given regexp. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$re</em>&nbsp;</td><td>string Regexp to search the file with, should have end markers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$set</em>&nbsp;</td><td>int There may be multiple parentheses in $re, which one to return </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$trimchars</em>&nbsp;</td><td>If given, these chars are trimmed </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>String found or FALSE if no match </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000024">Todo:</a></b></dt><dd>What to do multiple matching NVPs </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00331">331</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="Controller_2cwc_8php-source.html#l00068">$retval</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00532">GetDisabledName()</a>, <a class="el" href="model_8php-source.html#l00510">GetDisabledNVP()</a>, <a class="el" href="named_8php-source.html#l00079">Named::GetForwarders()</a>, <a class="el" href="dhcpd_8php-source.html#l00119">Dhcpd::GetIfs()</a>, <a class="el" href="snortips_8php-source.html#l00128">Snortips::GetIP()</a>, <a class="el" href="model_8php-source.html#l00521">GetName()</a>, <a class="el" href="system_8php-source.html#l00388">System::GetNameServer()</a>, <a class="el" href="model_8php-source.html#l00499">GetNVP()</a>, and <a class="el" href="system_8php-source.html#l00397">System::GetRootEmail()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00332"></a>00332     {
<a name="l00334"></a>00334         <span class="keywordflow">if</span> (preg_match($re, file_get_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>), $match)) {
<a name="l00335"></a>00335             <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>= $match[$set];
<a name="l00336"></a>00336             <span class="keywordflow">if</span> ($trimchars !== '') {
<a name="l00337"></a>00337                 <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>= trim(<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>, $trimchars);
<a name="l00338"></a>00338             }
<a name="l00339"></a>00339             <span class="keywordflow">return</span> rtrim(<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341         <span class="keywordflow">return</span> FALSE;
<a name="l00342"></a>00342     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_f2576452d0c09887bf098e304ab6d3e1_icgraph.png" border="0" usemap="#classModel_f2576452d0c09887bf098e304ab6d3e1_icgraph_map" alt=""></center>
<map name="classModel_f2576452d0c09887bf098e304ab6d3e1_icgraph_map">
<area shape="rect" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" title="Checks if commented&#45;out Name exists." alt="" coords="191,157,377,184"><area shape="rect" href="classModel.html#651763904d218ee52464b258498c0255" title="Reads value of commented&#45;out NVP." alt="" coords="196,208,372,235"><area shape="rect" href="classNamed.html#757a87994c05c5420a9ec04bc6945292" title="Gets name server forwarders." alt="" coords="197,613,371,640"><area shape="rect" href="classDhcpd.html#5515c62cf7192cd30ed2bf6abd05cf1c" title="Provides the list of dhcpd interfaces." alt="" coords="229,715,339,741"><area shape="rect" href="classSnortips.html#e738fef7c603b5900df98ca6317f062e" title="Searches for an IP or !IP." alt="" coords="224,816,344,843"><area shape="rect" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e" title="Checks if Name exists." alt="" coords="219,436,349,463"><area shape="rect" href="classSystem.html#fe5f80cd076e4ce053dd49a147256d2c" title="Reads nameserver setting." alt="" coords="191,563,377,589"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="224,284,344,311"><area shape="rect" href="classSystem.html#ec4ff12f4ffa17923354497da986d990" title="Reads root e&#45;mail address." alt="" coords="199,512,369,539"><area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="428,157,609,184"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="660,208,836,235"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="929,233,1036,260"><area shape="rect" href="classSpamd.html#13fcb586abfc47bfb334989272a7b080" title="Start module process(es)." alt="" coords="464,208,573,235"><area shape="rect" href="classNamed.html#465e6be10ecf9bf9b3011e539cb6b0a7" title="Named::Named" alt="" coords="456,613,581,640"><area shape="rect" href="classDhcpd.html#a2eb2a470d473e5961cf34bf76be48d7" title="Adds a dhcpd interface." alt="" coords="696,765,800,792"><area shape="rect" href="classDhcpd.html#abdc96b3ea16dbee5c5a0ed82819a526" title="Dhcpd::Dhcpd" alt="" coords="927,765,1039,792"><area shape="rect" href="classDhcpd.html#392f0e213b794f59c9c06b0614b16f16" title="Deletes a dhcpd interface." alt="" coords="468,816,569,843"><area shape="rect" href="classDhcpd.html#e19fff168865b559ee5fdf10c3dd71c4" title="Start module process(es)." alt="" coords="467,715,571,741"><area shape="rect" href="classSnortips.html#7b4d353374db366af92c18454f639cdc" title="Adds an IP to snortips white or black list." alt="" coords="440,867,597,893"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="680,867,816,893"><area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="455,259,583,285"><area shape="rect" href="classOpenvpn.html#901a6bb07c273c34ad67731c145fc435" title="Determines if the given conf file contains Client configuration." alt="" coords="435,436,603,463"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="675,461,821,488"><area shape="rect" href="classOpenvpn.html#06db90eb360164f2583a2bad0ed15b02" title="Sets configuration file based on config type provided." alt="" coords="672,411,824,437"><area shape="rect" href="classOpenvpn.html#684e6487e49004dde5412fc26111e5e4" title="General form for selecting, deleting, and copying an OpenVPN conf file." alt="" coords="885,411,1080,437"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="917,512,1048,539"><area shape="rect" href="classModel.html#a4b322dc7d0a9d3da132f5149880d437" title="Get ext_if." alt="" coords="457,309,580,336"><area shape="rect" href="classModel.html#769e2fd12ca0ef7003ca4abdb86168cb" title="Get int_if." alt="" coords="460,360,577,387"><area shape="rect" href="classModel.html#799897eaa58becf38f093bd89a3eb519" title="Changes value of NVP." alt="" coords="459,107,579,133"><area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="675,309,821,336"><area shape="rect" href="classPf.html#88061cad8480c6c0856347ffe367c3f9" title="Sets afterhours interface name." alt="" coords="676,107,820,133"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="669,157,827,184"><area shape="rect" href="classPf.html#1bf8a6bec94a17fd9c420647e5f163bd" title="Sets interface names." alt="" coords="707,5,789,32"><area shape="rect" href="classPf.html#372750a2a1f52f4ca563d04c1b4c2d51" title="Sets int_net." alt="" coords="696,56,800,83"><area shape="rect" href="classPf.html#c94a5dee2c0a4692a17635d25ecbd2db" title="Pf::Pf" alt="" coords="953,56,1012,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="48a3385112dc3651c42b170325903ab1"></a><!-- doxytag: member="Model::SearchFileAll" ref="48a3385112dc3651c42b170325903ab1" args="($file, $re, $set=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SearchFileAll           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>re</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>set</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Multi-searches a given file with a given regexp. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$re</em>&nbsp;</td><td>string Regexp to search the file with, should have end markers </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$set</em>&nbsp;</td><td>int There may be multiple parentheses in $re, which one to return </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>String found or FALSE if no match </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>What to do multiple matching NVPs </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00351">351</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>.</p>

<p>Referenced by <a class="el" href="imspector_8php-source.html#l00138">Imspector::GetAcl()</a>, <a class="el" href="snort_8php-source.html#l00233">Snort::GetDisabledRules()</a>, <a class="el" href="system_8php-source.html#l00359">System::GetHosts()</a>, <a class="el" href="squid_8php-source.html#l00111">Squid::GetIpPort()</a>, <a class="el" href="dansguardian_8php-source.html#l00312">Dansguardian::GetIps()</a>, <a class="el" href="snortips_8php-source.html#l00310">Snortips::GetKeywords()</a>, <a class="el" href="snortips_8php-source.html#l00301">Snortips::GetListIPs()</a>, <a class="el" href="freshclam_8php-source.html#l00108">Freshclam::GetMirrors()</a>, and <a class="el" href="snort_8php-source.html#l00225">Snort::GetRules()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00352"></a>00352     {
<a name="l00354"></a>00354         <span class="keywordflow">if</span> (preg_match_all($re, file_get_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>), $match)) {
<a name="l00355"></a>00355             <span class="keywordflow">return</span> implode(<span class="stringliteral">"\n"</span>, array_values($match[$set]));
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357         <span class="keywordflow">return</span> FALSE;
<a name="l00358"></a>00358     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_48a3385112dc3651c42b170325903ab1_icgraph.png" border="0" usemap="#classModel_48a3385112dc3651c42b170325903ab1_icgraph_map" alt=""></center>
<map name="classModel_48a3385112dc3651c42b170325903ab1_icgraph_map">
<area shape="rect" href="classImspector.html#15d907a27af19486158b3b1b67508f29" title="Imspector::GetAcl" alt="" coords="224,5,360,32"><area shape="rect" href="classSnort.html#2ac8622f9bc1df51408ef8fa932d978a" title="Gets list of disabled/commented rules." alt="" coords="203,56,381,83"><area shape="rect" href="classSystem.html#36c0d8cad9ca8debbf348362fc0905ca" title="Reads hosts file contents." alt="" coords="221,157,363,184"><area shape="rect" href="classSquid.html#6b22621c2554337d860bf974441ac2e4" title="Extract all http IP:ports which squid listens to." alt="" coords="228,208,356,235"><area shape="rect" href="classDansguardian.html#0b9e653d6dc45ee19a3d65edce2d4909" title="Reads the list of IPs." alt="" coords="212,259,372,285"><area shape="rect" href="classSnortips.html#27b0c479d20bdddce35a26517a9791b2" title="Get keywords." alt="" coords="207,309,377,336"><area shape="rect" href="classSnortips.html#8199cf4bc4a556ba0c8f51f96f2d3ced" title="Provides a list of IPs." alt="" coords="217,360,367,387"><area shape="rect" href="classFreshclam.html#a78ccec2a4c3d9e548f70a6ece4f0759" title="Freshclam::GetMirrors" alt="" coords="209,411,375,437"><area shape="rect" href="classSnort.html#0fcf20d933aed79c1935ad44ac27a118" title="Get list of enabled/uncommented rules." alt="" coords="231,107,353,133"><area shape="rect" href="classImspector.html#da969b4f04feb17cc45173029137042b" title="Imspector::Imspector" alt="" coords="453,5,613,32"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="483,81,584,108"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="468,157,599,184"><area shape="rect" href="classSquid.html#19165b349f0a1e77ed05b9e2ead005c5" title="Squid::Squid" alt="" coords="483,208,584,235"><area shape="rect" href="classDansguardian.html#63f296a16c914fe0111a84a16f9d9f92" title="Returns the list of ips in exception or banned lists." alt="" coords="429,259,637,285"><area shape="rect" href="classDansguardian.html#3223beac3b98c7358167ff9be1558e82" title="Dansguardian::Dansguardian" alt="" coords="685,259,893,285"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="465,335,601,361"><area shape="rect" href="classFreshclam.html#5fe5d724af1acf79174ba885d89b968f" title="Freshclam::Freshclam" alt="" coords="452,411,615,437"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3a3a50b49511d0d5f4373a15c83f60a8"></a><!-- doxytag: member="Model::ReplaceRegexp" ref="3a3a50b49511d0d5f4373a15c83f60a8" args="($file, $matchre, $replacere)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::ReplaceRegexp           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>matchre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>replacere</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Search and replace. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Config file. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$matchre</em>&nbsp;</td><td>string Match re. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$replacere</em>&nbsp;</td><td>string Replace re. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00366">366</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>.</p>

<p>Referenced by <a class="el" href="squid_8php-source.html#l00091">Squid::AddIpPort()</a>, <a class="el" href="freshclam_8php-source.html#l00115">Freshclam::AddMirror()</a>, <a class="el" href="imspector_8php-source.html#l00149">Imspector::DelAcl()</a>, <a class="el" href="imspector_8php-source.html#l00132">Imspector::DelBadword()</a>, <a class="el" href="system_8php-source.html#l00350">System::DelHost()</a>, <a class="el" href="dansguardian_8php-source.html#l00328">Dansguardian::DelIp()</a>, <a class="el" href="squid_8php-source.html#l00103">Squid::DelIpPort()</a>, <a class="el" href="snortips_8php-source.html#l00325">Snortips::DelKeyword()</a>, <a class="el" href="freshclam_8php-source.html#l00121">Freshclam::DelMirror()</a>, <a class="el" href="dansguardian_8php-source.html#l00368">Dansguardian::DisableExt()</a>, <a class="el" href="imspector_8php-source.html#l00161">Imspector::MoveAclDown()</a>, <a class="el" href="imspector_8php-source.html#l00155">Imspector::MoveAclUp()</a>, <a class="el" href="snort_8php-source.html#l00254">Snort::MoveRuleDown()</a>, <a class="el" href="snort_8php-source.html#l00248">Snort::MoveRuleUp()</a>, <a class="el" href="symon_8php-source.html#l00091">Symon::SetCpus()</a>, <a class="el" href="named_8php-source.html#l00089">Named::SetForwarders()</a>, <a class="el" href="pmacct_8php-source.html#l00097">Pmacct::SetIf()</a>, <a class="el" href="dhcpd_8php-source.html#l00166">Dhcpd::SetIfs()</a>, <a class="el" href="dante_8php-source.html#l00080">Dante::SetIfs()</a>, <a class="el" href="dante_8php-source.html#l00086">Dante::SetIntnet()</a>, <a class="el" href="system_8php-source.html#l00556">System::SetNameServer()</a>, <a class="el" href="spamd_8php-source.html#l00098">Spamd::SetStartupIf()</a>, <a class="el" href="snort_8php-source.html#l00260">Snort::SetStartupIfs()</a>, and <a class="el" href="apache_8php-source.html#l00110">Apache::SetWebalizerHostname()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00367"></a>00367     {
<a name="l00368"></a>00368         <span class="keywordflow">if</span> (copy(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>.'.bak')) {
<a name="l00369"></a>00369             $contents= preg_replace($matchre, $replacere, file_get_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>), 1, $count);
<a name="l00370"></a>00370             <span class="keywordflow">if</span> ($contents !== NULL &amp;&amp; $count === 1) {
<a name="l00371"></a>00371                 file_put_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $contents);
<a name="l00372"></a>00372                 <span class="keywordflow">return</span> TRUE;
<a name="l00373"></a>00373             }
<a name="l00374"></a>00374             <span class="keywordflow">else</span> {
<a name="l00375"></a>00375                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Cannot replace in $file"</span>);
<a name="l00376"></a>00376             }
<a name="l00377"></a>00377         }
<a name="l00378"></a>00378         <span class="keywordflow">else</span> {
<a name="l00379"></a>00379             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Cannot copy file $file"</span>);
<a name="l00380"></a>00380         }
<a name="l00381"></a>00381         <span class="keywordflow">return</span> FALSE;
<a name="l00382"></a>00382     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_3a3a50b49511d0d5f4373a15c83f60a8_cgraph.png" border="0" usemap="#classModel_3a3a50b49511d0d5f4373a15c83f60a8_cgraph_map" alt=""></center>
<map name="classModel_3a3a50b49511d0d5f4373a15c83f60a8_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="223,5,313,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_3a3a50b49511d0d5f4373a15c83f60a8_icgraph.png" border="0" usemap="#classModel_3a3a50b49511d0d5f4373a15c83f60a8_icgraph_map" alt=""></center>
<map name="classModel_3a3a50b49511d0d5f4373a15c83f60a8_icgraph_map">
<area shape="rect" href="classSquid.html#240c52da7a337b4a8020b16cb5cbc0e4" title="Adds IP:port to squid config file." alt="" coords="545,363,676,389"><area shape="rect" href="classFreshclam.html#c009eaba12e07166677ba5cc230d47de" title="Freshclam::AddMirror" alt="" coords="531,768,691,795"><area shape="rect" href="classImspector.html#425337aca36526afae0eb7dcce80cde2" title="Imspector::DelAcl" alt="" coords="269,261,403,288"><area shape="rect" href="classImspector.html#1d2c314f7c88c48b4024de9daf523684" title="Imspector::DelBadword" alt="" coords="249,160,423,187"><area shape="rect" href="classSystem.html#78e989e0511cd884e9167d0364105876" title="Deletes host from hosts file." alt="" coords="271,464,401,491"><area shape="rect" href="classDansguardian.html#1541d167cf6bb0f98a07d51ffdacf01f" title="Dansguardian::DelIp" alt="" coords="260,565,412,592"><area shape="rect" href="classSquid.html#4a83698e0e8bfe91bf7387392f0eadce" title="Deletes IP:port from squid config file." alt="" coords="273,363,399,389"><area shape="rect" href="classSnortips.html#0a79b554c3dfc53f72b3bd1432bcc4d1" title="Delete a keyword." alt="" coords="256,971,416,997"><area shape="rect" href="classFreshclam.html#1aee4c6ccc8aaeb8c80e15e397d8d8e8" title="Freshclam::DelMirror" alt="" coords="259,667,413,693"><area shape="rect" href="classDansguardian.html#0397f612ade747b0ac17128e0ba25cec" title="Dansguardian::DisableExt" alt="" coords="243,616,429,643"><area shape="rect" href="classImspector.html#de8f8ae9dc8269f762904c44cf933db3" title="Imspector::MoveAclDown" alt="" coords="517,8,704,35"><area shape="rect" href="classImspector.html#0f0532238604aad7ad3e5a34f20bcd37" title="Imspector::MoveAclUp" alt="" coords="527,59,695,85"><area shape="rect" href="classSnort.html#b7bab2d1ded32940d590bafb2b010419" title="Snort::MoveRuleDown" alt="" coords="253,869,419,896"><area shape="rect" href="classSnort.html#723ad507b99013487e6a24aa33152611" title="Snort::MoveRuleUp" alt="" coords="263,768,409,795"><area shape="rect" href="classSymon.html#137b0807afc7a48b6997dd2584cc6b2b" title="Symon::SetCpus" alt="" coords="271,920,401,947"><area shape="rect" href="classNamed.html#2110b8e22b965ac902eecd9e49a97219" title="Sets name server forwarders." alt="" coords="249,1021,423,1048"><area shape="rect" href="classPmacct.html#43f1c3f2ca041d547ab1a59d683dab7a" title="Pmacct::SetIf" alt="" coords="281,1072,391,1099"><area shape="rect" href="classDhcpd.html#6af5976da0f892e3f73a5482c3a3d366" title="Sets ifs." alt="" coords="281,1224,391,1251"><area shape="rect" href="classDante.html#ce7e9cc8923d777b7412b65cf933315d" title="Dante::SetIfs" alt="" coords="283,1123,389,1149"><area shape="rect" href="classDante.html#2fe84bd609e6502d31ad6ae5546e7626" title="Dante::SetIntnet" alt="" coords="271,1173,401,1200"><area shape="rect" href="classSystem.html#4286f1784688472ca239dc2c743e4676" title="Changes nameserver." alt="" coords="517,515,704,541"><area shape="rect" href="classSpamd.html#6b0dddc49e6ec41c060083158aafa151" title="Spamd::SetStartupIf" alt="" coords="257,1275,415,1301"><area shape="rect" href="classSnort.html#7402562f5e5687ef31d4f238d93fbf68" title="Snort::SetStartupIfs" alt="" coords="260,819,412,845"><area shape="rect" href="classApache.html#c2155e099d16e92fe196354941270ac1" title="Apache::SetWebalizerHostname" alt="" coords="221,1325,451,1352"><area shape="rect" href="classSquid.html#19165b349f0a1e77ed05b9e2ead005c5" title="Squid::Squid" alt="" coords="824,337,925,364"><area shape="rect" href="classFreshclam.html#5fe5d724af1acf79174ba885d89b968f" title="Freshclam::Freshclam" alt="" coords="793,743,956,769"><area shape="rect" href="classImspector.html#60fbadb2da6ccde868e5af4e9b6b3c7f" title="Imspector::AddAcl" alt="" coords="541,261,680,288"><area shape="rect" href="classImspector.html#da969b4f04feb17cc45173029137042b" title="Imspector::Imspector" alt="" coords="795,135,955,161"><area shape="rect" href="classImspector.html#33903adb8a755188d814506860428899" title="Imspector::AddBadword" alt="" coords="523,160,699,187"><area shape="rect" href="classSystem.html#b056bd6c5c382a7c71bbf20c134e7965" title="Adds host line to hosts file." alt="" coords="543,464,679,491"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="809,464,940,491"><area shape="rect" href="classDansguardian.html#8682b938e4d7c66e0e520af27110e1dc" title="Dansguardian::AddIp" alt="" coords="533,565,688,592"><area shape="rect" href="classDansguardian.html#3223beac3b98c7358167ff9be1558e82" title="Dansguardian::Dansguardian" alt="" coords="771,616,979,643"><area shape="rect" href="classSnortips.html#a1a3dcf40c186e80f655b3e849204f79" title="Add a keyword." alt="" coords="528,971,693,997"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="807,945,943,972"><area shape="rect" href="classDansguardian.html#ee2d85fa304e8beebbc5663db1343391" title="Dansguardian::DisableExtMime" alt="" coords="499,667,723,693"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="560,819,661,845"><area shape="rect" href="classSymon.html#13e2df64712f14505a14cd01d7d9d0d9" title="Symon::Symon" alt="" coords="549,869,672,896"><area shape="rect" href="classNamed.html#465e6be10ecf9bf9b3011e539cb6b0a7" title="Named::Named" alt="" coords="548,1021,673,1048"><area shape="rect" href="classPmacct.html#3eaea71d54c439d121ef90afc369876f" title="Pmacct::Pmacct" alt="" coords="547,1072,675,1099"><area shape="rect" href="classDhcpd.html#a2eb2a470d473e5961cf34bf76be48d7" title="Adds a dhcpd interface." alt="" coords="823,1224,927,1251"><area shape="rect" href="classDhcpd.html#392f0e213b794f59c9c06b0614b16f16" title="Deletes a dhcpd interface." alt="" coords="560,1173,661,1200"><area shape="rect" href="classDhcpd.html#abdc96b3ea16dbee5c5a0ed82819a526" title="Dhcpd::Dhcpd" alt="" coords="1027,1199,1139,1225"><area shape="rect" href="classDante.html#30959ae5529aab6054f30e390e33f1f2" title="Dante::Dante" alt="" coords="556,1123,665,1149"><area shape="rect" href="classSpamd.html#f2684768b6c00120af5c52aafd8e8116" title="Spamd::Spamd" alt="" coords="549,1275,672,1301"><area shape="rect" href="classApache.html#4f93f9a47b2a4bdca07820dbbfe7ea3a" title="Apache::Apache" alt="" coords="548,1325,673,1352"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2d12753c999aac330108a00dd0f3abec"></a><!-- doxytag: member="Model::RunShellCommand" ref="2d12753c999aac330108a00dd0f3abec" args="($cmd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::RunShellCommand           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>cmd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Runs given shell command and returns its output as string. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$cmd</em>&nbsp;</td><td>Command line to run. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Command result in a string. </dd></dl>

<p>
<dl class="attention" compact><dt><b>Attention:</b></dt><dd>Do not use shell_exec() here, because it is disabled when PHP is running in safe_mode </dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Not all shell commands return 0 on success, such as grep, date... Hence, do not check return value </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00389">389</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snortips_8php-source.html#l00224">Snortips::AddIPToList()</a>, <a class="el" href="pf_8php-source.html#l00350">Pf::ApplyPfRules()</a>, <a class="el" href="snortips_8php-source.html#l00293">Snortips::BlockIP()</a>, <a class="el" href="spamassassin_8php-source.html#l00132">Spamassassin::ChangeLocal()</a>, <a class="el" href="p3scan_8php-source.html#l00124">P3scan::ChangeLocal()</a>, <a class="el" href="pf_8php-source.html#l00392">Pf::DisableAfterHours()</a>, <a class="el" href="pf_8php-source.html#l00385">Pf::EnableAfterHours()</a>, <a class="el" href="openvpn_8php-source.html#l00173">Openvpn::FindPid()</a>, <a class="el" href="pf_8php-source.html#l00399">Pf::GetAfterHoursPfRules()</a>, <a class="el" href="spamassassin_8php-source.html#l00158">Spamassassin::GetFileLineCount()</a>, <a class="el" href="pf_8php-source.html#l00686">Pf::GetFileLineCount()</a>, <a class="el" href="openssh_8php-source.html#l00096">Openssh::GetFileLineCount()</a>, <a class="el" href="model_8php-source.html#l00426">GetFiles()</a>, <a class="el" href="spamd_8php-source.html#l00109">Spamd::GetGreylist()</a>, <a class="el" href="pf_8php-source.html#l00357">Pf::GetHostGraphsList()</a>, <a class="el" href="snortips_8php-source.html#l00134">Snortips::GetInfo()</a>, <a class="el" href="spamassassin_8php-source.html#l00192">Spamassassin::GetLiveLogs()</a>, <a class="el" href="pf_8php-source.html#l00724">Pf::GetLiveLogs()</a>, <a class="el" href="openssh_8php-source.html#l00130">Openssh::GetLiveLogs()</a>, <a class="el" href="spamassassin_8php-source.html#l00171">Spamassassin::GetLogs()</a>, <a class="el" href="pf_8php-source.html#l00701">Pf::GetLogs()</a>, <a class="el" href="openssh_8php-source.html#l00109">Openssh::GetLogs()</a>, <a class="el" href="pf_8php-source.html#l00772">Pf::GetPfwCmdWrapperConntest()</a>, <a class="el" href="pf_8php-source.html#l00746">Pf::GetPfwCmdWrapperInfo()</a>, <a class="el" href="pf_8php-source.html#l00777">Pf::GetPfwCmdWrapperLog()</a>, <a class="el" href="pf_8php-source.html#l00751">Pf::GetPfwCmdWrapperPfInfo()</a>, <a class="el" href="pf_8php-source.html#l00756">Pf::GetPfwCmdWrapperPfMem()</a>, <a class="el" href="pf_8php-source.html#l00761">Pf::GetPfwCmdWrapperPfStates()</a>, <a class="el" href="pf_8php-source.html#l00767">Pf::GetPfwCmdWrapperQueues()</a>, <a class="el" href="pf_8php-source.html#l00783">Pf::GetPfwPfFileName()</a>, <a class="el" href="pf_8php-source.html#l00261">Pf::GetStateCount()</a>, <a class="el" href="model_8php-source.html#l01669">GetStatsFileInfo()</a>, <a class="el" href="model_8php-source.html#l00308">GetStatsLogLines()</a>, <a class="el" href="spamassassin_8php-source.html#l00088">Spamassassin::GetVersion()</a>, <a class="el" href="snort_8php-source.html#l00106">Snort::GetVersion()</a>, <a class="el" href="smtp-gated_8php-source.html#l00060">Smtpgated::GetVersion()</a>, <a class="el" href="pmacct_8php-source.html#l00071">Pmacct::GetVersion()</a>, <a class="el" href="p3scan_8php-source.html#l00083">P3scan::GetVersion()</a>, <a class="el" href="apache_8php-source.html#l00067">Apache::GetVersion()</a>, <a class="el" href="spamd_8php-source.html#l00104">Spamd::GetWhitelist()</a>, <a class="el" href="snort_8php-source.html#l00204">Snort::IsInstanceRunning()</a>, <a class="el" href="pf_8php-source.html#l00233">Pf::IsRunning()</a>, <a class="el" href="openvpn_8php-source.html#l00127">Openvpn::Restart()</a>, <a class="el" href="apache_8php-source.html#l00073">Apache::Restart()</a>, <a class="el" href="spamd_8php-source.html#l00084">Spamd::Start()</a>, <a class="el" href="snort_8php-source.html#l00111">Snort::Start()</a>, <a class="el" href="pf_8php-source.html#l00244">Pf::Start()</a>, <a class="el" href="dhcpd_8php-source.html#l00105">Dhcpd::Start()</a>, <a class="el" href="snort_8php-source.html#l00135">Snort::Stop()</a>, <a class="el" href="pf_8php-source.html#l00251">Pf::Stop()</a>, <a class="el" href="apache_8php-source.html#l00078">Apache::Stop()</a>, <a class="el" href="snortips_8php-source.html#l00272">Snortips::UnblockAll()</a>, and <a class="el" href="snortips_8php-source.html#l00279">Snortips::UnblockIPs()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00390"></a>00390     {
<a name="l00394"></a>00394         exec($cmd, $output);
<a name="l00395"></a>00395         <span class="keywordflow">if</span> (is_array($output)) {
<a name="l00396"></a>00396             <span class="keywordflow">return</span> implode(<span class="stringliteral">"\n"</span>, $output);
<a name="l00397"></a>00397         }
<a name="l00398"></a>00398         <span class="keywordflow">return</span> '';
<a name="l00399"></a>00399     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9beaec250eb1d242282695035de7e01d"></a><!-- doxytag: member="Model::AppendToFile" ref="9beaec250eb1d242282695035de7e01d" args="($file, $line)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::AppendToFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>line</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Appends a string to a file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$line</em>&nbsp;</td><td>Line to add </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00406">406</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>.</p>

<p>Referenced by <a class="el" href="imspector_8php-source.html#l00143">Imspector::AddAcl()</a>, <a class="el" href="imspector_8php-source.html#l00126">Imspector::AddBadword()</a>, <a class="el" href="system_8php-source.html#l00340">System::AddHost()</a>, <a class="el" href="dansguardian_8php-source.html#l00319">Dansguardian::AddIp()</a>, <a class="el" href="snortips_8php-source.html#l00317">Snortips::AddKeyword()</a>, <a class="el" href="dansguardian_8php-source.html#l00348">Dansguardian::AddSiteList()</a>, and <a class="el" href="dansguardian_8php-source.html#l00354">Dansguardian::AddUrlList()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00407"></a>00407     {
<a name="l00408"></a>00408         <span class="keywordflow">if</span> (copy(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>.'.bak')) {
<a name="l00409"></a>00409             $contents= file_get_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>).$line.<span class="stringliteral">"\n"</span>;
<a name="l00410"></a>00410             file_put_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $contents);
<a name="l00411"></a>00411             <span class="keywordflow">return</span> TRUE;
<a name="l00412"></a>00412         }
<a name="l00413"></a>00413         <span class="keywordflow">else</span> {
<a name="l00414"></a>00414             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Cannot copy file $file"</span>);
<a name="l00415"></a>00415         }
<a name="l00416"></a>00416         <span class="keywordflow">return</span> FALSE;
<a name="l00417"></a>00417     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_9beaec250eb1d242282695035de7e01d_cgraph.png" border="0" usemap="#classModel_9beaec250eb1d242282695035de7e01d_cgraph_map" alt=""></center>
<map name="classModel_9beaec250eb1d242282695035de7e01d_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="207,5,297,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_9beaec250eb1d242282695035de7e01d_icgraph.png" border="0" usemap="#classModel_9beaec250eb1d242282695035de7e01d_icgraph_map" alt=""></center>
<map name="classModel_9beaec250eb1d242282695035de7e01d_icgraph_map">
<area shape="rect" href="classImspector.html#60fbadb2da6ccde868e5af4e9b6b3c7f" title="Imspector::AddAcl" alt="" coords="232,5,371,32"><area shape="rect" href="classImspector.html#33903adb8a755188d814506860428899" title="Imspector::AddBadword" alt="" coords="213,56,389,83"><area shape="rect" href="classSystem.html#b056bd6c5c382a7c71bbf20c134e7965" title="Adds host line to hosts file." alt="" coords="233,107,369,133"><area shape="rect" href="classDansguardian.html#8682b938e4d7c66e0e520af27110e1dc" title="Dansguardian::AddIp" alt="" coords="224,157,379,184"><area shape="rect" href="classSnortips.html#a1a3dcf40c186e80f655b3e849204f79" title="Add a keyword." alt="" coords="219,309,384,336"><area shape="rect" href="classDansguardian.html#d0ffa3b849c6ed659e93516d4a5bd2b5" title="Dansguardian::AddSiteList" alt="" coords="205,208,397,235"><area shape="rect" href="classDansguardian.html#f91baae36b305f29c3d52a2c4d9820e0" title="Dansguardian::AddUrlList" alt="" coords="209,259,393,285"><area shape="rect" href="classImspector.html#da969b4f04feb17cc45173029137042b" title="Imspector::Imspector" alt="" coords="469,31,629,57"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="484,107,615,133"><area shape="rect" href="classDansguardian.html#3223beac3b98c7358167ff9be1558e82" title="Dansguardian::Dansguardian" alt="" coords="445,208,653,235"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="481,309,617,336"></map>
</div>

</div>
</div><p>
<a class="anchor" name="55b3f40ec612727a645a77896163f1d9"></a><!-- doxytag: member="Model::GetFiles" ref="55b3f40ec612727a645a77896163f1d9" args="($filepath)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetFiles           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>filepath</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns files with the given filepath pattern. 
<p>
$filepath does not have to be just directory path, and may contain wildcards.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$filepath</em>&nbsp;</td><td>string Pattern </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>List of file names, without path </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00426">426</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l00389">RunShellCommand()</a>.</p>

<p>Referenced by <a class="el" href="openvpn_8php-source.html#l00194">Openvpn::GetConfs()</a>, <a class="el" href="Model_2imlogs_8php-source.html#l00092">Imlogs::GetDirs()</a>, <a class="el" href="spamassassin_8php-source.html#l00114">Spamassassin::GetLocales()</a>, <a class="el" href="p3scan_8php-source.html#l00104">P3scan::GetLocales()</a>, and <a class="el" href="Model_2imlogs_8php-source.html#l00086">Imlogs::ImGetFiles()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00427"></a>00427     {
<a name="l00428"></a>00428         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"ls -1 $filepath"</span>);
<a name="l00429"></a>00429     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_55b3f40ec612727a645a77896163f1d9_cgraph.png" border="0" usemap="#classModel_55b3f40ec612727a645a77896163f1d9_cgraph_map" alt=""></center>
<map name="classModel_55b3f40ec612727a645a77896163f1d9_cgraph_map">
<area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="175,5,367,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_55b3f40ec612727a645a77896163f1d9_icgraph.png" border="0" usemap="#classModel_55b3f40ec612727a645a77896163f1d9_icgraph_map" alt=""></center>
<map name="classModel_55b3f40ec612727a645a77896163f1d9_icgraph_map">
<area shape="rect" href="classOpenvpn.html#397af92c61451e10c2a3f71528810be3" title="Gets files with conf ext." alt="" coords="196,81,345,108"><area shape="rect" href="classImlogs.html#acfcae31f544dd5dfaee9051c143b776" title="Imlogs::GetDirs" alt="" coords="211,233,331,260"><area shape="rect" href="classSpamassassin.html#a9b77f1bcedd561eb3d9efb25ed04b4c" title="Gets locale files." alt="" coords="175,309,367,336"><area shape="rect" href="classP3scan.html#609f6c982e6a0a299a3a622fc4e14a63" title="Gets list of locale files." alt="" coords="197,360,344,387"><area shape="rect" href="classImlogs.html#ae92041ddad8fdfd81efe7eff79091c5" title="Imlogs::ImGetFiles" alt="" coords="200,411,341,437"><area shape="rect" href="classOpenvpn.html#684e6487e49004dde5412fc26111e5e4" title="General form for selecting, deleting, and copying an OpenVPN conf file." alt="" coords="428,5,623,32"><area shape="rect" href="classOpenvpn.html#bfe789f2de84e30353cd58bae71727ce" title="General form for selecting an OpenVPN conf file to run." alt="" coords="416,56,635,83"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="452,107,599,133"><area shape="rect" href="classImlogs.html#ff0360629aa1dd4aae74fe138de96ec7" title="Imlogs::GetLocalUsers" alt="" coords="443,157,608,184"><area shape="rect" href="classImlogs.html#272093bca964d79288c5df8d72bfd00c" title="Imlogs::GetProtocols" alt="" coords="448,208,603,235"><area shape="rect" href="classImlogs.html#93fa56fad0b9cdd789acc6d03465d2a7" title="Imlogs::GetRemoteUsers" alt="" coords="433,259,617,285"><area shape="rect" href="classImlogs.html#ce8d60f841608d128061c914952cf119" title="Imlogs::Imlogs" alt="" coords="683,233,797,260"><area shape="rect" href="classSpamassassin.html#e361a31310cb48214c2c18dca8c5510e" title="Spamassassin::Spamassassin" alt="" coords="419,309,632,336"><area shape="rect" href="classP3scan.html#cdd09b6b8cbfff2d34a92ff5ebd782b2" title="P3scan::P3scan" alt="" coords="464,360,587,387"><area shape="rect" href="classImlogs.html#e05933567c841d3645dee22bf6b94c49" title="Imlogs::GetSessions" alt="" coords="449,411,601,437"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4e346106b6f66e18e88b9d6c330655d1"></a><!-- doxytag: member="Model::GetConfigValues" ref="4e346106b6f66e18e88b9d6c330655d1" args="($conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetConfigValues           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns all configuration for a given configuration type. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$conf</em>&nbsp;</td><td>string Config type </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$group</em>&nbsp;</td><td>int <a class="el" href="classDansguardian.html">Dansguardian</a> group </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>serialized Array of config items </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00437">437</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="dansguardian_2conf_8php-source.html#l00068">Config</a>, <a class="el" href="model_8php-source.html#l00480">GetDisabledValue()</a>, <a class="el" href="model_8php-source.html#l00466">GetValue()</a>, and <a class="el" href="model_8php-source.html#l00683">SetConfig()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00438"></a>00438     {
<a name="l00439"></a>00439         $this-&gt;<a class="code" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided.">SetConfig</a>($conf);
<a name="l00440"></a>00440 
<a name="l00441"></a>00441         $values= array();
<a name="l00442"></a>00442         <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a> as $name =&gt; $config) {
<a name="l00443"></a>00443             <span class="keywordflow">if</span> (($output= $this-&gt;<a class="code" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type.">GetValue</a>($name, $conf, $group)) !== FALSE) {
<a name="l00444"></a>00444                 $values[$name]= array(
<a name="l00445"></a>00445                     'Value' =&gt; $output,
<a name="l00446"></a>00446                     'Enabled' =&gt; TRUE,
<a name="l00447"></a>00447                     );
<a name="l00448"></a>00448             }
<a name="l00449"></a>00449             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (($output= $this-&gt;<a class="code" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type.">GetDisabledValue</a>($name, $conf, $group)) !== FALSE) {
<a name="l00450"></a>00450                 $values[$name]= array(
<a name="l00451"></a>00451                     'Value' =&gt; $output,
<a name="l00452"></a>00452                     'Enabled' =&gt; FALSE,
<a name="l00453"></a>00453                     );
<a name="l00454"></a>00454             }
<a name="l00455"></a>00455         }
<a name="l00456"></a>00456         <span class="keywordflow">return</span> serialize($values);
<a name="l00457"></a>00457     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_4e346106b6f66e18e88b9d6c330655d1_cgraph.png" border="0" usemap="#classModel_4e346106b6f66e18e88b9d6c330655d1_cgraph_map" alt=""></center>
<map name="classModel_4e346106b6f66e18e88b9d6c330655d1_cgraph_map">
<area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="233,69,415,96"><area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="260,145,388,172"><area shape="rect" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided." alt="" coords="257,196,391,223"><area shape="rect" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module." alt="" coords="485,107,629,133"><area shape="rect" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" title="Checks if commented&#45;out Name exists." alt="" coords="464,5,651,32"><area shape="rect" href="classModel.html#651763904d218ee52464b258498c0255" title="Reads value of commented&#45;out NVP." alt="" coords="469,56,645,83"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="700,107,833,133"><area shape="rect" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e" title="Checks if Name exists." alt="" coords="492,157,623,184"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="497,208,617,235"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_4e346106b6f66e18e88b9d6c330655d1_icgraph.png" border="0" usemap="#classModel_4e346106b6f66e18e88b9d6c330655d1_icgraph_map" alt=""></center>
<map name="classModel_4e346106b6f66e18e88b9d6c330655d1_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="232,5,339,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="bf6ca5f5f6d8e69581e3e8e190df92cd"></a><!-- doxytag: member="Model::GetValue" ref="bf6ca5f5f6d8e69581e3e8e190df92cd" args="($name, $conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetValue           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns all enabled configuration for a given configuration type. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>string Config name </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$conf</em>&nbsp;</td><td>string Config type </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$group</em>&nbsp;</td><td>int <a class="el" href="classDansguardian.html">Dansguardian</a> group </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>serialized Array of config items </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00466">466</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, <a class="el" href="dansguardian_2conf_8php-source.html#l00068">Config</a>, <a class="el" href="model_8php-source.html#l00671">GetConfFile()</a>, <a class="el" href="model_8php-source.html#l00521">GetName()</a>, and <a class="el" href="model_8php-source.html#l00499">GetNVP()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00437">GetConfigValues()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00467"></a>00467     {
<a name="l00468"></a>00468         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module.">GetConfFile</a>($conf, $group);
<a name="l00469"></a>00469         
<a name="l00470"></a>00470         <span class="keywordflow">if</span> ((isset($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'])) &amp;&amp; ($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'] === FALSE)) {
<a name="l00471"></a>00471             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e" title="Checks if Name exists.">GetName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00472"></a>00472         }
<a name="l00473"></a>00473         
<a name="l00474"></a>00474         $value= $this-&gt;<a class="code" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP.">GetNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00475"></a>00475         <span class="keywordflow">return</span> $value !== FALSE ? <span class="stringliteral">"$name=$value"</span> : $value;
<a name="l00476"></a>00476     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_cgraph.png" border="0" usemap="#classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_cgraph_map" alt=""></center>
<map name="classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_cgraph_map">
<area shape="rect" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module." alt="" coords="183,5,327,32"><area shape="rect" href="classModel.html#fc563954e2d371ee98dce6b41b639e9e" title="Checks if Name exists." alt="" coords="189,56,320,83"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="195,107,315,133"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="377,81,511,108"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_icgraph.png" border="0" usemap="#classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_icgraph_map" alt=""></center>
<map name="classModel_bf6ca5f5f6d8e69581e3e8e190df92cd_icgraph_map">
<area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="183,5,359,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="408,5,515,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="bf62334346f19c56c5ed701af936ce66"></a><!-- doxytag: member="Model::GetDisabledValue" ref="bf62334346f19c56c5ed701af936ce66" args="($name, $conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetDisabledValue           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns all disabled configuration for a given configuration type. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00480">480</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, <a class="el" href="dansguardian_2conf_8php-source.html#l00068">Config</a>, <a class="el" href="model_8php-source.html#l00671">GetConfFile()</a>, <a class="el" href="model_8php-source.html#l00532">GetDisabledName()</a>, and <a class="el" href="model_8php-source.html#l00510">GetDisabledNVP()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00437">GetConfigValues()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00481"></a>00481     {
<a name="l00482"></a>00482         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module.">GetConfFile</a>($conf, $group);
<a name="l00483"></a>00483         
<a name="l00484"></a>00484         <span class="keywordflow">if</span> ((isset($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'])) &amp;&amp; ($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'] === FALSE)) {
<a name="l00485"></a>00485             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" title="Checks if commented-out Name exists.">GetDisabledName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487         
<a name="l00488"></a>00488         $value= $this-&gt;<a class="code" href="classModel.html#651763904d218ee52464b258498c0255" title="Reads value of commented-out NVP.">GetDisabledNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00489"></a>00489         <span class="keywordflow">return</span> $value !== FALSE ? <span class="stringliteral">"$name=$value"</span> : $value;
<a name="l00490"></a>00490     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_bf62334346f19c56c5ed701af936ce66_cgraph.png" border="0" usemap="#classModel_bf62334346f19c56c5ed701af936ce66_cgraph_map" alt=""></center>
<map name="classModel_bf62334346f19c56c5ed701af936ce66_cgraph_map">
<area shape="rect" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module." alt="" coords="259,5,403,32"><area shape="rect" href="classModel.html#fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" title="Checks if commented&#45;out Name exists." alt="" coords="237,56,424,83"><area shape="rect" href="classModel.html#651763904d218ee52464b258498c0255" title="Reads value of commented&#45;out NVP." alt="" coords="243,107,419,133"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="473,81,607,108"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_bf62334346f19c56c5ed701af936ce66_icgraph.png" border="0" usemap="#classModel_bf62334346f19c56c5ed701af936ce66_icgraph_map" alt=""></center>
<map name="classModel_bf62334346f19c56c5ed701af936ce66_icgraph_map">
<area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="239,5,415,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="464,5,571,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f029e9daf3e62424861794f377f49ed6"></a><!-- doxytag: member="Model::GetNVP" ref="f029e9daf3e62424861794f377f49ed6" args="($file, $name, $trimchars= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetNVP           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>trimchars</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads value of NVP. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>string Name of NVP </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$trimchars</em>&nbsp;</td><td>string Chars to trim in the results </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Value of NVP or NULL on failure </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00499">499</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="model_8php-source.html#l00331">SearchFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00290">GetExtIf()</a>, <a class="el" href="model_8php-source.html#l00283">GetIntIf()</a>, <a class="el" href="model_8php-source.html#l00466">GetValue()</a>, <a class="el" href="model_8php-source.html#l00570">SetNVP()</a>, and <a class="el" href="spamd_8php-source.html#l00084">Spamd::Start()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00500"></a>00500     {
<a name="l00501"></a>00501         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp.">SearchFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*$name\b\h*$this-&gt;NVPS\h*([^$this-&gt;COMC'\"\n]*|'[^'\n]*'|\"[^\"\n]*\"|[^$this-&gt;COMC\n]*)(\h*|\h*$this-&gt;COMC.*)$/m"</span>, 1, $trimchars);
<a name="l00502"></a>00502     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_f029e9daf3e62424861794f377f49ed6_cgraph.png" border="0" usemap="#classModel_f029e9daf3e62424861794f377f49ed6_cgraph_map" alt=""></center>
<map name="classModel_f029e9daf3e62424861794f377f49ed6_cgraph_map">
<area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="177,5,311,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_f029e9daf3e62424861794f377f49ed6_icgraph.png" border="0" usemap="#classModel_f029e9daf3e62424861794f377f49ed6_icgraph_map" alt=""></center>
<map name="classModel_f029e9daf3e62424861794f377f49ed6_icgraph_map">
<area shape="rect" href="classModel.html#a4b322dc7d0a9d3da132f5149880d437" title="Get ext_if." alt="" coords="179,101,301,128"><area shape="rect" href="classModel.html#769e2fd12ca0ef7003ca4abdb86168cb" title="Get int_if." alt="" coords="181,51,299,77"><area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="176,152,304,179"><area shape="rect" href="classModel.html#799897eaa58becf38f093bd89a3eb519" title="Changes value of NVP." alt="" coords="180,228,300,255"><area shape="rect" href="classSpamd.html#13fcb586abfc47bfb334989272a7b080" title="Start module process(es)." alt="" coords="185,279,295,305"><area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="368,51,515,77"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="591,127,697,153"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="579,51,709,77"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="353,152,529,179"><area shape="rect" href="classPf.html#88061cad8480c6c0856347ffe367c3f9" title="Sets afterhours interface name." alt="" coords="369,253,513,280"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="363,203,520,229"><area shape="rect" href="classPf.html#1bf8a6bec94a17fd9c420647e5f163bd" title="Sets interface names." alt="" coords="400,304,483,331"><area shape="rect" href="classPf.html#372750a2a1f52f4ca563d04c1b4c2d51" title="Sets int_net." alt="" coords="389,355,493,381"><area shape="rect" href="classPf.html#c94a5dee2c0a4692a17635d25ecbd2db" title="Pf::Pf" alt="" coords="615,304,673,331"></map>
</div>

</div>
</div><p>
<a class="anchor" name="651763904d218ee52464b258498c0255"></a><!-- doxytag: member="Model::GetDisabledNVP" ref="651763904d218ee52464b258498c0255" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetDisabledNVP           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads value of commented-out NVP. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>Name of NVP </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Value of commented NVP or NULL on failure </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00510">510</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="model_8php-source.html#l00331">SearchFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00480">GetDisabledValue()</a>, and <a class="el" href="spamd_8php-source.html#l00084">Spamd::Start()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00511"></a>00511     {
<a name="l00512"></a>00512         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp.">SearchFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*$this-&gt;COMC\h*$name\b\h*$this-&gt;NVPS\h*([^$this-&gt;COMC'\"\n]*|'[^'\n]*'|\"[^\"\n]*\"|[^$this-&gt;COMC\n]*)(\h*|\h*$this-&gt;COMC.*)$/m"</span>);
<a name="l00513"></a>00513     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_651763904d218ee52464b258498c0255_cgraph.png" border="0" usemap="#classModel_651763904d218ee52464b258498c0255_cgraph_map" alt=""></center>
<map name="classModel_651763904d218ee52464b258498c0255_cgraph_map">
<area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="231,5,364,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_651763904d218ee52464b258498c0255_icgraph.png" border="0" usemap="#classModel_651763904d218ee52464b258498c0255_icgraph_map" alt=""></center>
<map name="classModel_651763904d218ee52464b258498c0255_icgraph_map">
<area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="231,5,412,32"><area shape="rect" href="classSpamd.html#13fcb586abfc47bfb334989272a7b080" title="Start module process(es)." alt="" coords="267,56,376,83"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="463,5,639,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="688,5,795,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="fc563954e2d371ee98dce6b41b639e9e"></a><!-- doxytag: member="Model::GetName" ref="fc563954e2d371ee98dce6b41b639e9e" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if Name exists. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>Name of NVP </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Name or NULL on failure </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00521">521</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="model_8php-source.html#l00331">SearchFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00466">GetValue()</a>, and <a class="el" href="openvpn_8php-source.html#l00160">Openvpn::IsClientConf()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00522"></a>00522     {
<a name="l00523"></a>00523         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp.">SearchFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*($name)(\h*$this-&gt;COMC.*|\h*)$/m"</span>);
<a name="l00524"></a>00524     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_fc563954e2d371ee98dce6b41b639e9e_cgraph.png" border="0" usemap="#classModel_fc563954e2d371ee98dce6b41b639e9e_cgraph_map" alt=""></center>
<map name="classModel_fc563954e2d371ee98dce6b41b639e9e_cgraph_map">
<area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="188,5,321,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_fc563954e2d371ee98dce6b41b639e9e_icgraph.png" border="0" usemap="#classModel_fc563954e2d371ee98dce6b41b639e9e_icgraph_map" alt=""></center>
<map name="classModel_fc563954e2d371ee98dce6b41b639e9e_icgraph_map">
<area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="207,5,335,32"><area shape="rect" href="classOpenvpn.html#901a6bb07c273c34ad67731c145fc435" title="Determines if the given conf file contains Client configuration." alt="" coords="187,56,355,83"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="404,5,580,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="673,5,780,32"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="419,56,565,83"><area shape="rect" href="classOpenvpn.html#06db90eb360164f2583a2bad0ed15b02" title="Sets configuration file based on config type provided." alt="" coords="416,107,568,133"><area shape="rect" href="classOpenvpn.html#684e6487e49004dde5412fc26111e5e4" title="General form for selecting, deleting, and copying an OpenVPN conf file." alt="" coords="629,107,824,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="fe2fc7ef7e2b7d0d373bbd2ecb9fc89f"></a><!-- doxytag: member="Model::GetDisabledName" ref="fe2fc7ef7e2b7d0d373bbd2ecb9fc89f" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetDisabledName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if commented-out Name exists. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>Name of NVP </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Commented Name or NULL on failure </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00532">532</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, and <a class="el" href="model_8php-source.html#l00331">SearchFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00480">GetDisabledValue()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00533"></a>00533     {
<a name="l00534"></a>00534         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp.">SearchFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*$this-&gt;COMC\h*($name)(\h*$this-&gt;COMC.*|\h*)$/m"</span>);
<a name="l00535"></a>00535     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_cgraph.png" border="0" usemap="#classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_cgraph_map" alt=""></center>
<map name="classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_cgraph_map">
<area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="241,5,375,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_icgraph.png" border="0" usemap="#classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_icgraph_map" alt=""></center>
<map name="classModel_fe2fc7ef7e2b7d0d373bbd2ecb9fc89f_icgraph_map">
<area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="241,5,423,32"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="473,5,649,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="699,5,805,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="38785ba7c6f768435ca036c8377083b4"></a><!-- doxytag: member="Model::SetConfValue" ref="38785ba7c6f768435ca036c8377083b4" args="($name, $newvalue, $conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SetConfValue           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>newvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the value of NVP configuration. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>string Config name </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$newvalue</em>&nbsp;</td><td>new Config value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$conf</em>&nbsp;</td><td>string Config type </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$group</em>&nbsp;</td><td>int <a class="el" href="classDansguardian.html">Dansguardian</a> group </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00544">544</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, <a class="el" href="dansguardian_2conf_8php-source.html#l00068">Config</a>, <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l00671">GetConfFile()</a>, <a class="el" href="model_8php-source.html#l00683">SetConfig()</a>, <a class="el" href="model_8php-source.html#l00570">SetNVP()</a>, and <a class="el" href="lib_2lib_8php-source.html#l00079">ViewError()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00545"></a>00545     {
<a name="l00546"></a>00546         $this-&gt;<a class="code" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided.">SetConfig</a>($conf);
<a name="l00547"></a>00547         <span class="keywordflow">if</span> (isset($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'])) {
<a name="l00548"></a>00548             $re= $this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'];
<a name="l00549"></a>00549         }
<a name="l00550"></a>00550         <span class="keywordflow">else</span> {
<a name="l00551"></a>00551             $re= '.*';
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553 
<a name="l00554"></a>00554         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">"/^($re)$/"</span>, $newvalue)) {
<a name="l00555"></a>00555             <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module.">GetConfFile</a>($conf, $group);
<a name="l00556"></a>00556             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#799897eaa58becf38f093bd89a3eb519" title="Changes value of NVP.">SetNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name, $newvalue);
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(_('Invalid value').<span class="stringliteral">": $name: $newvalue"</span>);
<a name="l00559"></a>00559         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Configuration change failed, invalid value: $name: $newvalue"</span>);
<a name="l00560"></a>00560         <span class="keywordflow">return</span> FALSE;
<a name="l00561"></a>00561     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_38785ba7c6f768435ca036c8377083b4_cgraph.png" border="0" usemap="#classModel_38785ba7c6f768435ca036c8377083b4_cgraph_map" alt=""></center>
<map name="classModel_38785ba7c6f768435ca036c8377083b4_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="241,5,332,32"><area shape="rect" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module." alt="" coords="215,56,359,83"><area shape="rect" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided." alt="" coords="220,107,353,133"><area shape="rect" href="classModel.html#799897eaa58becf38f093bd89a3eb519" title="Changes value of NVP." alt="" coords="227,157,347,184"><area shape="rect" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message." alt="" coords="244,208,329,235"><area shape="rect" href="lib_2lib_8php.html#998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="436,132,503,159"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="409,183,529,209"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="580,183,713,209"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_38785ba7c6f768435ca036c8377083b4_icgraph.png" border="0" usemap="#classModel_38785ba7c6f768435ca036c8377083b4_icgraph_map" alt=""></center>
<map name="classModel_38785ba7c6f768435ca036c8377083b4_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="213,5,320,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="799897eaa58becf38f093bd89a3eb519"></a><!-- doxytag: member="Model::SetNVP" ref="799897eaa58becf38f093bd89a3eb519" args="($file, $name, $newvalue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SetNVP           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>newvalue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Changes value of NVP. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>Name of NVP </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$newvalue</em>&nbsp;</td><td>New value to set </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean Success or failure </dd></dl>

<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Backslash should be escaped first, or causes double escapes </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00570">570</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="stats_8daily_8php-source.html#l00099">$file</a>, <a class="el" href="lib_2lib_8php-source.html#l00057">Escape()</a>, and <a class="el" href="model_8php-source.html#l00499">GetNVP()</a>.</p>

<p>Referenced by <a class="el" href="pf_8php-source.html#l00343">Pf::SetAfterhoursIf()</a>, <a class="el" href="model_8php-source.html#l00544">SetConfValue()</a>, <a class="el" href="pf_8php-source.html#l00326">Pf::SetIfs()</a>, and <a class="el" href="pf_8php-source.html#l00336">Pf::SetIntnet()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00571"></a>00571     {
<a name="l00572"></a>00572         <span class="keywordflow">if</span> (copy(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>.'.bak')) {
<a name="l00573"></a>00573             <span class="keywordflow">if</span> (($value= $this-&gt;<a class="code" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP.">GetNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name)) !== FALSE) {
<a name="l00575"></a>00575                 $value= <a class="code" href="lib_2lib_8php.html#998c26d78939d233b87794689e841eb9" title="Escapes chars.">Escape</a>($value, '\/$^*().<span class="stringliteral">"');</span>
<a name="l00576"></a>00576 <span class="stringliteral">                $re= "</span>^(\h*$name\b\h*$this-&gt;NVPS\h*)($value)(\h*$this-&gt;COMC.*|\h*)$<span class="stringliteral">";</span>
<a name="l00577"></a>00577 <span class="stringliteral"></span>
<a name="l00578"></a>00578 <span class="stringliteral">                $contents= preg_replace("</span>/$re/m<span class="stringliteral">", '${1}'.$newvalue.'${3}', file_get_contents($file), 1, $count);</span>
<a name="l00579"></a>00579 <span class="stringliteral">                if ($contents !== NULL &amp;&amp; $count == 1) {</span>
<a name="l00580"></a>00580 <span class="stringliteral">                    file_put_contents($file, $contents);</span>
<a name="l00581"></a>00581 <span class="stringliteral">                    return TRUE;</span>
<a name="l00582"></a>00582 <span class="stringliteral">                }</span>
<a name="l00583"></a>00583 <span class="stringliteral">                else {</span>
<a name="l00584"></a>00584 <span class="stringliteral">                    cwc_syslog(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, "</span>Cannot <span class="keyword">set</span> <span class="keyword">new</span> value <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name, $newvalue<span class="stringliteral">");</span>
<a name="l00585"></a>00585 <span class="stringliteral">                }</span>
<a name="l00586"></a>00586 <span class="stringliteral">            }</span>
<a name="l00587"></a>00587 <span class="stringliteral">            else {</span>
<a name="l00588"></a>00588 <span class="stringliteral">                cwc_syslog(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, "</span>Cannot find NVP: $file, $name<span class="stringliteral">");</span>
<a name="l00589"></a>00589 <span class="stringliteral">            }</span>
<a name="l00590"></a>00590 <span class="stringliteral">        }</span>
<a name="l00591"></a>00591 <span class="stringliteral">        else {</span>
<a name="l00592"></a>00592 <span class="stringliteral">            cwc_syslog(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, "</span>Cannot copy file $file<span class="stringliteral">");</span>
<a name="l00593"></a>00593 <span class="stringliteral">        }</span>
<a name="l00594"></a>00594 <span class="stringliteral">        return FALSE;</span>
<a name="l00595"></a>00595 <span class="stringliteral">    }</span>
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_799897eaa58becf38f093bd89a3eb519_cgraph.png" border="0" usemap="#classModel_799897eaa58becf38f093bd89a3eb519_cgraph_map" alt=""></center>
<map name="classModel_799897eaa58becf38f093bd89a3eb519_cgraph_map">
<area shape="rect" href="lib_2lib_8php.html#998c26d78939d233b87794689e841eb9" title="Escapes chars." alt="" coords="201,5,268,32"><area shape="rect" href="classModel.html#f029e9daf3e62424861794f377f49ed6" title="Reads value of NVP." alt="" coords="175,56,295,83"><area shape="rect" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp." alt="" coords="345,56,479,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_799897eaa58becf38f093bd89a3eb519_icgraph.png" border="0" usemap="#classModel_799897eaa58becf38f093bd89a3eb519_icgraph_map" alt=""></center>
<map name="classModel_799897eaa58becf38f093bd89a3eb519_icgraph_map">
<area shape="rect" href="classPf.html#88061cad8480c6c0856347ffe367c3f9" title="Sets afterhours interface name." alt="" coords="181,5,325,32"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="175,157,332,184"><area shape="rect" href="classPf.html#1bf8a6bec94a17fd9c420647e5f163bd" title="Sets interface names." alt="" coords="212,56,295,83"><area shape="rect" href="classPf.html#372750a2a1f52f4ca563d04c1b4c2d51" title="Sets int_net." alt="" coords="201,107,305,133"><area shape="rect" href="classPf.html#c94a5dee2c0a4692a17635d25ecbd2db" title="Pf::Pf" alt="" coords="405,56,464,83"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="381,157,488,184"></map>
</div>

</div>
</div><p>
<a class="anchor" name="d2e2c0802bba9a76b1fba3c9c9e31e6f"></a><!-- doxytag: member="Model::EnableConf" ref="d2e2c0802bba9a76b1fba3c9c9e31e6f" args="($name, $conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::EnableConf           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables a configuration item in conf file. 
<p>
Certain modules have multiple configuration files, hence they override this method.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>string Config name </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$conf</em>&nbsp;</td><td>string Config type </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$group</em>&nbsp;</td><td>int <a class="el" href="classDansguardian.html">Dansguardian</a> group </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean Result of action </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00607">607</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00608"></a>00608     {
<a name="l00609"></a>00609         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module.">GetConfFile</a>($conf, $group);
<a name="l00610"></a>00610         
<a name="l00611"></a>00611         $this-&gt;<a class="code" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided.">SetConfig</a>($conf);
<a name="l00612"></a>00612         <span class="keywordflow">if</span> ((isset($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'])) &amp;&amp; ($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'] === FALSE)) {
<a name="l00613"></a>00613             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#ca7b6388df3d0c63a53fdf3a0c9704f1" title="Enables a Name: configuration item without value.">EnableName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00614"></a>00614         }
<a name="l00615"></a>00615         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2cf1196e1cd1e3a9a9e563ad2fbb6d94" title="Enables an NVP: configuration item with value.">EnableNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00616"></a>00616     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d2e2c0802bba9a76b1fba3c9c9e31e6f_icgraph.png" border="0" usemap="#classModel_d2e2c0802bba9a76b1fba3c9c9e31e6f_icgraph_map" alt=""></center>
<map name="classModel_d2e2c0802bba9a76b1fba3c9c9e31e6f_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="197,5,304,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="20f53926124c84fffd476021fd6d58d7"></a><!-- doxytag: member="Model::DisableConf" ref="20f53926124c84fffd476021fd6d58d7" args="($name, $conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::DisableConf           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disables a configuration item in conf file. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00620">620</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00621"></a>00621     {
<a name="l00622"></a>00622         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#26aeff109e6dbc24a2f7053966132b23" title="Returns configuration file of the module.">GetConfFile</a>($conf, $group);
<a name="l00623"></a>00623         
<a name="l00624"></a>00624         $this-&gt;<a class="code" href="classModel.html#b65c89562f51a2ec2c46ed622bfcd321" title="Sets configuration file based on config type provided.">SetConfig</a>($conf);
<a name="l00625"></a>00625         <span class="keywordflow">if</span> ((isset($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'])) &amp;&amp; ($this-&gt;<a class="code" href="dansguardian_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a>[$name]['type'] === FALSE)) {
<a name="l00626"></a>00626             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#ab46785c290382866a4696ef0e5df9ec" title="Disables a Name.">DisableName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#da73681b1ab900e3a3065464ccc85bb9" title="Disables an NVP.">DisableNVP</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $name);
<a name="l00629"></a>00629     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_20f53926124c84fffd476021fd6d58d7_icgraph.png" border="0" usemap="#classModel_20f53926124c84fffd476021fd6d58d7_icgraph_map" alt=""></center>
<map name="classModel_20f53926124c84fffd476021fd6d58d7_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="200,5,307,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2cf1196e1cd1e3a9a9e563ad2fbb6d94"></a><!-- doxytag: member="Model::EnableNVP" ref="2cf1196e1cd1e3a9a9e563ad2fbb6d94" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::EnableNVP           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables an NVP: configuration item with value. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Config file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$name</em>&nbsp;</td><td>string Config name </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00636">636</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00637"></a>00637     {
<a name="l00638"></a>00638         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#3a3a50b49511d0d5f4373a15c83f60a8" title="Search and replace.">ReplaceRegexp</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*$this-&gt;COMC(\s*$name\b\s*$this-&gt;NVPS\s*.*)$/m"</span>, '${1}');
<a name="l00639"></a>00639     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ca7b6388df3d0c63a53fdf3a0c9704f1"></a><!-- doxytag: member="Model::EnableName" ref="ca7b6388df3d0c63a53fdf3a0c9704f1" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::EnableName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables a Name: configuration item without value. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00643">643</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snort_8php-source.html#l00238">Snort::EnableRule()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00644"></a>00644     {
<a name="l00645"></a>00645         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#3a3a50b49511d0d5f4373a15c83f60a8" title="Search and replace.">ReplaceRegexp</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^\h*$this-&gt;COMC(\h*$name(\h*$this-&gt;COMC.*|\h*))$/m"</span>, '${1}');
<a name="l00646"></a>00646     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_ca7b6388df3d0c63a53fdf3a0c9704f1_icgraph.png" border="0" usemap="#classModel_ca7b6388df3d0c63a53fdf3a0c9704f1_icgraph_map" alt=""></center>
<map name="classModel_ca7b6388df3d0c63a53fdf3a0c9704f1_icgraph_map">
<area shape="rect" href="classSnort.html#f834e2373267872dbde402fd8bf9475c" title="Snort::EnableRule" alt="" coords="207,5,343,32"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="392,5,493,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="da73681b1ab900e3a3065464ccc85bb9"></a><!-- doxytag: member="Model::DisableNVP" ref="da73681b1ab900e3a3065464ccc85bb9" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::DisableNVP           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disables an NVP. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00650">650</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00651"></a>00651     {
<a name="l00652"></a>00652         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#3a3a50b49511d0d5f4373a15c83f60a8" title="Search and replace.">ReplaceRegexp</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^(\h*$name\b\s*$this-&gt;NVPS\s*.*)$/m"</span>, $this-&gt;COMC.'${1}');
<a name="l00653"></a>00653     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ab46785c290382866a4696ef0e5df9ec"></a><!-- doxytag: member="Model::DisableName" ref="ab46785c290382866a4696ef0e5df9ec" args="($file, $name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::DisableName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disables a Name. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00657">657</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snort_8php-source.html#l00243">Snort::DisableRule()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00658"></a>00658     {
<a name="l00659"></a>00659         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#3a3a50b49511d0d5f4373a15c83f60a8" title="Search and replace.">ReplaceRegexp</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">"/^(\h*$name(\h*$this-&gt;COMC.*|\h*))$/m"</span>, $this-&gt;COMC.'${1}');
<a name="l00660"></a>00660     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_ab46785c290382866a4696ef0e5df9ec_icgraph.png" border="0" usemap="#classModel_ab46785c290382866a4696ef0e5df9ec_icgraph_map" alt=""></center>
<map name="classModel_ab46785c290382866a4696ef0e5df9ec_icgraph_map">
<area shape="rect" href="classSnort.html#e77a9577ad8e035007ebe9659f96ef64" title="Snort::DisableRule" alt="" coords="209,5,348,32"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="397,5,499,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="26aeff109e6dbc24a2f7053966132b23"></a><!-- doxytag: member="Model::GetConfFile" ref="26aeff109e6dbc24a2f7053966132b23" args="($conf, $group)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetConfFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>group</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns configuration file of the module. 
<p>
Certain modules have configuration divided into multiple pages/files, hence they override this method.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$conf</em>&nbsp;</td><td>string Config type </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$group</em>&nbsp;</td><td>int <a class="el" href="classDansguardian.html">Dansguardian</a> group </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Config file pathname </dd></dl>

<p>Reimplemented in <a class="el" href="classDansguardian.html#b5e3738b003f8fdc42d6fdd9217cb032">Dansguardian</a>, and <a class="el" href="classOpenvpn.html#107ca9a7254b6e4b4ace80fbe7a0ac23">Openvpn</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00671">671</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00480">GetDisabledValue()</a>, <a class="el" href="model_8php-source.html#l00466">GetValue()</a>, and <a class="el" href="model_8php-source.html#l00544">SetConfValue()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00672"></a>00672     {
<a name="l00673"></a>00673         <span class="keywordflow">return</span> $this-&gt;ConfFile;
<a name="l00674"></a>00674     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_26aeff109e6dbc24a2f7053966132b23_icgraph.png" border="0" usemap="#classModel_26aeff109e6dbc24a2f7053966132b23_icgraph_map" alt=""></center>
<map name="classModel_26aeff109e6dbc24a2f7053966132b23_icgraph_map">
<area shape="rect" href="classModel.html#bf62334346f19c56c5ed701af936ce66" title="Returns all disabled configuration for a given configuration type." alt="" coords="201,5,383,32"><area shape="rect" href="classModel.html#bf6ca5f5f6d8e69581e3e8e190df92cd" title="Returns all enabled configuration for a given configuration type." alt="" coords="228,56,356,83"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="443,107,600,133"><area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="433,56,609,83"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="659,81,765,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="b65c89562f51a2ec2c46ed622bfcd321"></a><!-- doxytag: member="Model::SetConfig" ref="b65c89562f51a2ec2c46ed622bfcd321" args="($confname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SetConfig           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>confname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets configuration file based on config type provided. 
<p>
Certain modules have configuration divided into multiple pages/files, hence they override this method.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$confname</em>&nbsp;</td><td>string Config type </td></tr>
  </table>
</dl>

<p>Reimplemented in <a class="el" href="classDansguardian.html#a530f2392bd6b0f22571343d0e47c2e5">Dansguardian</a>, <a class="el" href="classImspector.html#7d4c9d0b50b0844d165896cc28c2ff53">Imspector</a>, <a class="el" href="classOpenvpn.html#06db90eb360164f2583a2bad0ed15b02">Openvpn</a>, <a class="el" href="classSnort.html#823bf605552f064cb10face295298f95">Snort</a>, and <a class="el" href="classOpenvpn.html#2e397f38cf4d0aa5e9e50e64b56d2ee2">Openvpn</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00683">683</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00437">GetConfigValues()</a>, and <a class="el" href="model_8php-source.html#l00544">SetConfValue()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00684"></a>00684     {
<a name="l00685"></a>00685     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_b65c89562f51a2ec2c46ed622bfcd321_icgraph.png" border="0" usemap="#classModel_b65c89562f51a2ec2c46ed622bfcd321_icgraph_map" alt=""></center>
<map name="classModel_b65c89562f51a2ec2c46ed622bfcd321_icgraph_map">
<area shape="rect" href="classModel.html#4e346106b6f66e18e88b9d6c330655d1" title="Returns all configuration for a given configuration type." alt="" coords="188,5,364,32"><area shape="rect" href="classModel.html#38785ba7c6f768435ca036c8377083b4" title="Sets the value of NVP configuration." alt="" coords="197,56,355,83"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="413,31,520,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f50a822f45c1cd3b8aa5931d70e065c3"></a><!-- doxytag: member="Model::GetIpAddr" ref="f50a822f45c1cd3b8aa5931d70e065c3" args="($if)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetIpAddr           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>if</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extracts IP address assigned to an interface. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$if</em>&nbsp;</td><td>Interface name. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>IP of the interface. </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00692">692</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snortips_8php-source.html#l00192">Snortips::DelIPFromList()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00693"></a>00693     {
<a name="l00694"></a>00694         global <a class="code" href="defs_8php.html#d4c5dcc02e4d7d3548d600b54b954bcd" title="Common regexps.">$Re_Ip</a>;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696         <span class="keywordflow">if</span> (file_exists($this-&gt;confDir.<span class="stringliteral">"hostname.$if"</span>)) {
<a name="l00697"></a>00697             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f2576452d0c09887bf098e304ab6d3e1" title="Searches a given file with a given regexp.">SearchFile</a>($this-&gt;confDir.<span class="stringliteral">"hostname.$if"</span>, <span class="stringliteral">"/^\h*inet\h*($Re_Ip)\h*$Re_Ip\b.*$/m"</span>);
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699         <span class="keywordflow">return</span> FALSE;
<a name="l00700"></a>00700     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_f50a822f45c1cd3b8aa5931d70e065c3_icgraph.png" border="0" usemap="#classModel_f50a822f45c1cd3b8aa5931d70e065c3_icgraph_map" alt=""></center>
<map name="classModel_f50a822f45c1cd3b8aa5931d70e065c3_icgraph_map">
<area shape="rect" href="classSnortips.html#47f7c429e6b97de09357ee361ea13bfc" title="Deletes a list of IPs from a list." alt="" coords="191,5,364,32"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="413,5,549,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="13d954623f5fdc936047f3273a20abd8"></a><!-- doxytag: member="Model::CheckAuthentication" ref="13d954623f5fdc936047f3273a20abd8" args="($user, $passwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CheckAuthentication           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>passwd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks user's password supplied against the one in htpasswd file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$user</em>&nbsp;</td><td>User name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$passwd</em>&nbsp;</td><td>Password. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if passwd matches, FALSE otherwise. </dd></dl>

<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Args should never be empty, htpasswd expects 2 args</dd></dl>
Passwords in htpasswd file are SHA encrypted.<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Have to trim newline chars, or passwds do not match </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00708">708</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00709"></a>00709     {
<a name="l00711"></a>00711         $passwd= $passwd == '' ? <span class="stringliteral">"''"</span> : $passwd;
<a name="l00712"></a>00712 
<a name="l00714"></a>00714         exec(<span class="stringliteral">"/usr/bin/htpasswd -bn -s '' $passwd 2&gt;&amp;1"</span>, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l00715"></a>00715         <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l00716"></a>00716             $htpasswd= ltrim($output[0], <span class="charliteral">':'</span>);
<a name="l00717"></a>00717         
<a name="l00719"></a>00719             $passwdfile= file($this-&gt;passwdFile, FILE_IGNORE_NEW_LINES);
<a name="l00720"></a>00720             
<a name="l00721"></a>00721             <span class="comment">// Do not use preg_match() here. If there is more than one line (passwd) for a user in passwdFile,</span>
<a name="l00722"></a>00722             <span class="comment">// this array method ensures that only one password apply to each user, the last one in passwdFile.</span>
<a name="l00723"></a>00723             <span class="comment">// This should never happen actually, but in any case.</span>
<a name="l00724"></a>00724             $passwdlist= array();
<a name="l00725"></a>00725             <span class="keywordflow">foreach</span> ($passwdfile as $nvp) {
<a name="l00726"></a>00726                 list($u, $p)= explode(<span class="charliteral">':'</span>, $nvp, 2);
<a name="l00727"></a>00727                 $passwdlist[$u]= $p;
<a name="l00728"></a>00728             }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730             <span class="keywordflow">if</span> ($passwdlist[$user] === $htpasswd) {
<a name="l00731"></a>00731                 <span class="keywordflow">return</span> TRUE;
<a name="l00732"></a>00732             }
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(implode(<span class="stringliteral">"\n"</span>, $output));
<a name="l00735"></a>00735         <span class="keywordflow">return</span> FALSE;
<a name="l00736"></a>00736     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_13d954623f5fdc936047f3273a20abd8_icgraph.png" border="0" usemap="#classModel_13d954623f5fdc936047f3273a20abd8_icgraph_map" alt=""></center>
<map name="classModel_13d954623f5fdc936047f3273a20abd8_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="256,5,363,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="66be6edcbd364e21485e03144cfa2a46"></a><!-- doxytag: member="Model::GetLogStartDate" ref="66be6edcbd364e21485e03144cfa2a46" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetLogStartDate           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extracts the datetime of the first line in the log file. 
<p>
Works only on uncompressed log files.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Log file pathname </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>string DateTime or warning if archive is compressed </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00745">745</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00746"></a>00746     {
<a name="l00747"></a>00747         <span class="keywordflow">if</span> (preg_match('/.*\.gz$/', <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l00748"></a>00748             $tmpfile= $this-&gt;<a class="code" href="classModel.html#29102c6076b42c9519b995bc28aa979d" title="Returns the log file name in the tmp location.">GetTmpLogFileName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l00749"></a>00749             <span class="comment">// Log file may have been rotated, shifting compressed archive file numbers,</span>
<a name="l00750"></a>00750             <span class="comment">// hence modification check</span>
<a name="l00751"></a>00751             <span class="keywordflow">if</span> (file_exists($tmpfile) &amp;&amp; !$this-&gt;<a class="code" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated.">IsLogFileModified</a>($tmpfile)) {
<a name="l00752"></a>00752                 <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $tmpfile;
<a name="l00753"></a>00753             }
<a name="l00754"></a>00754         }
<a name="l00755"></a>00755         
<a name="l00756"></a>00756         <span class="keywordflow">if</span> (!preg_match('/.*\.gz$/', <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l00757"></a>00757             $logline= $this-&gt;<a class="code" href="classModel.html#3251fdfaf9bdde5a6ffb16a6b13e9717" title="Gets first line of file.">GetFileFirstLine</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l00758"></a>00758             
<a name="l00759"></a>00759             $this-&gt;<a class="code" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser.">ParseLogLine</a>($logline, $cols);
<a name="l00760"></a>00760             <span class="keywordflow">return</span> $cols['Date'].<span class="charliteral">' '</span>.$cols['Time'];
<a name="l00761"></a>00761         }
<a name="l00762"></a>00762         <span class="keywordflow">return</span> <a class="code" href="lib_2lib_8php.html#365ac814f4e5c717bd9ce48ab65b97b5" title="For classifying gettext strings into files.">_CONTROL</a>('Compressed');
<a name="l00763"></a>00763     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_66be6edcbd364e21485e03144cfa2a46_icgraph.png" border="0" usemap="#classModel_66be6edcbd364e21485e03144cfa2a46_icgraph_map" alt=""></center>
<map name="classModel_66be6edcbd364e21485e03144cfa2a46_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="235,5,341,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3251fdfaf9bdde5a6ffb16a6b13e9717"></a><!-- doxytag: member="Model::GetFileFirstLine" ref="3251fdfaf9bdde5a6ffb16a6b13e9717" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetFileFirstLine           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets first line of file. 
<p>
Used to get the start date of log files.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Log file pathname </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int First line in file </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00772">772</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00773"></a>00773     {
<a name="l00774"></a>00774         $cmd= preg_replace('/&lt;LF&gt;/', <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $this-&gt;CmdLogStart);
<a name="l00775"></a>00775         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($cmd);
<a name="l00776"></a>00776     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0e43ca38ee4cee9f29e6b8192024dc28"></a><!-- doxytag: member="Model::GetFileLineCount" ref="0e43ca38ee4cee9f29e6b8192024dc28" args="($file, $re= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetFileLineCount           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>re</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets line count of file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$re</em>&nbsp;</td><td>string Regexp to get count of a restricted result set </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int Line count </dd></dl>

<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Input redirection is necessary, otherwise wc adds file name to its output too </dd></dl>

<p>Reimplemented in <a class="el" href="classOpenssh.html#61d6e88a6866329d5f79c025df847588">Openssh</a>, <a class="el" href="classPf.html#42814294fe3e99928c6a5283b23df88b">Pf</a>, and <a class="el" href="classSpamassassin.html#00d7fb7a0c02769be1500209f1c1b3ff">Spamassassin</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00784">784</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01478">CountDiffLogLines()</a>, <a class="el" href="model_8php-source.html#l00089">Model()</a>, and <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00785"></a>00785     {
<a name="l00786"></a>00786         <span class="keywordflow">if</span> ($re == '') {
<a name="l00788"></a>00788             $cmd= <span class="stringliteral">"/usr/bin/wc -l &lt; $file"</span>;
<a name="l00789"></a>00789         }
<a name="l00790"></a>00790         <span class="keywordflow">else</span> {
<a name="l00791"></a>00791             $re= escapeshellarg($re);
<a name="l00792"></a>00792             $cmd= <span class="stringliteral">"/usr/bin/grep -a -E $re $file | /usr/bin/wc -l"</span>;
<a name="l00793"></a>00793         }
<a name="l00794"></a>00794         <span class="comment">// OpenBSD wc returns with leading blanks</span>
<a name="l00795"></a>00795         <span class="keywordflow">return</span> trim($this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($cmd));
<a name="l00796"></a>00796     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_0e43ca38ee4cee9f29e6b8192024dc28_icgraph.png" border="0" usemap="#classModel_0e43ca38ee4cee9f29e6b8192024dc28_icgraph_map" alt=""></center>
<map name="classModel_0e43ca38ee4cee9f29e6b8192024dc28_icgraph_map">
<area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="235,5,424,32"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="473,31,623,57"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1037,56,1144,83"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="673,31,799,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="848,5,989,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7f8992e5e1ce2fb1252e28a4697e1d8d"></a><!-- doxytag: member="Model::GetLogs" ref="7f8992e5e1ce2fb1252e28a4697e1d8d" args="($file, $end, $count, $re= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetLogs           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>re</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets lines in file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$end</em>&nbsp;</td><td>int Head option, start line </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$count</em>&nbsp;</td><td>int Tail option, page line count </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$re</em>&nbsp;</td><td>string Regexp to restrict the result set </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>serialized Log lines </dd></dl>

<p>Reimplemented in <a class="el" href="classOpenssh.html#a2522838624ccdf57da6c8dc8b3dcfff">Openssh</a>, <a class="el" href="classPf.html#c539e7d3b21a210f89d284325a6373b0">Pf</a>, and <a class="el" href="classSpamassassin.html#8a7106a1f0bdc04ac7cbda30de170945">Spamassassin</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00806">806</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00807"></a>00807     {
<a name="l00808"></a>00808         <span class="comment">// Empty $re is not an issue for grep, greps all</span>
<a name="l00809"></a>00809         $re= escapeshellarg($re);
<a name="l00810"></a>00810         $cmd= <span class="stringliteral">"/usr/bin/grep -a -E $re $file | /usr/bin/head -$end | /usr/bin/tail -$count"</span>;
<a name="l00811"></a>00811         
<a name="l00812"></a>00812         exec($cmd, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l00813"></a>00813         
<a name="l00814"></a>00814         <a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>= array();
<a name="l00815"></a>00815         <span class="keywordflow">foreach</span> ($output as $line) {
<a name="l00816"></a>00816             unset($cols);
<a name="l00817"></a>00817             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser.">ParseLogLine</a>($line, $cols)) {
<a name="l00818"></a>00818                 <a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>[]= $cols;
<a name="l00819"></a>00819             }
<a name="l00820"></a>00820         }
<a name="l00821"></a>00821         <span class="keywordflow">return</span> serialize(<a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>);
<a name="l00822"></a>00822     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_7f8992e5e1ce2fb1252e28a4697e1d8d_icgraph.png" border="0" usemap="#classModel_7f8992e5e1ce2fb1252e28a4697e1d8d_icgraph_map" alt=""></center>
<map name="classModel_7f8992e5e1ce2fb1252e28a4697e1d8d_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="176,5,283,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4795ba110e63f9818b053f98bafb380e"></a><!-- doxytag: member="Model::GetLiveLogs" ref="4795ba110e63f9818b053f98bafb380e" args="($file, $count, $re= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetLiveLogs           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>re</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets logs for live logs pages. 
<p>
Used to extract lines in last section of the log file or of the lines grep'd.<p>
Difference from the archives method is that this one always gets the tail of the log or grepped lines.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string Log file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$count</em>&nbsp;</td><td>int Tail lenght, page line count </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$re</em>&nbsp;</td><td>string Regexp to restrict the result set </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>serialized Log lines </dd></dl>

<p>Reimplemented in <a class="el" href="classOpenssh.html#684a7bae74bc190a59ffbb1cc957dd03">Openssh</a>, <a class="el" href="classPf.html#3f0229855f446f856d4460de5264db4d">Pf</a>, and <a class="el" href="classSpamassassin.html#c2fe7f0398515200232f71f0dc8b45e2">Spamassassin</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00837">837</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00838"></a>00838     {
<a name="l00839"></a>00839         <span class="comment">// Empty $re is not an issue for grep, greps all</span>
<a name="l00840"></a>00840         $re= escapeshellarg($re);
<a name="l00841"></a>00841         $cmd= <span class="stringliteral">"/usr/bin/grep -a -E $re $file | /usr/bin/tail -$count"</span>;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843         exec($cmd, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l00844"></a>00844         
<a name="l00845"></a>00845         <a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>= array();
<a name="l00846"></a>00846         <span class="keywordflow">foreach</span> ($output as $line) {
<a name="l00847"></a>00847             unset($cols);
<a name="l00848"></a>00848             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser.">ParseLogLine</a>($line, $cols)) {
<a name="l00849"></a>00849                 <a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>[]= $cols;
<a name="l00850"></a>00850             }
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852         <span class="keywordflow">return</span> serialize(<a class="code" href="logsreport_8php.html#1985bbbc5349038a012f02c97f5276e6">$logs</a>);
<a name="l00853"></a>00853     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_4795ba110e63f9818b053f98bafb380e_icgraph.png" border="0" usemap="#classModel_4795ba110e63f9818b053f98bafb380e_icgraph_map" alt=""></center>
<map name="classModel_4795ba110e63f9818b053f98bafb380e_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="203,5,309,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7b9bda42c0ab93f85ad329597d8c7093"></a><!-- doxytag: member="Model::Reload" ref="7b9bda42c0ab93f85ad329597d8c7093" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Reload           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends HUP to the module pid. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00857">857</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00858"></a>00858     {
<a name="l00859"></a>00859         <span class="keywordflow">if</span> ($this-&gt;PidFile !== '') {
<a name="l00860"></a>00860             <span class="keywordflow">if</span> (($pid= $this-&gt;<a class="code" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents.">GetFile</a>($this-&gt;PidFile)) !== FALSE) {
<a name="l00861"></a>00861                 $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"/bin/kill -HUP $pid"</span>);
<a name="l00862"></a>00862                 <span class="keywordflow">return</span> TRUE;
<a name="l00863"></a>00863             }
<a name="l00864"></a>00864         }
<a name="l00865"></a>00865         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(_('Cannot <span class="keyword">get</span> pid'));
<a name="l00866"></a>00866         <span class="keywordflow">return</span> FALSE;
<a name="l00867"></a>00867     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_7b9bda42c0ab93f85ad329597d8c7093_icgraph.png" border="0" usemap="#classModel_7b9bda42c0ab93f85ad329597d8c7093_icgraph_map" alt=""></center>
<map name="classModel_7b9bda42c0ab93f85ad329597d8c7093_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="165,5,272,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4cdbaac69ea2e094a98caae1cbb7f2aa"></a><!-- doxytag: member="Model::Start" ref="4cdbaac69ea2e094a98caae1cbb7f2aa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Start           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start module process(es). 
<p>
Tries PROC_STAT_TIMEOUT times.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean TRUE if the process starts</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000026">Todo:</a></b></dt><dd>Actually should stop retying on some error conditions? </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000026">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>

<p>Reimplemented in <a class="el" href="classDhcpd.html#e19fff168865b559ee5fdf10c3dd71c4">Dhcpd</a>, <a class="el" href="classPf.html#ad21a62131dfc84c111b35355928adf7">Pf</a>, <a class="el" href="classPmacct.html#fef0c6ec06230e6e0a2ee6b7454b01b0">Pmacct</a>, and <a class="el" href="classSpamd.html#13fcb586abfc47bfb334989272a7b080">Spamd</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00877">877</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="apache_2include_8php-source.html#l00044">Apache::Apache()</a>, <a class="el" href="model_8php-source.html#l00089">Model()</a>, <a class="el" href="openvpn_8php-source.html#l00050">Openvpn::Openvpn()</a>, and <a class="el" href="snort_8php-source.html#l00051">Snort::Snort()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00878"></a>00878     {
<a name="l00879"></a>00879         global <a class="code" href="Controller_2lib_8php.html#934f13a80ef6f9bc5b5f861e6746792c" title="Redirect file for Controller().">$TmpFile</a>;
<a name="l00880"></a>00880 
<a name="l00881"></a>00881         $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($this-&gt;StartCmd);
<a name="l00882"></a>00882         
<a name="l00883"></a>00883         $count= 0;
<a name="l00884"></a>00884         <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {
<a name="l00885"></a>00885             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>()) {
<a name="l00886"></a>00886                 <span class="keywordflow">return</span> TRUE;
<a name="l00887"></a>00887             }
<a name="l00889"></a>00889             exec('/bin/sleep .1');
<a name="l00890"></a>00890         }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892         <span class="comment">// Check one last time due to the last sleep in the loop</span>
<a name="l00893"></a>00893         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>()) {
<a name="l00894"></a>00894             <span class="keywordflow">return</span> TRUE;
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896         
<a name="l00897"></a>00897         <span class="comment">// Start command is redirected to tmp file</span>
<a name="l00898"></a>00898         $output= file_get_contents($TmpFile);
<a name="l00899"></a>00899         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>($output);
<a name="l00900"></a>00900         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Start failed with: $output"</span>);
<a name="l00901"></a>00901         <span class="keywordflow">return</span> FALSE;
<a name="l00902"></a>00902     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_4cdbaac69ea2e094a98caae1cbb7f2aa_icgraph.png" border="0" usemap="#classModel_4cdbaac69ea2e094a98caae1cbb7f2aa_icgraph_map" alt=""></center>
<map name="classModel_4cdbaac69ea2e094a98caae1cbb7f2aa_icgraph_map">
<area shape="rect" href="classApache.html#4f93f9a47b2a4bdca07820dbbfe7ea3a" title="Apache::Apache" alt="" coords="165,5,291,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="175,56,281,83"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="155,107,301,133"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="177,157,279,184"></map>
</div>

</div>
</div><p>
<a class="anchor" name="abaab1028bd3cbc20d4bc77f8a222f98"></a><!-- doxytag: member="Model::Stop" ref="abaab1028bd3cbc20d4bc77f8a222f98" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Stop           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops module process(es). 
<p>
Tries PROC_STAT_TIMEOUT times.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean TRUE if the process killed successfully</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000028">Todo:</a></b></dt><dd>Actually should stop retrying on some error conditions? </dd></dl>

<p>Reimplemented in <a class="el" href="classApache.html#c79bfdc055a902f983c7dcde10c4db2a">Apache</a>, <a class="el" href="classPf.html#7083f40e8e30bd31c06dcde245387221">Pf</a>, <a class="el" href="classSnort.html#8bd1508972232b8d24c23a4964e243ba">Snort</a>, <a class="el" href="classSnortips.html#b9153b5b08c1d24aa9206bbbbc952233">Snortips</a>, <a class="el" href="classSpamassassin.html#9ec9f1be30b7f18daf84f801e6fe2259">Spamassassin</a>, and <a class="el" href="classSpamd.html#d52d72d107d4cf65ced5eb9c06d732c7">Spamd</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00912">912</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>, and <a class="el" href="openvpn_8php-source.html#l00050">Openvpn::Openvpn()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00913"></a>00913     {
<a name="l00914"></a>00914         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#9ae213c714d91523d650b34cea11dd75" title="Stops the given process.">Pkill</a>($this-&gt;Proc);
<a name="l00915"></a>00915     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_abaab1028bd3cbc20d4bc77f8a222f98_icgraph.png" border="0" usemap="#classModel_abaab1028bd3cbc20d4bc77f8a222f98_icgraph_map" alt=""></center>
<map name="classModel_abaab1028bd3cbc20d4bc77f8a222f98_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="172,5,279,32"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="152,56,299,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9ae213c714d91523d650b34cea11dd75"></a><!-- doxytag: member="Model::Pkill" ref="9ae213c714d91523d650b34cea11dd75" args="($proc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Pkill           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>proc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops the given process. 
<p>
Used to kill processes without a model definition, hence $proc param.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$proc</em>&nbsp;</td><td>string Process name </td></tr>
  </table>
</dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000029">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00923">923</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="spamd_8php-source.html#l00078">Spamd::Stop()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00924"></a>00924     {
<a name="l00925"></a>00925         global <a class="code" href="Controller_2lib_8php.html#934f13a80ef6f9bc5b5f861e6746792c" title="Redirect file for Controller().">$TmpFile</a>;
<a name="l00926"></a>00926         
<a name="l00927"></a>00927         $cmd= '/usr/bin/pkill -x '.$proc;
<a name="l00928"></a>00928         
<a name="l00929"></a>00929         $count= 0;
<a name="l00930"></a>00930         <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {
<a name="l00931"></a>00931             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>($proc)) {
<a name="l00932"></a>00932                 <span class="keywordflow">return</span> TRUE;
<a name="l00933"></a>00933             }
<a name="l00934"></a>00934             $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"$cmd &gt; $TmpFile 2&gt;&amp;1"</span>);
<a name="l00936"></a>00936             exec('/bin/sleep .1');
<a name="l00937"></a>00937         }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939         <span class="comment">// Check one last time due to the last sleep in the loop</span>
<a name="l00940"></a>00940         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>($proc)) {
<a name="l00941"></a>00941             <span class="keywordflow">return</span> TRUE;
<a name="l00942"></a>00942         }
<a name="l00943"></a>00943         
<a name="l00944"></a>00944         <span class="comment">// Pkill command is redirected to tmp file</span>
<a name="l00945"></a>00945         $output= file_get_contents($TmpFile);
<a name="l00946"></a>00946         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>($output);
<a name="l00947"></a>00947         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Pkill failed for $proc with: $output"</span>);
<a name="l00948"></a>00948         <span class="keywordflow">return</span> FALSE;
<a name="l00949"></a>00949     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_9ae213c714d91523d650b34cea11dd75_icgraph.png" border="0" usemap="#classModel_9ae213c714d91523d650b34cea11dd75_icgraph_map" alt=""></center>
<map name="classModel_9ae213c714d91523d650b34cea11dd75_icgraph_map">
<area shape="rect" href="classSpamd.html#d52d72d107d4cf65ced5eb9c06d732c7" title="Stops module process(es)." alt="" coords="147,5,253,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0da158bc289bbdfdf7000f7466d90bbd"></a><!-- doxytag: member="Model::Kill" ref="0da158bc289bbdfdf7000f7466d90bbd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::Kill           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops module's parent process with its pid. 
<p>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000030">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>
<p>
<dl class="attention" compact><dt><b>Attention:</b></dt><dd>Missing pid file means success, proc is not running anyway </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00953">953</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="spamassassin_8php-source.html#l00093">Spamassassin::Stop()</a>, and <a class="el" href="snortips_8php-source.html#l00118">Snortips::Stop()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00954"></a>00954     {
<a name="l00955"></a>00955         global <a class="code" href="Controller_2lib_8php.html#934f13a80ef6f9bc5b5f861e6746792c" title="Redirect file for Controller().">$TmpFile</a>;
<a name="l00956"></a>00956         
<a name="l00957"></a>00957         <span class="keywordflow">if</span> (($pid= $this-&gt;<a class="code" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents.">GetFile</a>($this-&gt;PidFile)) !== FALSE) {
<a name="l00958"></a>00958             $cmd= <span class="stringliteral">"/bin/kill $pid"</span>;
<a name="l00959"></a>00959         
<a name="l00960"></a>00960             $count= 0;
<a name="l00961"></a>00961             <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {
<a name="l00962"></a>00962                 <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>()) {
<a name="l00963"></a>00963                     <span class="keywordflow">return</span> TRUE;
<a name="l00964"></a>00964                 }
<a name="l00965"></a>00965                 $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"$cmd &gt; $TmpFile 2&gt;&amp;1"</span>);
<a name="l00967"></a>00967                 exec('/bin/sleep .1');
<a name="l00968"></a>00968             }
<a name="l00969"></a>00969 
<a name="l00970"></a>00970             <span class="comment">// Check one last time due to the last sleep in the loop</span>
<a name="l00971"></a>00971             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>()) {
<a name="l00972"></a>00972                 <span class="keywordflow">return</span> TRUE;
<a name="l00973"></a>00973             }
<a name="l00974"></a>00974             
<a name="l00975"></a>00975             <span class="comment">// Kill command is redirected to tmp file</span>
<a name="l00976"></a>00976             $output= file_get_contents($TmpFile);
<a name="l00977"></a>00977             <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>($output);
<a name="l00978"></a>00978             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Kill failed with: $output"</span>);
<a name="l00979"></a>00979             <span class="keywordflow">return</span> FALSE;
<a name="l00980"></a>00980         }
<a name="l00982"></a>00982         <span class="keywordflow">return</span> TRUE;
<a name="l00983"></a>00983     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_0da158bc289bbdfdf7000f7466d90bbd_icgraph.png" border="0" usemap="#classModel_0da158bc289bbdfdf7000f7466d90bbd_icgraph_map" alt=""></center>
<map name="classModel_0da158bc289bbdfdf7000f7466d90bbd_icgraph_map">
<area shape="rect" href="classSpamassassin.html#9ec9f1be30b7f18daf84f801e6fe2259" title="Stops module process(es)." alt="" coords="139,5,291,32"><area shape="rect" href="classSnortips.html#b9153b5b08c1d24aa9206bbbbc952233" title="Stops module process(es)." alt="" coords="159,56,271,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="facf369640096d263c1a6685f444d1d0"></a><!-- doxytag: member="Model::KillPid" ref="facf369640096d263c1a6685f444d1d0" args="($pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::KillPid           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pid</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Kills process with the given pid. 
<p>
Tries PROC_STAT_TIMEOUT times.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$pid</em>&nbsp;</td><td>int Pid </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean TRUE if the process killed successfully</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>Actually should stop retrying on some error conditions? </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>Check $TmpFile for error messages, if so break out instead </dd></dl>
<p>
Kill command is redirected to tmp file 
<p>Definition at line <a class="el" href="model_8php-source.html#l00994">994</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snort_8php-source.html#l00164">Snort::StopProcess()</a>, and <a class="el" href="openvpn_8php-source.html#l00112">Openvpn::StopProcess()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00995"></a>00995     {
<a name="l00996"></a>00996         global <a class="code" href="Controller_2lib_8php.html#934f13a80ef6f9bc5b5f861e6746792c" title="Redirect file for Controller().">$TmpFile</a>;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998         $cmd= '/bin/kill '.$pid;
<a name="l00999"></a>00999 
<a name="l01000"></a>01000         $count= 0;
<a name="l01001"></a>01001         <span class="keywordflow">while</span> ($count++ &lt; self::PROC_STAT_TIMEOUT) {
<a name="l01002"></a>01002             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classModel.html#a8e65c65a217937e4d65ed0be05b30c8" title="Checks if the pid is running.">IsModulePidRunning</a>($pid)) {
<a name="l01003"></a>01003                 <span class="keywordflow">return</span> TRUE;
<a name="l01004"></a>01004             }
<a name="l01005"></a>01005             $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"$cmd &gt; $TmpFile 2&gt;&amp;1"</span>);
<a name="l01007"></a>01007             exec('/bin/sleep .1');
<a name="l01008"></a>01008         }
<a name="l01009"></a>01009 
<a name="l01011"></a>01011         $output= file_get_contents($TmpFile);
<a name="l01012"></a>01012         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>($output);
<a name="l01013"></a>01013         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Kill failed with: $output"</span>);
<a name="l01014"></a>01014 
<a name="l01015"></a>01015         <span class="comment">// Check one last time due to the last sleep in the loop</span>
<a name="l01016"></a>01016         <span class="keywordflow">return</span> !$this-&gt;<a class="code" href="classModel.html#a8e65c65a217937e4d65ed0be05b30c8" title="Checks if the pid is running.">IsModulePidRunning</a>($pid);
<a name="l01017"></a>01017     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_facf369640096d263c1a6685f444d1d0_icgraph.png" border="0" usemap="#classModel_facf369640096d263c1a6685f444d1d0_icgraph_map" alt=""></center>
<map name="classModel_facf369640096d263c1a6685f444d1d0_icgraph_map">
<area shape="rect" href="classSnort.html#0577a6dfbdd9e38585d9e784abae1f02" title="Stops snort process started with the given interface." alt="" coords="172,5,319,32"><area shape="rect" href="classOpenvpn.html#4aa0b64a5a24f8a29b0b5d6f4be90ce7" title="Stops openvpn process started with the given conf file." alt="" coords="161,56,329,83"><area shape="rect" href="classSnort.html#ce6c82705690744cdc5ae36ed96a7ce1" title="Snort::Snort" alt="" coords="401,5,503,32"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="379,56,525,83"><area shape="rect" href="classOpenvpn.html#1a740c26a8bd12e130a95b860fd9e664" title="Starts module process(es)." alt="" coords="384,107,520,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a8e65c65a217937e4d65ed0be05b30c8"></a><!-- doxytag: member="Model::IsModulePidRunning" ref="a8e65c65a217937e4d65ed0be05b30c8" args="($pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::IsModulePidRunning           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pid</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the pid is running. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$pid</em>&nbsp;</td><td>int Pid </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean TRUE if process is running </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01024">1024</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01025"></a>01025     {
<a name="l01026"></a>01026         $pidcmd= <span class="stringliteral">"/bin/ps -o pid -p $pid | /usr/bin/grep '$pid'"</span>;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         $output= $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($pidcmd);
<a name="l01029"></a>01029 
<a name="l01030"></a>01030         <span class="keywordflow">return</span> ($output !== '');
<a name="l01031"></a>01031     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b72b9a2165463d9ed74e2387ad8902f0"></a><!-- doxytag: member="Model::IsRunning" ref="b72b9a2165463d9ed74e2387ad8902f0" args="($proc= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::IsRunning           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>proc</em> = <code>''</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the process(es) is running. 
<p>
Uses ps with grep.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$proc</em>&nbsp;</td><td>string Module process name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean TRUE if there is any process running </dd></dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd>Should use pid files instead of ps, if possible at all </dd></dl>

<p>Reimplemented in <a class="el" href="classClamav.html#5419bf667527a45e4ce992ceca521778">Clamav</a>, <a class="el" href="classMonitoring.html#cff67ff3fb51553d7cc71f156729b8f9">Monitoring</a>, and <a class="el" href="classPf.html#2707ef68ce41cd0e6ad56f63d010e46d">Pf</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01040">1040</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snortips_8php-source.html#l00134">Snortips::GetInfo()</a>, and <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01041"></a>01041     {
<a name="l01042"></a>01042         <span class="keywordflow">if</span> ($proc == '') {
<a name="l01043"></a>01043             $proc= $this-&gt;Proc;
<a name="l01044"></a>01044         }
<a name="l01045"></a>01045     
<a name="l01047"></a>01047         $cmd= preg_replace('/&lt;PROC&gt;/', escapeshellarg($proc), $this-&gt;psCmd);
<a name="l01048"></a>01048         exec($cmd, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01049"></a>01049         <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01050"></a>01050             <span class="keywordflow">return</span> count($this-&gt;<a class="code" href="classModel.html#87f2eb3dfeadfafef73376a1d5f23dbd" title="Selects user processes from ps output.">SelectProcesses</a>($output)) &gt; 0;
<a name="l01051"></a>01051         }
<a name="l01052"></a>01052         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(implode(<span class="stringliteral">"\n"</span>, $output));
<a name="l01053"></a>01053         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"No such process: $proc"</span>);
<a name="l01054"></a>01054         <span class="keywordflow">return</span> FALSE;
<a name="l01055"></a>01055     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_b72b9a2165463d9ed74e2387ad8902f0_icgraph.png" border="0" usemap="#classModel_b72b9a2165463d9ed74e2387ad8902f0_icgraph_map" alt=""></center>
<map name="classModel_b72b9a2165463d9ed74e2387ad8902f0_icgraph_map">
<area shape="rect" href="classSnortips.html#ca6dd5c39a222c982d55a9786b4068c1" title="Snortips::GetInfo" alt="" coords="185,31,316,57"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="197,81,304,108"><area shape="rect" href="classSnortips.html#167a35c683c8aaaf244b488ead4e3a3d" title="Displays a list of blocked, blacklisted, or whitelisted IPs." alt="" coords="367,5,583,32"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="407,56,543,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="8e4d47e167d2ee8325f09289c7538c02"></a><!-- doxytag: member="Model::GetProcList" ref="8e4d47e167d2ee8325f09289c7538c02" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetProcList           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the list of processes running. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01059">1059</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01060"></a>01060     {
<a name="l01061"></a>01061         $cmd= preg_replace('/&lt;PROC&gt;/', escapeshellarg($this-&gt;Proc), $this-&gt;psCmd);
<a name="l01062"></a>01062         exec($cmd, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01063"></a>01063         <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01064"></a>01064             <span class="keywordflow">return</span> serialize($this-&gt;<a class="code" href="classModel.html#87f2eb3dfeadfafef73376a1d5f23dbd" title="Selects user processes from ps output.">SelectProcesses</a>($output));
<a name="l01065"></a>01065         }
<a name="l01066"></a>01066         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(implode(<span class="stringliteral">"\n"</span>, $output));
<a name="l01067"></a>01067         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Process list failed for $this-&gt;Proc"</span>);
<a name="l01068"></a>01068         <span class="keywordflow">return</span> FALSE;
<a name="l01069"></a>01069     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_8e4d47e167d2ee8325f09289c7538c02_icgraph.png" border="0" usemap="#classModel_8e4d47e167d2ee8325f09289c7538c02_icgraph_map" alt=""></center>
<map name="classModel_8e4d47e167d2ee8325f09289c7538c02_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="197,5,304,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="87f2eb3dfeadfafef73376a1d5f23dbd"></a><!-- doxytag: member="Model::SelectProcesses" ref="87f2eb3dfeadfafef73376a1d5f23dbd" args="($psout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SelectProcesses           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>psout</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Selects user processes from ps output. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$psout</em>&nbsp;</td><td>arrary ps output </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>array Parsed ps output of user processes </dd></dl>

<p>Reimplemented in <a class="el" href="classSystem.html#5ba9cfeccf89173d2466e9ecd0361133">System</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01076">1076</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01077"></a>01077     {
<a name="l01078"></a>01078         <span class="comment">//   PID STARTED  %CPU      TIME %MEM   RSS   VSZ STAT  PRI  NI TTY      USER     GROUP    COMMAND</span>
<a name="l01079"></a>01079         <span class="comment">//     1  5:10PM   0.0   0:00.03  0.0   388   412 Is     10   0 ??       root     wheel    /sbin/init</span>
<a name="l01080"></a>01080         <span class="comment">// Skip processes running on terminals, e.g. vi, tail, man</span>
<a name="l01081"></a>01081         <span class="comment">// Select based on daemon user</span>
<a name="l01082"></a>01082         $re= <span class="stringliteral">"/^\s*(\d+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\d+)\s+(\d+)\s+(\S+)\s+(\d+)\s+(\d+)\s+\?\?\s+($this-&gt;User)\s+(\S+)\s+(.+)$/"</span>;
<a name="l01083"></a>01083         
<a name="l01084"></a>01084         $processes= array();
<a name="l01085"></a>01085         <span class="keywordflow">foreach</span> ($psout as $line) {
<a name="l01086"></a>01086             <span class="keywordflow">if</span> (preg_match($re, $line, $match)) {
<a name="l01087"></a>01087                 <span class="comment">// Skip processes initiated by this WUI</span>
<a name="l01088"></a>01088                 <span class="keywordflow">if</span> (!preg_match('/\b(cwc\.php|grep|kill|pkill)\b/', $match[13])) {
<a name="l01089"></a>01089                     $processes[]= array(
<a name="l01090"></a>01090                         $match[1],
<a name="l01091"></a>01091                         $match[2],
<a name="l01092"></a>01092                         $match[3],
<a name="l01093"></a>01093                         $match[4],
<a name="l01094"></a>01094                         $match[5],
<a name="l01095"></a>01095                         $match[6],
<a name="l01096"></a>01096                         $match[7],
<a name="l01097"></a>01097                         $match[8],
<a name="l01098"></a>01098                         $match[9],
<a name="l01099"></a>01099                         $match[10],
<a name="l01100"></a>01100                         $match[11],
<a name="l01101"></a>01101                         $match[12],
<a name="l01102"></a>01102                         $match[13],
<a name="l01103"></a>01103                         );
<a name="l01104"></a>01104                 }
<a name="l01105"></a>01105             }
<a name="l01106"></a>01106         }
<a name="l01107"></a>01107         <span class="keywordflow">return</span> $processes;
<a name="l01108"></a>01108     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="53a0b80bb9ba660edf934fcded32e1f4"></a><!-- doxytag: member="Model::GetVersion" ref="53a0b80bb9ba660edf934fcded32e1f4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetVersion           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets software version string. 
<p>

<p>Reimplemented in <a class="el" href="classApache.html#20ac6dd9b14b011841f7725666ad8000">Apache</a>, <a class="el" href="classImspector.html#f334467018444bb88f33227f63bc4862">Imspector</a>, <a class="el" href="classP3scan.html#9c88fc144b8a0afc12e0121bacd4872f">P3scan</a>, <a class="el" href="classPmacct.html#d821a6b299611fdc7f283850c8368f6e">Pmacct</a>, <a class="el" href="classSmtpgated.html#a2d89152c27fce196980078d7d9161f2">Smtpgated</a>, <a class="el" href="classSnort.html#f03939e32dbcaf06374f0924bc4a5c2f">Snort</a>, and <a class="el" href="classSpamassassin.html#d9a7296b8ee88e0d4fa9f83a3b43307e">Spamassassin</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01112">1112</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01113"></a>01113     {
<a name="l01114"></a>01114         <span class="keywordflow">if</span> ($this-&gt;VersionCmd !== '') {
<a name="l01115"></a>01115             <span class="keywordflow">return</span>  $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($this-&gt;VersionCmd.' | /usr/bin/head -1');
<a name="l01116"></a>01116         }
<a name="l01117"></a>01117         <span class="keywordflow">return</span> FALSE;
<a name="l01118"></a>01118     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_53a0b80bb9ba660edf934fcded32e1f4_icgraph.png" border="0" usemap="#classModel_53a0b80bb9ba660edf934fcded32e1f4_icgraph_map" alt=""></center>
<map name="classModel_53a0b80bb9ba660edf934fcded32e1f4_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="195,5,301,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="647435ed6c63149c209b093518623a2e"></a><!-- doxytag: member="Model::GetServiceStatus" ref="647435ed6c63149c209b093518623a2e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetServiceStatus           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets service statuses. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01122">1122</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01123"></a>01123     {
<a name="l01124"></a>01124         global <a class="code" href="Controller_2cwc_8php.html#05492353e037e388cf7282041359336c">$MODEL_PATH</a>, <a class="code" href="Controller_2lib_8php.html#a3999bc30aa5307623a99e2f4aec8d01" title="Matches model names to files. View provides the name only.">$ModelFiles</a>, <a class="code" href="Controller_2lib_8php.html#cabe457fb176ac2d698dabd5703a1c5b" title="Matches model names to Classes. Used to create the object.">$Models</a>, <a class="code" href="defs_8php.html#0083e4f029931a1eca1a72f558d0457f" title="Models to get statuses.">$ModelsToStat</a>;
<a name="l01125"></a>01125 
<a name="l01126"></a>01126         $output= FALSE;
<a name="l01127"></a>01127         <span class="keywordflow">foreach</span> ($ModelsToStat as $m) {
<a name="l01128"></a>01128             <span class="keywordflow">if</span> (array_key_exists($m, $ModelFiles)) {
<a name="l01129"></a>01129                 require_once($MODEL_PATH.$ModelFiles[$m]);
<a name="l01130"></a>01130 
<a name="l01131"></a>01131                 <span class="keywordflow">if</span> (class_exists($Models[$m])) {
<a name="l01132"></a>01132                     $model= <span class="keyword">new</span> $Models[$m]();
<a name="l01133"></a>01133                     
<a name="l01134"></a>01134                     <span class="keywordflow">if</span> ($model-&gt;<a class="code" href="classModel.html#b72b9a2165463d9ed74e2387ad8902f0" title="Checks if the process(es) is running.">IsRunning</a>()) {
<a name="l01135"></a>01135                         $output.= <span class="stringliteral">"$m=R\n"</span>;
<a name="l01136"></a>01136                     }
<a name="l01137"></a>01137                     <span class="keywordflow">else</span> {
<a name="l01138"></a>01138                         $output.= <span class="stringliteral">"$m=S\n"</span>;
<a name="l01139"></a>01139                     }
<a name="l01140"></a>01140                 }
<a name="l01141"></a>01141                 <span class="keywordflow">else</span> {
<a name="l01142"></a>01142                     <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Not in Models: $m"</span>);
<a name="l01143"></a>01143                 }
<a name="l01144"></a>01144             }
<a name="l01145"></a>01145             <span class="keywordflow">else</span> {
<a name="l01146"></a>01146                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_NOTICE, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Not in ModelFiles: $m"</span>);
<a name="l01147"></a>01147             }
<a name="l01148"></a>01148         }
<a name="l01149"></a>01149         <span class="keywordflow">return</span> $output;
<a name="l01150"></a>01150     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_647435ed6c63149c209b093518623a2e_icgraph.png" border="0" usemap="#classModel_647435ed6c63149c209b093518623a2e_icgraph_map" alt=""></center>
<map name="classModel_647435ed6c63149c209b093518623a2e_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="237,5,344,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e6a13e22597651045ca35dc07f71564b"></a><!-- doxytag: member="Model::GetProcStatLines" ref="e6a13e22597651045ca35dc07f71564b" args="($logfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetProcStatLines           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Collects text statistics for the proc stats general page. 
<p>
Builds the shell command to count with grep first. Just counts the number of lines in the grep output. 
<p>Definition at line <a class="el" href="model_8php-source.html#l01157">1157</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01158"></a>01158     {
<a name="l01159"></a>01159         global <a class="code" href="model_8php.html#031ea101a5ccd812c9fd4e900d715215" title="Master module configuration struct.">$Modules</a>;
<a name="l01160"></a>01160 
<a name="l01161"></a>01161         <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>= array();
<a name="l01162"></a>01162         <span class="keywordflow">foreach</span> ($Modules[$this-&gt;Name]['Stats'] as $stat =&gt; $conf) {
<a name="l01163"></a>01163             <span class="keywordflow">if</span> (isset($conf['Cmd'])) {
<a name="l01164"></a>01164                 $cmd= $conf['Cmd'];
<a name="l01165"></a>01165                 <span class="keywordflow">if</span> (isset($conf['Needle'])) {
<a name="l01166"></a>01166                     $cmd.= ' | /usr/bin/grep -a -E &lt;NDL&gt;';
<a name="l01167"></a>01167                     $cmd= preg_replace('/&lt;NDL&gt;/', escapeshellarg($conf['Needle']), $cmd);
<a name="l01168"></a>01168                 }
<a name="l01169"></a>01169                 $cmd.= ' | /usr/bin/wc -l';
<a name="l01170"></a>01170             }
<a name="l01171"></a>01171             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($conf['Needle'])) {
<a name="l01172"></a>01172                 $cmd= '/usr/bin/grep -a -E &lt;NDL&gt; &lt;LF&gt; | /usr/bin/wc -l';
<a name="l01173"></a>01173                 $cmd= preg_replace('/&lt;NDL&gt;/', escapeshellarg($conf['Needle']), $cmd);
<a name="l01174"></a>01174             }
<a name="l01175"></a>01175             <span class="keywordflow">if</span> ($logfile == '') {
<a name="l01176"></a>01176                 $logfile= $this-&gt;LogFile;
<a name="l01177"></a>01177             }
<a name="l01178"></a>01178             $cmd= preg_replace('/&lt;LF&gt;/', $logfile, $cmd);
<a name="l01179"></a>01179             
<a name="l01180"></a>01180             <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>[$conf['Title']]= trim($this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>($cmd));
<a name="l01181"></a>01181         }
<a name="l01182"></a>01182         <span class="keywordflow">return</span> serialize(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>);       
<a name="l01183"></a>01183     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_e6a13e22597651045ca35dc07f71564b_icgraph.png" border="0" usemap="#classModel_e6a13e22597651045ca35dc07f71564b_icgraph_map" alt=""></center>
<map name="classModel_e6a13e22597651045ca35dc07f71564b_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="237,5,344,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="879745650e422e04795c973810fbf221"></a><!-- doxytag: member="Model::CopyLogFileToTmp" ref="879745650e422e04795c973810fbf221" args="($file, $tmpdir)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CopyLogFileToTmp           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>tmpdir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Uncompresses gzipped log file to tmp dir. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01187">1187</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01188"></a>01188     {
<a name="l01189"></a>01189         exec(<span class="stringliteral">"/bin/mkdir -p $tmpdir 2&gt;&amp;1"</span>, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01190"></a>01190         <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01191"></a>01191             exec(<span class="stringliteral">"/bin/cp $file $tmpdir 2&gt;&amp;1"</span>, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01192"></a>01192             <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01193"></a>01193                 $tmpfile= $tmpdir.basename(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01194"></a>01194                 <span class="keywordflow">if</span> (preg_match('/(.*)\.gz$/', $tmpfile, $match)) {
<a name="l01195"></a>01195                     <span class="comment">// Delete the old uncompressed file, otherwise gunzip fails</span>
<a name="l01196"></a>01196                     $this-&gt;<a class="code" href="classModel.html#d3f83a4279c60fb4246e97f7fddd8863" title="Deletes file or dir.">DeleteFile</a>($match[1]);
<a name="l01197"></a>01197                     
<a name="l01198"></a>01198                     exec(<span class="stringliteral">"/usr/bin/gunzip $tmpfile 2&gt;&amp;1"</span>, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01199"></a>01199                     <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01200"></a>01200                         <span class="keywordflow">return</span> TRUE;
<a name="l01201"></a>01201                     }
<a name="l01202"></a>01202                     <span class="keywordflow">else</span> {
<a name="l01203"></a>01203                         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, 'gunzip failed: '.$tmpdir.basename(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>));
<a name="l01204"></a>01204                     }
<a name="l01205"></a>01205                 }
<a name="l01206"></a>01206                 <span class="keywordflow">else</span> {
<a name="l01207"></a>01207                     <span class="keywordflow">return</span> TRUE;
<a name="l01208"></a>01208                 }
<a name="l01209"></a>01209             }
<a name="l01210"></a>01210             <span class="keywordflow">else</span> {
<a name="l01211"></a>01211                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, 'cp failed: '.<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01212"></a>01212             }
<a name="l01213"></a>01213         }
<a name="l01214"></a>01214         <span class="keywordflow">else</span> {
<a name="l01215"></a>01215             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_ERR, __FILE__, __FUNCTION__, __LINE__, 'mkdir failed: '.$tmpdir);
<a name="l01216"></a>01216         }
<a name="l01217"></a>01217         <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>(implode(<span class="stringliteral">"\n"</span>, $output));
<a name="l01218"></a>01218         <span class="keywordflow">return</span> FALSE;
<a name="l01219"></a>01219     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7af16fa26a00320fe042c822deebfab4"></a><!-- doxytag: member="Model::GetFileCvsTag" ref="7af16fa26a00320fe042c822deebfab4" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetFileCvsTag           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns ComixWall cvs tag in the given file, if any. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>string File pathname. </td></tr>
  </table>
</dl>

<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Don't add $ to ComixWall tag, otherwise CVS changes $re during commit </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01225">1225</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01226"></a>01226     {
<a name="l01227"></a>01227         <span class="keywordflow">if</span> (($contents= $this-&gt;<a class="code" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents.">GetFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) !== FALSE) {
<a name="l01229"></a>01229             $re= '/ComixWall:\s+(.*\.php,v\s+\d+\.\d+\s+\d+\/\d+\/\d+\s+\d+:\d+:\d+)\s+\S+\s+Exp\s+\$/';
<a name="l01230"></a>01230             <span class="keywordflow">if</span> (preg_match($re, $contents, $match)) {
<a name="l01231"></a>01231                 <span class="keywordflow">return</span> $match[1];
<a name="l01232"></a>01232             }
<a name="l01233"></a>01233         }
<a name="l01234"></a>01234         <span class="keywordflow">return</span> FALSE;
<a name="l01235"></a>01235     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_7af16fa26a00320fe042c822deebfab4_icgraph.png" border="0" usemap="#classModel_7af16fa26a00320fe042c822deebfab4_icgraph_map" alt=""></center>
<map name="classModel_7af16fa26a00320fe042c822deebfab4_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="213,5,320,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0ae50b6dbbd53cc2db879f2aad4a6bb3"></a><!-- doxytag: member="Model::GetSysCtl" ref="0ae50b6dbbd53cc2db879f2aad4a6bb3" args="($option)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetSysCtl           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>option</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets sysctl output for the given arg. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$option</em>&nbsp;</td><td>sysctl arg, such as hw.sensors. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>sysctl output lines. </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01242">1242</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>, and <a class="el" href="symon_8php-source.html#l00091">Symon::SetCpus()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01243"></a>01243     {
<a name="l01244"></a>01244         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"/sbin/sysctl $option"</span>);
<a name="l01245"></a>01245     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_0ae50b6dbbd53cc2db879f2aad4a6bb3_icgraph.png" border="0" usemap="#classModel_0ae50b6dbbd53cc2db879f2aad4a6bb3_icgraph_map" alt=""></center>
<map name="classModel_0ae50b6dbbd53cc2db879f2aad4a6bb3_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="203,5,309,32"><area shape="rect" href="classSymon.html#137b0807afc7a48b6997dd2584cc6b2b" title="Symon::SetCpus" alt="" coords="191,56,321,83"><area shape="rect" href="classSymon.html#13e2df64712f14505a14cd01d7d9d0d9" title="Symon::Symon" alt="" coords="371,56,493,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="79a6802745276910632fee29f9585495"></a><!-- doxytag: member="Model::GetFile" ref="79a6802745276910632fee29f9585495" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads file contents. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>File contents </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01252">1252</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="imspector_8php-source.html#l00121">Imspector::GetBadwords()</a>, <a class="el" href="system_8php-source.html#l00402">System::GetIfConfig()</a>, <a class="el" href="snortips_8php-source.html#l00134">Snortips::GetInfo()</a>, <a class="el" href="system_8php-source.html#l00379">System::GetMyName()</a>, <a class="el" href="model_8php-source.html#l01614">GetSavedStats()</a>, <a class="el" href="system_8php-source.html#l00370">System::GetStaticGateway()</a>, and <a class="el" href="pmacct_8php-source.html#l00076">Pmacct::Start()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01253"></a>01253     {
<a name="l01254"></a>01254         <span class="keywordflow">if</span> (file_exists(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l01255"></a>01255             <span class="keywordflow">return</span> file_get_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01256"></a>01256         }
<a name="l01257"></a>01257         <span class="keywordflow">return</span> FALSE;
<a name="l01258"></a>01258     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_79a6802745276910632fee29f9585495_icgraph.png" border="0" usemap="#classModel_79a6802745276910632fee29f9585495_icgraph_map" alt=""></center>
<map name="classModel_79a6802745276910632fee29f9585495_icgraph_map">
<area shape="rect" href="classImspector.html#c664c9de3146d555dd246704dbbdd125" title="Imspector::GetBadwords" alt="" coords="177,31,359,57"><area shape="rect" href="classSystem.html#d97ce4436a87b24f0704eb6453963a8f" title="System::GetIfConfig" alt="" coords="191,208,345,235"><area shape="rect" href="classSnortips.html#ca6dd5c39a222c982d55a9786b4068c1" title="Snortips::GetInfo" alt="" coords="203,259,333,285"><area shape="rect" href="classSystem.html#b3e47a6e476aeb2c7ab65d1396aa9956" title="Reads hostname." alt="" coords="187,107,349,133"><area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="184,360,352,387"><area shape="rect" href="classSystem.html#a3dfbc82601ff46ec77ed546f093e23a" title="Reads gateway address." alt="" coords="168,157,368,184"><area shape="rect" href="classPmacct.html#fef0c6ec06230e6e0a2ee6b7454b01b0" title="Start module process(es)." alt="" coords="212,411,324,437"><area shape="rect" href="classImspector.html#da969b4f04feb17cc45173029137042b" title="Imspector::Imspector" alt="" coords="445,5,605,32"><area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="452,157,599,184"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="683,132,813,159"><area shape="rect" href="classSnortips.html#167a35c683c8aaaf244b488ead4e3a3d" title="Displays a list of blocked, blacklisted, or whitelisted IPs." alt="" coords="417,259,633,285"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="457,309,593,336"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="861,461,1003,488"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="685,411,811,437"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="451,411,600,437"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1051,436,1157,463"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7b4dfa63dc1823462b18efadd16b88b6"></a><!-- doxytag: member="Model::GetDefaultLogFile" ref="7b4dfa63dc1823462b18efadd16b88b6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetDefaultLogFile           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01260">1260</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01261"></a>01261     {
<a name="l01262"></a>01262         <span class="keywordflow">return</span> $this-&gt;LogFile;
<a name="l01263"></a>01263     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_7b4dfa63dc1823462b18efadd16b88b6_icgraph.png" border="0" usemap="#classModel_7b4dfa63dc1823462b18efadd16b88b6_icgraph_map" alt=""></center>
<map name="classModel_7b4dfa63dc1823462b18efadd16b88b6_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="240,5,347,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3ff7381593aee6c57361809ac2a15228"></a><!-- doxytag: member="Model::SelectLogFile" ref="3ff7381593aee6c57361809ac2a15228" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SelectLogFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns log file under tmp location. 
<p>
Updates the tmp file if original file is modified. Updates the stat info of the file in the tmp statistics file, used to check file modificaton.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Original file name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>File pathname </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01274">1274</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01275"></a>01275     {
<a name="l01276"></a>01276         <span class="keywordflow">if</span> (<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a> === '') {
<a name="l01277"></a>01277             <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;LogFile;
<a name="l01278"></a>01278         }
<a name="l01279"></a>01279         
<a name="l01280"></a>01280         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;<a class="code" href="classModel.html#29102c6076b42c9519b995bc28aa979d" title="Returns the log file name in the tmp location.">GetTmpLogFileName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01281"></a>01281         
<a name="l01282"></a>01282         <span class="keywordflow">if</span> (!file_exists(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>) || $this-&gt;<a class="code" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated.">IsLogFileModified</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l01283"></a>01283             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758" title="Copies original log file to tmp location.">UpdateTmpLogFile</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l01284"></a>01284                 <span class="comment">// Update stats to update file stat info only</span>
<a name="l01285"></a>01285                 $this-&gt;<a class="code" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full.">UpdateStats</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>, $briefstats);
<a name="l01286"></a>01286             }
<a name="l01287"></a>01287             <span class="keywordflow">else</span> {
<a name="l01288"></a>01288                 <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;LogFile;
<a name="l01289"></a>01289                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Logfile tmp copy update failed, defaulting to: $file"</span>);
<a name="l01290"></a>01290             }
<a name="l01291"></a>01291         }
<a name="l01292"></a>01292         
<a name="l01293"></a>01293         <span class="keywordflow">return</span> <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>;
<a name="l01294"></a>01294     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_3ff7381593aee6c57361809ac2a15228_icgraph.png" border="0" usemap="#classModel_3ff7381593aee6c57361809ac2a15228_icgraph_map" alt=""></center>
<map name="classModel_3ff7381593aee6c57361809ac2a15228_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="208,5,315,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="ad5ea6ecfd799e86a4bf8d951f377758"></a><!-- doxytag: member="Model::UpdateTmpLogFile" ref="ad5ea6ecfd799e86a4bf8d951f377758" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::UpdateTmpLogFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copies original log file to tmp location. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>File pathname </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01300">1300</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01301"></a>01301     {
<a name="l01302"></a>01302         $origfile= $this-&gt;<a class="code" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file.">GetOrigFileName</a>(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01303"></a>01303         
<a name="l01304"></a>01304         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#879745650e422e04795c973810fbf221" title="Uncompresses gzipped log file to tmp dir.">CopyLogFileToTmp</a>($origfile, $this-&gt;TmpLogsDir)) {
<a name="l01305"></a>01305             <span class="keywordflow">return</span> TRUE;
<a name="l01306"></a>01306         }
<a name="l01307"></a>01307         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Copy failed: $file"</span>);
<a name="l01308"></a>01308         <span class="keywordflow">return</span> FALSE;
<a name="l01309"></a>01309     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_ad5ea6ecfd799e86a4bf8d951f377758_icgraph.png" border="0" usemap="#classModel_ad5ea6ecfd799e86a4bf8d951f377758_icgraph_map" alt=""></center>
<map name="classModel_ad5ea6ecfd799e86a4bf8d951f377758_icgraph_map">
<area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="244,31,369,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="419,5,560,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="608,31,715,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="29102c6076b42c9519b995bc28aa979d"></a><!-- doxytag: member="Model::GetTmpLogFileName" ref="29102c6076b42c9519b995bc28aa979d" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetTmpLogFileName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the log file name in the tmp location. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>File pathname </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01315">1315</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01316"></a>01316     {
<a name="l01317"></a>01317         <span class="keywordflow">if</span> (preg_match('/(.*)\.gz$/', <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $match)) {
<a name="l01318"></a>01318             <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;TmpLogsDir.basename($match[1]);
<a name="l01319"></a>01319         }
<a name="l01320"></a>01320         <span class="keywordflow">else</span> {
<a name="l01321"></a>01321             <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;TmpLogsDir.basename(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l01322"></a>01322         }
<a name="l01323"></a>01323         <span class="keywordflow">return</span> <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>;
<a name="l01324"></a>01324     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d45004479b64ebb94297aa6b27ede5a8"></a><!-- doxytag: member="Model::GetLogFilesList" ref="d45004479b64ebb94297aa6b27ede5a8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetLogFilesList           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets log files list with start dates. 
<p>
Searches the logs directory for all possible archives according to the default file name. 
<p>Definition at line <a class="el" href="model_8php-source.html#l01331">1331</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01332"></a>01332     {
<a name="l01333"></a>01333         <a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>= $this-&gt;LogFile;
<a name="l01334"></a>01334         $filelist= explode(<span class="stringliteral">"\n"</span>, $this-&gt;<a class="code" href="classModel.html#55b3f40ec612727a645a77896163f1d9" title="Returns files with the given filepath pattern.">GetFiles</a>(<span class="stringliteral">"$file*"</span>));
<a name="l01335"></a>01335         asort($filelist);
<a name="l01336"></a>01336 
<a name="l01337"></a>01337         <a class="code" href="pfhostsedit_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>= array();
<a name="l01338"></a>01338         <span class="keywordflow">foreach</span> ($filelist as $filepath) {
<a name="l01339"></a>01339             <a class="code" href="pfhostsedit_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>[$filepath]= $this-&gt;<a class="code" href="classModel.html#66be6edcbd364e21485e03144cfa2a46" title="Extracts the datetime of the first line in the log file.">GetLogStartDate</a>($filepath);
<a name="l01340"></a>01340         }
<a name="l01341"></a>01341         <span class="keywordflow">return</span> serialize(<a class="code" href="pfhostsedit_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l01342"></a>01342     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d45004479b64ebb94297aa6b27ede5a8_icgraph.png" border="0" usemap="#classModel_d45004479b64ebb94297aa6b27ede5a8_icgraph_map" alt=""></center>
<map name="classModel_d45004479b64ebb94297aa6b27ede5a8_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="221,5,328,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="d3f83a4279c60fb4246e97f7fddd8863"></a><!-- doxytag: member="Model::DeleteFile" ref="d3f83a4279c60fb4246e97f7fddd8863" args="($path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::DeleteFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>path</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Deletes file or dir. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$path</em>&nbsp;</td><td>string File or dir. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01348">1348</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="openvpn_8php-source.html#l00199">Openvpn::DeleteConf()</a>, <a class="el" href="system_8php-source.html#l00545">System::DeleteIf()</a>, and <a class="el" href="system_8php-source.html#l00489">System::SystemMakeDynamicGateway()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01349"></a>01349     {
<a name="l01350"></a>01350         <span class="keywordflow">if</span> (file_exists($path)) {
<a name="l01351"></a>01351             exec(<span class="stringliteral">"/bin/rm -rf $path 2&gt;&amp;1"</span>, $output, <a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a>);
<a name="l01352"></a>01352             <span class="keywordflow">if</span> (<a class="code" href="Controller_2cwc_8php.html#d78265bb473309fdfd2bc017c8cffe81">$retval</a> === 0) {
<a name="l01353"></a>01353                 <span class="keywordflow">return</span> TRUE;
<a name="l01354"></a>01354             }
<a name="l01355"></a>01355             <span class="keywordflow">else</span> {
<a name="l01356"></a>01356                 $errout= implode(<span class="stringliteral">"\n"</span>, $output);
<a name="l01357"></a>01357                 <a class="code" href="lib_2lib_8php.html#bdb713d167f78cb17af6cbe7d651270b" title="Sets or updates $ViewError with the given message.">ViewError</a>($errout);
<a name="l01358"></a>01358                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Failed deleting: $path, $errout"</span>);
<a name="l01359"></a>01359             }
<a name="l01360"></a>01360         }
<a name="l01361"></a>01361         <span class="keywordflow">else</span> {
<a name="l01362"></a>01362             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"File path does not exist: $path"</span>);
<a name="l01363"></a>01363         }
<a name="l01364"></a>01364         <span class="keywordflow">return</span> FALSE;
<a name="l01365"></a>01365     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d3f83a4279c60fb4246e97f7fddd8863_icgraph.png" border="0" usemap="#classModel_d3f83a4279c60fb4246e97f7fddd8863_icgraph_map" alt=""></center>
<map name="classModel_d3f83a4279c60fb4246e97f7fddd8863_icgraph_map">
<area shape="rect" href="classOpenvpn.html#28ee124808072337358748affd7b54f3" title="Openvpn::DeleteConf" alt="" coords="247,5,409,32"><area shape="rect" href="classSystem.html#83f514e3b7ff47e3a1f2922c4e128958" title="Unconfigures interface by deleting its hostname file." alt="" coords="263,56,393,83"><area shape="rect" href="classSystem.html#28ee144a21fb88eae0d985928108779d" title="System::SystemMakeDynamicGateway" alt="" coords="188,107,468,133"><area shape="rect" href="classOpenvpn.html#81795c04e91b274e39a5572d7ceae3e2" title="Openvpn::Openvpn" alt="" coords="517,5,664,32"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="525,81,656,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="cdf121f58a23152dcc4071dfe70db060"></a><!-- doxytag: member="Model::PutFile" ref="cdf121f58a23152dcc4071dfe70db060" args="($file, $contents)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::PutFile           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>contents</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Writes contents to file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$file</em>&nbsp;</td><td>Config file. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$contents</em>&nbsp;</td><td>Contents to write. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01372">1372</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snortips_8php-source.html#l00134">Snortips::GetInfo()</a>, <a class="el" href="pf_8php-source.html#l00567">Pf::InstallNewCrontab()</a>, and <a class="el" href="model_8php-source.html#l01736">SaveStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01373"></a>01373     {
<a name="l01374"></a>01374         <span class="keywordflow">if</span> (file_exists(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l01375"></a>01375             <span class="keywordflow">return</span> file_put_contents(<a class="code" href="stats_8daily_8php.html#a1bfbd27060176201b271918dff57e8f">$file</a>, $contents, LOCK_EX);
<a name="l01376"></a>01376         }
<a name="l01377"></a>01377         <span class="keywordflow">return</span> FALSE;
<a name="l01378"></a>01378     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_cdf121f58a23152dcc4071dfe70db060_icgraph.png" border="0" usemap="#classModel_cdf121f58a23152dcc4071dfe70db060_icgraph_map" alt=""></center>
<map name="classModel_cdf121f58a23152dcc4071dfe70db060_icgraph_map">
<area shape="rect" href="classSnortips.html#ca6dd5c39a222c982d55a9786b4068c1" title="Snortips::GetInfo" alt="" coords="183,56,313,83"><area shape="rect" href="classPf.html#3314c0e3c0573360b80d202a4e2e0b85" title="Installs given crontab contents." alt="" coords="167,157,329,184"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="180,245,316,272"><area shape="rect" href="classSnortips.html#167a35c683c8aaaf244b488ead4e3a3d" title="Displays a list of blocked, blacklisted, or whitelisted IPs." alt="" coords="383,5,599,32"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="423,56,559,83"><area shape="rect" href="classPf.html#c048f2726f7124db2486eb66261a1163" title="Sets after hours definitions in cron file." alt="" coords="701,56,853,83"><area shape="rect" href="classPf.html#070c916751f36cda0be837f272a3e6a2" title="Comments the line that matches the give regexp." alt="" coords="387,157,595,184"><area shape="rect" href="classPf.html#7d99d022de9721a8a2f3a6e748d3ce45" title="Uncomments the line that matches the give regexp." alt="" coords="379,208,603,235"><area shape="rect" href="classPf.html#c94a5dee2c0a4692a17635d25ecbd2db" title="Pf::Pf" alt="" coords="993,157,1052,184"><area shape="rect" href="classPf.html#3c603a557058a778d1f48e94b2157a22" title="Pf::DisableAfterHoursBusinessDays" alt="" coords="652,107,903,133"><area shape="rect" href="classPf.html#1c833d0efe6be110e287ea9222c48633" title="Pf::DisableAfterHoursHolidays" alt="" coords="669,157,885,184"><area shape="rect" href="classPf.html#26a036b05364f646da7903e3d357c334" title="Pf::EnableAfterHoursBusinessDays" alt="" coords="653,208,901,235"><area shape="rect" href="classPf.html#dfcd83f7631a4e74fa36a5c506f2f4f3" title="Pf::EnableAfterHoursHolidays" alt="" coords="671,259,884,285"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="416,284,565,311"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="715,309,840,336"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="952,284,1093,311"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1141,309,1248,336"></map>
</div>

</div>
</div><p>
<a class="anchor" name="26a9043009ddbda075cf8e890dbd28d9"></a><!-- doxytag: member="Model::GetPhyIfs" ref="26a9043009ddbda075cf8e890dbd28d9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetPhyIfs           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract physical interface names from ifconfig output. 
<p>
Removes non-physical interfaces from the output <dl class="return" compact><dt><b>Returns:</b></dt><dd>Names of physical interfaces. </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01385">1385</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="snortips_8php-source.html#l00192">Snortips::DelIPFromList()</a>, <a class="el" href="system_8php-source.html#l00441">System::GetConfig()</a>, and <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01386"></a>01386     {
<a name="l01387"></a>01387         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"/sbin/ifconfig -a | /usr/bin/grep ': flags=' | /usr/bin/sed 's/: flags=.*//g' | /usr/bin/grep -v -e lo -e pflog -e pfsync -e enc -e tun"</span>);
<a name="l01388"></a>01388     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_26a9043009ddbda075cf8e890dbd28d9_icgraph.png" border="0" usemap="#classModel_26a9043009ddbda075cf8e890dbd28d9_icgraph_map" alt=""></center>
<map name="classModel_26a9043009ddbda075cf8e890dbd28d9_icgraph_map">
<area shape="rect" href="classSnortips.html#47f7c429e6b97de09357ee361ea13bfc" title="Deletes a list of IPs from a list." alt="" coords="188,5,361,32"><area shape="rect" href="classSystem.html#7522fb69a5b43f9536c94a7a0e952dd7" title="System::GetConfig" alt="" coords="201,56,348,83"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="221,107,328,133"><area shape="rect" href="classSnortips.html#1f1eb35f976124f24754d74193dd1c44" title="Snortips::Snortips" alt="" coords="411,5,547,32"><area shape="rect" href="classSystem.html#e317936c9bcf1374d61745572e0f2f8a" title="System::System" alt="" coords="413,56,544,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a2edac23e52476f8e5c70d9893bc1fcb"></a><!-- doxytag: member="Model::GetAllStats" ref="a2edac23e52476f8e5c70d9893bc1fcb" args="($logfile, $collecthours= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetAllStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>collecthours</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns both brief and full statistics. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$collecthours</em>&nbsp;</td><td>boolean Flag to get hour statistics also </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>serialized Statistics in serialized arrays </dd></dl>

<p>
<dl class="attention" compact><dt><b>Attention:</b></dt><dd>We need $stats return value of <a class="el" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set.">GetStats()</a> because of $collecthours constraint </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01396">1396</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="model_8php-source.html#l01614">GetSavedStats()</a>, and <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01397"></a>01397     {
<a name="l01398"></a>01398         $date= serialize(array('Month' =&gt; '', 'Day' =&gt; ''));
<a name="l01400"></a>01400         <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>= $this-&gt;<a class="code" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set.">GetStats</a>($logfile, $date, $collecthours);
<a name="l01401"></a>01401         
<a name="l01402"></a>01402         <span class="comment">// Do not get $stats here, just $briefstats</span>
<a name="l01403"></a>01403         $this-&gt;<a class="code" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file.">GetSavedStats</a>($logfile, $dummy, $briefstats);
<a name="l01404"></a>01404         $briefstats= serialize($briefstats);
<a name="l01405"></a>01405         
<a name="l01406"></a>01406         <span class="comment">// Use serialized stats as array elements to prevent otherwise extra unserialize() for $stats,</span>
<a name="l01407"></a>01407         <span class="comment">// which is already serialized by GetStat() above.</span>
<a name="l01408"></a>01408         <span class="comment">// They are ordinary strings now, this serialize() should be quite fast</span>
<a name="l01409"></a>01409         <span class="keywordflow">return</span> serialize(
<a name="l01410"></a>01410                 array(
<a name="l01411"></a>01411                     'stats'     =&gt; <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>,
<a name="l01412"></a>01412                     'briefstats'=&gt; $briefstats,
<a name="l01413"></a>01413                     )
<a name="l01414"></a>01414             );
<a name="l01415"></a>01415     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_a2edac23e52476f8e5c70d9893bc1fcb_cgraph.png" border="0" usemap="#classModel_a2edac23e52476f8e5c70d9893bc1fcb_cgraph_map" alt=""></center>
<map name="classModel_a2edac23e52476f8e5c70d9893bc1fcb_cgraph_map">
<area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="619,496,787,523"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="196,445,321,472"><area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="1127,268,1217,295"><area shape="rect" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents." alt="" coords="880,572,992,599"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="1079,167,1265,193"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="1319,116,1497,143"><area shape="rect" href="classModel.html#96cdbca1cb750f08af734720ce035527" title="Generates date regexp to be used by statistics functions." alt="" coords="379,445,552,472"><area shape="rect" href="classModel.html#06a223ba294ce4dedc681900919c35b5" title="Generates hour regexp to be used by statistics functions." alt="" coords="379,496,552,523"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="613,123,792,149"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="391,344,540,371"><area shape="rect" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758" title="Copies original log file to tmp location." alt="" coords="371,547,560,573"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="849,116,1023,143"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="1076,217,1268,244"><area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="616,648,789,675"><area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="608,319,797,345"><area shape="rect" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file." alt="" coords="847,369,1025,396"><area shape="rect" href="classModel.html#2b5091c9fb872dccd476b2147d163e0d" title="Builds generic grep command to extract log lines." alt="" coords="611,261,795,288"><area shape="rect" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser." alt="" coords="625,420,780,447"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="868,65,1004,92"><area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="847,673,1025,700"><area shape="rect" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values." alt="" coords="1112,724,1232,751"><area shape="rect" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector." alt="" coords="1077,673,1267,700"><area shape="rect" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line." alt="" coords="849,420,1023,447"><area shape="rect" href="classModel.html#cdf121f58a23152dcc4071dfe70db060" title="Writes contents to file." alt="" coords="1116,116,1228,143"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_a2edac23e52476f8e5c70d9893bc1fcb_icgraph.png" border="0" usemap="#classModel_a2edac23e52476f8e5c70d9893bc1fcb_icgraph_map" alt=""></center>
<map name="classModel_a2edac23e52476f8e5c70d9893bc1fcb_icgraph_map">
<area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="195,5,301,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="ffd6bba4698ad739939497598cadde66"></a><!-- doxytag: member="Model::GetStats" ref="ffd6bba4698ad739939497598cadde66" args="($logfile, $date, $collecthours= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>collecthours</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Main statistics collector, as module data set. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$date</em>&nbsp;</td><td>array Datetime struct </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$collecthours</em>&nbsp;</td><td>boolean Flag to collect hour statistics also </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>array Statistics data set collected, serialized </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01424">1424</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l02201">$Modules</a>, <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="model_8php-source.html#l01573">GetDateRegexp()</a>, <a class="el" href="model_8php-source.html#l01597">GetHourRegexp()</a>, <a class="el" href="model_8php-source.html#l01614">GetSavedStats()</a>, <a class="el" href="model_8php-source.html#l01643">IsLogFileModified()</a>, <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>, and <a class="el" href="model_8php-source.html#l01300">UpdateTmpLogFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01396">GetAllStats()</a>, and <a class="el" href="model_8php-source.html#l00089">Model()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01425"></a>01425     {
<a name="l01426"></a>01426         global <a class="code" href="model_8php.html#031ea101a5ccd812c9fd4e900d715215" title="Master module configuration struct.">$Modules</a>;
<a name="l01427"></a>01427         
<a name="l01428"></a>01428         $date= unserialize($date);
<a name="l01429"></a>01429 
<a name="l01430"></a>01430         <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>= array();
<a name="l01431"></a>01431         $briefstats= array();
<a name="l01432"></a>01432         $uptodate= FALSE;
<a name="l01433"></a>01433         
<a name="l01434"></a>01434         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated.">IsLogFileModified</a>($logfile)) {
<a name="l01435"></a>01435             $this-&gt;<a class="code" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758" title="Copies original log file to tmp location.">UpdateTmpLogFile</a>($logfile);
<a name="l01436"></a>01436         }
<a name="l01437"></a>01437         <span class="keywordflow">else</span> {
<a name="l01438"></a>01438             $uptodate= $this-&gt;<a class="code" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file.">GetSavedStats</a>($logfile, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>, $briefstats);
<a name="l01439"></a>01439         }
<a name="l01440"></a>01440             
<a name="l01441"></a>01441         <span class="keywordflow">if</span> (!$uptodate) {
<a name="l01442"></a>01442             $this-&gt;<a class="code" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full.">UpdateStats</a>($logfile, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>, $briefstats);
<a name="l01443"></a>01443         }
<a name="l01444"></a>01444                 
<a name="l01445"></a>01445         <span class="keywordflow">if</span> (isset(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'])) {
<a name="l01446"></a>01446             <span class="keywordflow">if</span> ($collecthours === '') {
<a name="l01447"></a>01447                 <span class="keywordflow">foreach</span> (<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'] as $day =&gt; $daystats) {
<a name="l01448"></a>01448                     unset(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'][$day]['Hours']);
<a name="l01449"></a>01449                 }
<a name="l01450"></a>01450             }
<a name="l01451"></a>01451 
<a name="l01452"></a>01452             $re= $this-&gt;<a class="code" href="classModel.html#96cdbca1cb750f08af734720ce035527" title="Generates date regexp to be used by statistics functions.">GetDateRegexp</a>($date);
<a name="l01453"></a>01453             <span class="keywordflow">foreach</span> (<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'] as $day =&gt; $daystats) {
<a name="l01454"></a>01454                 <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">"/$re/"</span>, $day)) {
<a name="l01455"></a>01455                     unset(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'][$day]);
<a name="l01456"></a>01456                 }
<a name="l01457"></a>01457             }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459             $re= $this-&gt;<a class="code" href="classModel.html#06a223ba294ce4dedc681900919c35b5" title="Generates hour regexp to be used by statistics functions.">GetHourRegexp</a>($date);
<a name="l01460"></a>01460             <span class="keywordflow">foreach</span> (<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'] as $day =&gt; $daystats) {
<a name="l01461"></a>01461                 <span class="keywordflow">if</span> (isset($daystats['Hours'])) {
<a name="l01462"></a>01462                     <span class="keywordflow">foreach</span> ($daystats['Hours'] as $hour =&gt; $hourstats) {
<a name="l01463"></a>01463                         <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">"/$re/"</span>, $hour)) {
<a name="l01464"></a>01464                             unset(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'][$day]['Hours'][$hour]);
<a name="l01465"></a>01465                         }
<a name="l01466"></a>01466                     }
<a name="l01467"></a>01467                 }
<a name="l01468"></a>01468             }
<a name="l01469"></a>01469         }
<a name="l01470"></a>01470         <span class="keywordflow">return</span> serialize(<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>);
<a name="l01471"></a>01471     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_ffd6bba4698ad739939497598cadde66_cgraph.png" border="0" usemap="#classModel_ffd6bba4698ad739939497598cadde66_cgraph_map" alt=""></center>
<map name="classModel_ffd6bba4698ad739939497598cadde66_cgraph_map">
<area shape="rect" href="classModel.html#96cdbca1cb750f08af734720ce035527" title="Generates date regexp to be used by statistics functions." alt="" coords="189,45,363,72"><area shape="rect" href="classModel.html#06a223ba294ce4dedc681900919c35b5" title="Generates hour regexp to be used by statistics functions." alt="" coords="189,96,363,123"><area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="429,133,597,160"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="424,57,603,84"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="201,324,351,351"><area shape="rect" href="classModel.html#ad5ea6ecfd799e86a4bf8d951f377758" title="Copies original log file to tmp location." alt="" coords="181,375,371,401"><area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="937,133,1028,160"><area shape="rect" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents." alt="" coords="691,83,803,109"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="889,83,1076,109"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="1129,159,1308,185"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="660,184,833,211"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="887,184,1079,211"><area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="427,513,600,540"><area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="419,324,608,351"><area shape="rect" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file." alt="" coords="657,387,836,413"><area shape="rect" href="classModel.html#2b5091c9fb872dccd476b2147d163e0d" title="Builds generic grep command to extract log lines." alt="" coords="421,431,605,457"><area shape="rect" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser." alt="" coords="436,603,591,629"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="679,235,815,261"><area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="657,589,836,616"><area shape="rect" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values." alt="" coords="923,539,1043,565"><area shape="rect" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector." alt="" coords="888,589,1077,616"><area shape="rect" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line." alt="" coords="660,640,833,667"><area shape="rect" href="classModel.html#cdf121f58a23152dcc4071dfe70db060" title="Writes contents to file." alt="" coords="927,285,1039,312"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_ffd6bba4698ad739939497598cadde66_icgraph.png" border="0" usemap="#classModel_ffd6bba4698ad739939497598cadde66_icgraph_map" alt=""></center>
<map name="classModel_ffd6bba4698ad739939497598cadde66_icgraph_map">
<area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="181,5,323,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="371,31,477,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e87cab614cb0dda5a48a0483ad20bb13"></a><!-- doxytag: member="Model::CountDiffLogLines" ref="e87cab614cb0dda5a48a0483ad20bb13" args="($logfile, &amp;$count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CountDiffLogLines           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the number of lines added to log files since last tmp update. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$count</em>&nbsp;</td><td>int Number of new log lines </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01478">1478</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l00784">GetFileLineCount()</a>, <a class="el" href="model_8php-source.html#l01714">GetOrigFileName()</a>, and <a class="el" href="model_8php-source.html#l01669">GetStatsFileInfo()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01479"></a>01479     {
<a name="l01480"></a>01480         $count= -1;
<a name="l01481"></a>01481             
<a name="l01482"></a>01482         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file.">GetStatsFileInfo</a>($logfile, $oldlinecount, $oldfilestat)) {
<a name="l01483"></a>01483             
<a name="l01484"></a>01484             $newlinecount= $this-&gt;<a class="code" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file.">GetFileLineCount</a>($logfile);
<a name="l01485"></a>01485             $origfile= $this-&gt;<a class="code" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file.">GetOrigFileName</a>($logfile);
<a name="l01486"></a>01486 
<a name="l01487"></a>01487             <span class="keywordflow">if</span> (($newlinecount &gt;= $oldlinecount) &amp;&amp; !preg_match('/\.gz$/', $origfile)) {
<a name="l01488"></a>01488                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Logfile modified: $logfile, linecount $oldlinecount-&gt;$newlinecount"</span>);
<a name="l01489"></a>01489 
<a name="l01490"></a>01490                 $count= $newlinecount - $oldlinecount;
<a name="l01491"></a>01491                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Logfile has grown by $count lines: $logfile"</span>);
<a name="l01492"></a>01492                 <span class="keywordflow">return</span> TRUE;
<a name="l01493"></a>01493             }
<a name="l01494"></a>01494             <span class="keywordflow">else</span> {
<a name="l01495"></a>01495                 <span class="comment">// Logs probably rotated, recollect the stats</span>
<a name="l01496"></a>01496                 <span class="comment">// Also stats for compressed files are always recollected on rotation, otherwise stats would be merged with the old stats</span>
<a name="l01497"></a>01497                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Assuming log file rotation: $logfile"</span>);
<a name="l01498"></a>01498             }
<a name="l01499"></a>01499         }
<a name="l01500"></a>01500         <span class="keywordflow">else</span> {
<a name="l01501"></a>01501             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Cannot get file info: $logfile"</span>);
<a name="l01502"></a>01502         }
<a name="l01503"></a>01503 
<a name="l01504"></a>01504         <span class="keywordflow">return</span> FALSE;
<a name="l01505"></a>01505     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_e87cab614cb0dda5a48a0483ad20bb13_cgraph.png" border="0" usemap="#classModel_e87cab614cb0dda5a48a0483ad20bb13_cgraph_map" alt=""></center>
<map name="classModel_e87cab614cb0dda5a48a0483ad20bb13_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="524,97,615,124"><area shape="rect" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file." alt="" coords="244,47,423,73"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="716,72,895,99"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="247,148,420,175"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="476,148,663,175"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="473,199,665,225"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_e87cab614cb0dda5a48a0483ad20bb13_icgraph.png" border="0" usemap="#classModel_e87cab614cb0dda5a48a0483ad20bb13_icgraph_map" alt=""></center>
<map name="classModel_e87cab614cb0dda5a48a0483ad20bb13_icgraph_map">
<area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="244,31,393,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="444,31,569,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="619,5,760,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="808,31,915,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2de95faa4fc211f54fcc882609ca4d7f"></a><!-- doxytag: member="Model::UpdateStats" ref="2de95faa4fc211f54fcc882609ca4d7f" args="($logfile, &amp;$stats, &amp;$briefstats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::UpdateStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>briefstats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates statistics incrementally, both brief and full. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file pathname </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$stats</em>&nbsp;</td><td>array Full stats </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$briefstats</em>&nbsp;</td><td>array Brief stats </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01513">1513</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l02201">$Modules</a>, <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="model_8php-source.html#l01781">CollectDayStats()</a>, <a class="el" href="model_8php-source.html#l01478">CountDiffLogLines()</a>, <a class="el" href="model_8php-source.html#l00784">GetFileLineCount()</a>, <a class="el" href="model_8php-source.html#l01614">GetSavedStats()</a>, <a class="el" href="model_8php-source.html#l00308">GetStatsLogLines()</a>, <a class="el" href="model_8php-source.html#l01898">ParseLogLine()</a>, and <a class="el" href="model_8php-source.html#l01736">SaveStats()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01514"></a>01514     {
<a name="l01515"></a>01515         global <a class="code" href="model_8php.html#031ea101a5ccd812c9fd4e900d715215" title="Master module configuration struct.">$Modules</a>;
<a name="l01516"></a>01516 
<a name="l01517"></a>01517         <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>= array();
<a name="l01518"></a>01518         $briefstats= array();
<a name="l01519"></a>01519 
<a name="l01520"></a>01520         <span class="comment">// Line count should be obtained here, see SaveStats() for explanation</span>
<a name="l01521"></a>01521         $linecount= $this-&gt;<a class="code" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file.">GetFileLineCount</a>($logfile);
<a name="l01522"></a>01522 
<a name="l01523"></a>01523         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update.">CountDiffLogLines</a>($logfile, $tail)) {
<a name="l01524"></a>01524             $this-&gt;<a class="code" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file.">GetSavedStats</a>($logfile, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>, $briefstats);
<a name="l01525"></a>01525         }
<a name="l01526"></a>01526         
<a name="l01527"></a>01527         $statsdefs= $Modules[$this-&gt;Name]['Stats'];
<a name="l01528"></a>01528         
<a name="l01529"></a>01529         <span class="keywordflow">if</span> (isset($statsdefs)) {
<a name="l01530"></a>01530             $lines= $this-&gt;<a class="code" href="classModel.html#2b5091c9fb872dccd476b2147d163e0d" title="Builds generic grep command to extract log lines.">GetStatsLogLines</a>($logfile, $tail);
<a name="l01531"></a>01531             
<a name="l01532"></a>01532             <span class="keywordflow">if</span> ($lines !== '') {
<a name="l01533"></a>01533                 $lines= explode(<span class="stringliteral">"\n"</span>, $lines);
<a name="l01534"></a>01534 
<a name="l01535"></a>01535                 <span class="keywordflow">foreach</span> ($lines as $line) {
<a name="l01536"></a>01536                     unset($values);
<a name="l01537"></a>01537                     $this-&gt;<a class="code" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser.">ParseLogLine</a>($line, $values);
<a name="l01538"></a>01538                     <span class="comment">// Post-processing modifies link and/or datetime values.</span>
<a name="l01539"></a>01539                     $this-&gt;PostProcessCols($values);
<a name="l01540"></a>01540 
<a name="l01541"></a>01541                     $this-&gt;<a class="code" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector.">CollectDayStats</a>($statsdefs, $values, $line, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>);
<a name="l01542"></a>01542                 
<a name="l01543"></a>01543                     $briefstatsdefs= $statsdefs['Total']['BriefStats'];
<a name="l01544"></a>01544                     
<a name="l01545"></a>01545                     <span class="keywordflow">if</span> (isset($briefstatsdefs)) {
<a name="l01546"></a>01546                         <span class="keywordflow">if</span> (!isset($briefstatsdefs['Date'])) {
<a name="l01547"></a>01547                             <span class="comment">// Always collect Date field</span>
<a name="l01548"></a>01548                             $briefstatsdefs['Date'] = _('Requests by date');
<a name="l01549"></a>01549                         }
<a name="l01550"></a>01550 
<a name="l01551"></a>01551                         <span class="comment">// Collect the fields listed under BriefStats</span>
<a name="l01552"></a>01552                         <span class="keywordflow">foreach</span> ($briefstatsdefs as $name =&gt; $title) {
<a name="l01553"></a>01553                             $value= $values[$name];
<a name="l01554"></a>01554                             <span class="keywordflow">if</span> (isset($value)) {
<a name="l01555"></a>01555                                 $briefstats[$name][$value]+= 1;
<a name="l01556"></a>01556                             }
<a name="l01557"></a>01557                         }
<a name="l01558"></a>01558                     }
<a name="l01559"></a>01559                 }
<a name="l01560"></a>01560             }
<a name="l01561"></a>01561         }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563         $this-&gt;<a class="code" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output.">SaveStats</a>($logfile, <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>, $briefstats, $linecount);
<a name="l01564"></a>01564     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_2de95faa4fc211f54fcc882609ca4d7f_cgraph.png" border="0" usemap="#classModel_2de95faa4fc211f54fcc882609ca4d7f_cgraph_map" alt=""></center>
<map name="classModel_2de95faa4fc211f54fcc882609ca4d7f_cgraph_map">
<area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="213,81,387,108"><area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="205,309,395,336"><area shape="rect" href="classModel.html#0e43ca38ee4cee9f29e6b8192024dc28" title="Gets line count of file." alt="" coords="444,360,623,387"><area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="449,208,617,235"><area shape="rect" href="classModel.html#2b5091c9fb872dccd476b2147d163e0d" title="Builds generic grep command to extract log lines." alt="" coords="208,411,392,437"><area shape="rect" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser." alt="" coords="223,512,377,539"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="465,461,601,488"><area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="444,56,623,83"><area shape="rect" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values." alt="" coords="709,5,829,32"><area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="724,259,815,285"><area shape="rect" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector." alt="" coords="675,56,864,83"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="916,309,1095,336"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="447,309,620,336"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="676,309,863,336"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="673,360,865,387"><area shape="rect" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents." alt="" coords="713,208,825,235"><area shape="rect" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line." alt="" coords="447,512,620,539"><area shape="rect" href="classModel.html#cdf121f58a23152dcc4071dfe70db060" title="Writes contents to file." alt="" coords="713,411,825,437"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_2de95faa4fc211f54fcc882609ca4d7f_icgraph.png" border="0" usemap="#classModel_2de95faa4fc211f54fcc882609ca4d7f_icgraph_map" alt=""></center>
<map name="classModel_2de95faa4fc211f54fcc882609ca4d7f_icgraph_map">
<area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="207,31,332,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="381,5,523,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="571,31,677,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="96cdbca1cb750f08af734720ce035527"></a><!-- doxytag: member="Model::GetDateRegexp" ref="96cdbca1cb750f08af734720ce035527" args="($date)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetDateRegexp           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>date</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates date regexp to be used by statistics functions. 
<p>
Used to match date indeces of stats array to get stats for date ranges.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$date</em>&nbsp;</td><td>array Date struct </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Regexp </dd></dl>

<p>Reimplemented in <a class="el" href="classPf.html#a6794e0acb4ccbd66c32edf3a2cc93b5">Pf</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01573">1573</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="defs_8php-source.html#l00101">$MonthNames</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01574"></a>01574     {
<a name="l01575"></a>01575         global <a class="code" href="defs_8php.html#4ce923af45f11d3c8c5488c75cdefbb5" title="Used for months translation from number to string.">$MonthNames</a>;
<a name="l01576"></a>01576 
<a name="l01577"></a>01577         <span class="keywordflow">if</span> ($date['Month'] == '') {
<a name="l01578"></a>01578             $re= '.*';
<a name="l01579"></a>01579         }
<a name="l01580"></a>01580         <span class="keywordflow">else</span> {
<a name="l01581"></a>01581             $re= $MonthNames[$date['Month']].'\s+';
<a name="l01582"></a>01582             <span class="keywordflow">if</span> ($date['Day'] == '') {
<a name="l01583"></a>01583                 $re.= '.*';
<a name="l01584"></a>01584             }
<a name="l01585"></a>01585             <span class="keywordflow">else</span> {
<a name="l01586"></a>01586                 $re.= sprintf('% 2d', $date['Day']);
<a name="l01587"></a>01587             }
<a name="l01588"></a>01588         }
<a name="l01589"></a>01589         <span class="keywordflow">return</span> $re;
<a name="l01590"></a>01590     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_96cdbca1cb750f08af734720ce035527_icgraph.png" border="0" usemap="#classModel_96cdbca1cb750f08af734720ce035527_icgraph_map" alt=""></center>
<map name="classModel_96cdbca1cb750f08af734720ce035527_icgraph_map">
<area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="228,31,353,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="403,5,544,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="592,31,699,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="06a223ba294ce4dedc681900919c35b5"></a><!-- doxytag: member="Model::GetHourRegexp" ref="06a223ba294ce4dedc681900919c35b5" args="($date)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetHourRegexp           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>date</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generates hour regexp to be used by statistics functions. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$date</em>&nbsp;</td><td>array Date struct </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Regexp </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01597">1597</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01598"></a>01598     {
<a name="l01599"></a>01599         <span class="keywordflow">if</span> ($date['Hour'] == '') {
<a name="l01600"></a>01600             $re= '.*';
<a name="l01601"></a>01601         }
<a name="l01602"></a>01602         <span class="keywordflow">else</span> {
<a name="l01603"></a>01603             $re= $date['Hour'];
<a name="l01604"></a>01604         }
<a name="l01605"></a>01605         <span class="keywordflow">return</span> $re;
<a name="l01606"></a>01606     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_06a223ba294ce4dedc681900919c35b5_icgraph.png" border="0" usemap="#classModel_06a223ba294ce4dedc681900919c35b5_icgraph_map" alt=""></center>
<map name="classModel_06a223ba294ce4dedc681900919c35b5_icgraph_map">
<area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="228,31,353,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="403,5,544,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="592,31,699,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="71879d121d5eb29eefaca11136b08239"></a><!-- doxytag: member="Model::GetSavedStats" ref="71879d121d5eb29eefaca11136b08239" args="($logfile, &amp;$stats, &amp;$briefstats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetSavedStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>briefstats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets saved statistics for the given log file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$stats</em>&nbsp;</td><td>array Statistics </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$briefstats</em>&nbsp;</td><td>array Brief statistics </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01614">1614</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l01252">GetFile()</a>, and <a class="el" href="model_8php-source.html#l01700">GetStatsFileName()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01396">GetAllStats()</a>, <a class="el" href="model_8php-source.html#l01424">GetStats()</a>, and <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01615"></a>01615     {
<a name="l01616"></a>01616         $statsfile= $this-&gt;<a class="code" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file.">GetStatsFileName</a>($logfile);
<a name="l01617"></a>01617         <span class="keywordflow">if</span> (($filecontents= $this-&gt;<a class="code" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents.">GetFile</a>($statsfile)) !== FALSE) {
<a name="l01618"></a>01618             <span class="keywordflow">if</span> ($serialized_stats= preg_replace(<span class="stringliteral">"|^(&lt;filestat&gt;.*&lt;/filestat&gt;\s)|m"</span>, '', $filecontents)) {
<a name="l01619"></a>01619                 $allstats= unserialize($serialized_stats);
<a name="l01620"></a>01620                 <span class="keywordflow">if</span> (isset($allstats['stats']) &amp;&amp; isset($allstats['briefstats'])) {
<a name="l01621"></a>01621                     <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>= $allstats['stats'];
<a name="l01622"></a>01622                     $briefstats= $allstats['briefstats'];
<a name="l01623"></a>01623                     <span class="keywordflow">return</span> TRUE;
<a name="l01624"></a>01624                 }
<a name="l01625"></a>01625                 <span class="keywordflow">else</span> {
<a name="l01626"></a>01626                     <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Missing stats in file: $statsfile"</span>);
<a name="l01627"></a>01627                 }
<a name="l01628"></a>01628             }
<a name="l01629"></a>01629             <span class="keywordflow">else</span> {
<a name="l01630"></a>01630                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"filestat removal failed in file: $statsfile"</span>);
<a name="l01631"></a>01631             }
<a name="l01632"></a>01632         }
<a name="l01633"></a>01633         <span class="keywordflow">return</span> FALSE;
<a name="l01634"></a>01634     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_71879d121d5eb29eefaca11136b08239_cgraph.png" border="0" usemap="#classModel_71879d121d5eb29eefaca11136b08239_cgraph_map" alt=""></center>
<map name="classModel_71879d121d5eb29eefaca11136b08239_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="271,5,361,32"><area shape="rect" href="classModel.html#79a6802745276910632fee29f9585495" title="Reads file contents." alt="" coords="260,56,372,83"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="223,107,409,133"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="460,107,639,133"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_71879d121d5eb29eefaca11136b08239_icgraph.png" border="0" usemap="#classModel_71879d121d5eb29eefaca11136b08239_icgraph_map" alt=""></center>
<map name="classModel_71879d121d5eb29eefaca11136b08239_icgraph_map">
<area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="597,5,739,32"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="423,56,548,83"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="223,107,372,133"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="787,31,893,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5b128ecbe8f5dba639ac124a1306be2b"></a><!-- doxytag: member="Model::IsLogFileModified" ref="5b128ecbe8f5dba639ac124a1306be2b" args="($logfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::IsLogFileModified           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the given log file has been updated. 
<p>
Compares the full stat info, except for last access time, which is updated by the stat() call too.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01643">1643</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l01714">GetOrigFileName()</a>, and <a class="el" href="model_8php-source.html#l01669">GetStatsFileInfo()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01424">GetStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01644"></a>01644     {
<a name="l01645"></a>01645         $origfile= $this-&gt;<a class="code" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file.">GetOrigFileName</a>($logfile);
<a name="l01646"></a>01646         
<a name="l01647"></a>01647         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file.">GetStatsFileInfo</a>($logfile, $linecount, $filestat)) {
<a name="l01648"></a>01648             <span class="keywordflow">if</span> (file_exists($origfile)) {
<a name="l01649"></a>01649                 $newfilestat= stat($origfile);
<a name="l01650"></a>01650 
<a name="l01651"></a>01651                 $diff= array_diff($newfilestat, $filestat);
<a name="l01652"></a>01652                 unset($diff[<span class="charliteral">'8'</span>]);
<a name="l01653"></a>01653                 unset($diff['atime']);
<a name="l01654"></a>01654                 <span class="keywordflow">if</span> (count($diff) === 0) {
<a name="l01655"></a>01655                     <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Logfile not modified: $logfile, linecount $linecount"</span>);
<a name="l01656"></a>01656                     <span class="keywordflow">return</span> FALSE;
<a name="l01657"></a>01657                 }
<a name="l01658"></a>01658             }
<a name="l01659"></a>01659         }
<a name="l01660"></a>01660         <span class="keywordflow">return</span> TRUE;
<a name="l01661"></a>01661     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_5b128ecbe8f5dba639ac124a1306be2b_cgraph.png" border="0" usemap="#classModel_5b128ecbe8f5dba639ac124a1306be2b_cgraph_map" alt=""></center>
<map name="classModel_5b128ecbe8f5dba639ac124a1306be2b_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="505,33,596,60"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="697,33,876,60"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="232,84,405,111"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="457,84,644,111"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="455,135,647,161"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_5b128ecbe8f5dba639ac124a1306be2b_icgraph.png" border="0" usemap="#classModel_5b128ecbe8f5dba639ac124a1306be2b_icgraph_map" alt=""></center>
<map name="classModel_5b128ecbe8f5dba639ac124a1306be2b_icgraph_map">
<area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="233,31,359,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="408,5,549,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="597,31,704,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="63f975dc16ccd933fe89d6c7b78b2ffb"></a><!-- doxytag: member="Model::GetStatsFileInfo" ref="63f975dc16ccd933fe89d6c7b78b2ffb" args="($logfile, &amp;$linecount, &amp;$filestat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetStatsFileInfo           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>linecount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>filestat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets previous line count and stat() from statistics file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$linecount</em>&nbsp;</td><td>int Previous line count </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$filestat</em>&nbsp;</td><td>array Previous stat() output </td></tr>
  </table>
</dl>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000034">Todo:</a></b></dt><dd>Should check file format too, and delete the stats file if corrupted </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01669">1669</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l01700">GetStatsFileName()</a>, and <a class="el" href="model_8php-source.html#l00389">RunShellCommand()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01478">CountDiffLogLines()</a>, and <a class="el" href="model_8php-source.html#l01643">IsLogFileModified()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01670"></a>01670     {
<a name="l01672"></a>01672         
<a name="l01673"></a>01673         $linecount= 0;
<a name="l01674"></a>01674         $filestat= array();
<a name="l01675"></a>01675         
<a name="l01676"></a>01676         $statsfile= $this-&gt;<a class="code" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file.">GetStatsFileName</a>($logfile);
<a name="l01677"></a>01677         <span class="keywordflow">if</span> (file_exists($statsfile)) {
<a name="l01678"></a>01678             $filestatline= $this-&gt;<a class="code" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string.">RunShellCommand</a>(<span class="stringliteral">"/usr/bin/head -1 $statsfile"</span>);
<a name="l01679"></a>01679             <span class="keywordflow">if</span> (preg_match('|^&lt;filestat&gt;(.*)&lt;/filestat&gt;$|', $filestatline, $match)) {
<a name="l01680"></a>01680                 $fileinfo= unserialize($match[1]);
<a name="l01681"></a>01681                 
<a name="l01682"></a>01682                 $linecount= $fileinfo['linecount'];
<a name="l01683"></a>01683                 $filestat= $fileinfo['stat'];
<a name="l01684"></a>01684                 <span class="keywordflow">return</span> TRUE;
<a name="l01685"></a>01685             }
<a name="l01686"></a>01686             <span class="keywordflow">else</span> {
<a name="l01687"></a>01687                 <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"filestat missing in: $statsfile"</span>);
<a name="l01688"></a>01688             }
<a name="l01689"></a>01689         }
<a name="l01690"></a>01690         <span class="keywordflow">else</span> {
<a name="l01691"></a>01691             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"No such file: $statsfile"</span>);
<a name="l01692"></a>01692         }
<a name="l01693"></a>01693         <span class="keywordflow">return</span> FALSE;
<a name="l01694"></a>01694     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_63f975dc16ccd933fe89d6c7b78b2ffb_cgraph.png" border="0" usemap="#classModel_63f975dc16ccd933fe89d6c7b78b2ffb_cgraph_map" alt=""></center>
<map name="classModel_63f975dc16ccd933fe89d6c7b78b2ffb_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="279,5,369,32"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="231,56,417,83"><area shape="rect" href="classModel.html#2d12753c999aac330108a00dd0f3abec" title="Runs given shell command and returns its output as string." alt="" coords="228,107,420,133"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="471,56,649,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_63f975dc16ccd933fe89d6c7b78b2ffb_icgraph.png" border="0" usemap="#classModel_63f975dc16ccd933fe89d6c7b78b2ffb_icgraph_map" alt=""></center>
<map name="classModel_63f975dc16ccd933fe89d6c7b78b2ffb_icgraph_map">
<area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="227,5,416,32"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="464,56,643,83"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="479,5,628,32"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="692,31,817,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="867,5,1008,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1056,31,1163,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9832a4bcb216f976db39555e231ec2b5"></a><!-- doxytag: member="Model::GetStatsFileName" ref="9832a4bcb216f976db39555e231ec2b5" args="($logfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetStatsFileName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets name of the tmp statistics file for the given log file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01700">1700</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l01714">GetOrigFileName()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01614">GetSavedStats()</a>, <a class="el" href="model_8php-source.html#l01669">GetStatsFileInfo()</a>, and <a class="el" href="model_8php-source.html#l01736">SaveStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01701"></a>01701     {
<a name="l01702"></a>01702         $origfilename= basename($this-&gt;<a class="code" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file.">GetOrigFileName</a>($logfile));
<a name="l01703"></a>01703         
<a name="l01704"></a>01704         $statsdir= '/var/tmp/comixwall/stats/'.get_class($this);
<a name="l01705"></a>01705         $statsfile= <span class="stringliteral">"$statsdir/$origfilename"</span>;
<a name="l01706"></a>01706 
<a name="l01707"></a>01707         <span class="keywordflow">return</span> $statsfile;
<a name="l01708"></a>01708     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_9832a4bcb216f976db39555e231ec2b5_cgraph.png" border="0" usemap="#classModel_9832a4bcb216f976db39555e231ec2b5_cgraph_map" alt=""></center>
<map name="classModel_9832a4bcb216f976db39555e231ec2b5_cgraph_map">
<area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="244,5,423,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_9832a4bcb216f976db39555e231ec2b5_icgraph.png" border="0" usemap="#classModel_9832a4bcb216f976db39555e231ec2b5_icgraph_map" alt=""></center>
<map name="classModel_9832a4bcb216f976db39555e231ec2b5_icgraph_map">
<area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="475,5,643,32"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="243,107,416,133"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="261,56,397,83"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="1104,5,1245,32"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="929,56,1055,83"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="716,81,865,108"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1293,31,1400,57"><area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="464,107,653,133"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="701,157,880,184"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7c82d9c0848789a5b3cc4be23c58f13f"></a><!-- doxytag: member="Model::GetOrigFileName" ref="7c82d9c0848789a5b3cc4be23c58f13f" args="($logfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::GetOrigFileName           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the original file name for the given log file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01714">1714</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01478">CountDiffLogLines()</a>, <a class="el" href="model_8php-source.html#l01700">GetStatsFileName()</a>, <a class="el" href="model_8php-source.html#l01643">IsLogFileModified()</a>, and <a class="el" href="model_8php-source.html#l01736">SaveStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01715"></a>01715     {
<a name="l01716"></a>01716         $origfilename= basename($logfile);
<a name="l01717"></a>01717         <span class="keywordflow">if</span> (basename($this-&gt;LogFile) !== $origfilename) {
<a name="l01718"></a>01718             $origfilename.= '.gz';
<a name="l01719"></a>01719         }
<a name="l01720"></a>01720         $origfile= dirname($this-&gt;LogFile).<span class="charliteral">'/'</span>.$origfilename;
<a name="l01721"></a>01721         
<a name="l01722"></a>01722         <span class="keywordflow">return</span> $origfile;
<a name="l01723"></a>01723     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_7c82d9c0848789a5b3cc4be23c58f13f_icgraph.png" border="0" usemap="#classModel_7c82d9c0848789a5b3cc4be23c58f13f_icgraph_map" alt=""></center>
<map name="classModel_7c82d9c0848789a5b3cc4be23c58f13f_icgraph_map">
<area shape="rect" href="classModel.html#e87cab614cb0dda5a48a0483ad20bb13" title="Gets the number of lines added to log files since last tmp update." alt="" coords="693,157,883,184"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="236,107,423,133"><area shape="rect" href="classModel.html#5b128ecbe8f5dba639ac124a1306be2b" title="Checks if the given log file has been updated." alt="" coords="699,5,877,32"><area shape="rect" href="classModel.html#61048fb2a76e82a62bc1cb060f956846" title="Saves collected statistics with current line count and stat() output." alt="" coords="491,157,627,184"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="932,157,1081,184"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="1132,107,1257,133"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="1307,56,1448,83"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1496,81,1603,108"><area shape="rect" href="classModel.html#71879d121d5eb29eefaca11136b08239" title="Gets saved statistics for the given log file." alt="" coords="704,107,872,133"><area shape="rect" href="classModel.html#63f975dc16ccd933fe89d6c7b78b2ffb" title="Gets previous line count and stat() from statistics file." alt="" coords="472,56,645,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="61048fb2a76e82a62bc1cb060f956846"></a><!-- doxytag: member="Model::SaveStats" ref="61048fb2a76e82a62bc1cb060f956846" args="($logfile, $stats, $briefstats, $linecount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::SaveStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>briefstats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>linecount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Saves collected statistics with current line count and stat() output. 
<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Line count should be get before statistics collection, otherwise new lines appended during stats processing may be skipped, hence the $linecount param.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logfile</em>&nbsp;</td><td>string Log file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$stats</em>&nbsp;</td><td>array Statistics </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$briefstats</em>&nbsp;</td><td>array Brief statistics </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$linecount</em>&nbsp;</td><td>int Line count </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01736">1736</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, <a class="el" href="model_8php-source.html#l01714">GetOrigFileName()</a>, <a class="el" href="model_8php-source.html#l01700">GetStatsFileName()</a>, and <a class="el" href="model_8php-source.html#l01372">PutFile()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01737"></a>01737     {
<a name="l01738"></a>01738         $origfile= $this-&gt;<a class="code" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file.">GetOrigFileName</a>($logfile);
<a name="l01739"></a>01739         $statsfile= $this-&gt;<a class="code" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file.">GetStatsFileName</a>($logfile);
<a name="l01740"></a>01740         
<a name="l01741"></a>01741         $savestats=
<a name="l01742"></a>01742             '&lt;filestat&gt;'.
<a name="l01743"></a>01743             serialize(
<a name="l01744"></a>01744                 array(
<a name="l01745"></a>01745                     'linecount' =&gt; $linecount,
<a name="l01746"></a>01746                     'stat'      =&gt; stat($origfile),
<a name="l01747"></a>01747                     )
<a name="l01748"></a>01748             ).
<a name="l01749"></a>01749             '&lt;/filestat&gt;'.<span class="stringliteral">"\n"</span>.
<a name="l01750"></a>01750             serialize(
<a name="l01751"></a>01751                 array(
<a name="l01752"></a>01752                     'stats'     =&gt; <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>,
<a name="l01753"></a>01753                     'briefstats'=&gt; $briefstats,
<a name="l01754"></a>01754                     )
<a name="l01755"></a>01755             );
<a name="l01756"></a>01756         
<a name="l01757"></a>01757         $statsdir= dirname($statsfile);
<a name="l01758"></a>01758         <span class="keywordflow">if</span> (!file_exists($statsdir)) {
<a name="l01759"></a>01759             exec('/bin/mkdir -p '.$statsdir);
<a name="l01760"></a>01760         }
<a name="l01761"></a>01761         
<a name="l01762"></a>01762         exec('/usr/bin/touch '.$statsfile);
<a name="l01763"></a>01763         $this-&gt;<a class="code" href="classModel.html#cdf121f58a23152dcc4071dfe70db060" title="Writes contents to file.">PutFile</a>($statsfile, $savestats);
<a name="l01764"></a>01764         <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, <span class="stringliteral">"Saved stats to: $statsfile"</span>);
<a name="l01765"></a>01765     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_61048fb2a76e82a62bc1cb060f956846_cgraph.png" border="0" usemap="#classModel_61048fb2a76e82a62bc1cb060f956846_cgraph_map" alt=""></center>
<map name="classModel_61048fb2a76e82a62bc1cb060f956846_cgraph_map">
<area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="239,5,329,32"><area shape="rect" href="classModel.html#7c82d9c0848789a5b3cc4be23c58f13f" title="Returns the original file name for the given log file." alt="" coords="428,81,607,108"><area shape="rect" href="classModel.html#9832a4bcb216f976db39555e231ec2b5" title="Gets name of the tmp statistics file for the given log file." alt="" coords="191,107,377,133"><area shape="rect" href="classModel.html#cdf121f58a23152dcc4071dfe70db060" title="Writes contents to file." alt="" coords="228,157,340,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_61048fb2a76e82a62bc1cb060f956846_icgraph.png" border="0" usemap="#classModel_61048fb2a76e82a62bc1cb060f956846_icgraph_map" alt=""></center>
<map name="classModel_61048fb2a76e82a62bc1cb060f956846_icgraph_map">
<area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="191,31,340,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="391,31,516,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="565,5,707,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="755,31,861,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="d94e185c4edbac25ceabb66fe5c7f4db"></a><!-- doxytag: member="Model::CollectDayStats" ref="d94e185c4edbac25ceabb66fe5c7f4db" args="($statsdefs, $values, $line, &amp;$stats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CollectDayStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>stats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Day statistics collector. 
<p>
$statsdefs has all the information to collect what data.<p>
If parsed log time does not have an appropriate hour/min, then 12:00 is assumed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$statsdefs</em>&nbsp;</td><td>array Module stats section of $Modules </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$values</em>&nbsp;</td><td>array Log fields parsed by caller function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$line</em>&nbsp;</td><td>string Current log line needed to search for keywords </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$stats</em>&nbsp;</td><td>array Statistics data set collected</td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000035">Todo:</a></b></dt><dd>How is it possible that Time does not have hour/min? Should have a module Time field processor as well? </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01781">1781</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>, <a class="el" href="model_8php-source.html#l01814">CollectHourStats()</a>, <a class="el" href="Controller_2lib_8php-source.html#l00050">cwc_syslog()</a>, and <a class="el" href="model_8php-source.html#l01824">IncStats()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01782"></a>01782     {
<a name="l01783"></a>01783         $re= '/^(\d+):(\d+):(\d+)$/';
<a name="l01784"></a>01784         <span class="keywordflow">if</span> (preg_match($re, $values['Time'], $match)) {
<a name="l01785"></a>01785             $hour= $match[1];
<a name="l01786"></a>01786             $min= $match[2];
<a name="l01787"></a>01787         }
<a name="l01788"></a>01788         <span class="keywordflow">else</span> {
<a name="l01789"></a>01789             <span class="comment">// Should be unreachable</span>
<a name="l01790"></a>01790             $hour= '12';
<a name="l01791"></a>01791             $min= '00';
<a name="l01792"></a>01792             <a class="code" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog.">cwc_syslog</a>(LOG_DEBUG, __FILE__, __FUNCTION__, __LINE__, 'There was no Time in log values, defaulting to 12:00');
<a name="l01793"></a>01793         }
<a name="l01794"></a>01794 
<a name="l01795"></a>01795         $daystats= &amp;<a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Date'][$values['Date']];
<a name="l01796"></a>01796         $this-&gt;<a class="code" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values.">IncStats</a>($line, $values, $statsdefs, $daystats);
<a name="l01797"></a>01797 
<a name="l01798"></a>01798         $this-&gt;<a class="code" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector.">CollectHourStats</a>($statsdefs, $hour, $min, $values, $line, $daystats);
<a name="l01799"></a>01799     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d94e185c4edbac25ceabb66fe5c7f4db_cgraph.png" border="0" usemap="#classModel_d94e185c4edbac25ceabb66fe5c7f4db_cgraph_map" alt=""></center>
<map name="classModel_d94e185c4edbac25ceabb66fe5c7f4db_cgraph_map">
<area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="227,5,405,32"><area shape="rect" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values." alt="" coords="489,56,609,83"><area shape="rect" href="Controller_2lib_8php.html#452de2ffc796752557de0932efe45dab" title="Wrapper for controller error logging via syslog." alt="" coords="271,107,361,133"><area shape="rect" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector." alt="" coords="455,5,644,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d94e185c4edbac25ceabb66fe5c7f4db_icgraph.png" border="0" usemap="#classModel_d94e185c4edbac25ceabb66fe5c7f4db_icgraph_map" alt=""></center>
<map name="classModel_d94e185c4edbac25ceabb66fe5c7f4db_icgraph_map">
<area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="228,31,377,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="428,31,553,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="603,5,744,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="792,31,899,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="eee718dc90c3fc97b8e613e5f5a0a302"></a><!-- doxytag: member="Model::CollectHourStats" ref="eee718dc90c3fc97b8e613e5f5a0a302" args="($statsdefs, $hour, $min, $values, $line, &amp;$daystats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CollectHourStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>daystats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hour statistics collector. 
<p>
$statsdefs has all the information to collect what data.<p>
$daystats is the subsection of the main $stats array for the current date.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$statsdefs</em>&nbsp;</td><td>array Module stats section of $Modules </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$hour</em>&nbsp;</td><td>string Hour to collect stats for </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$min</em>&nbsp;</td><td>string Min to collect stats for, passed to <a class="el" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector.">CollectMinuteStats()</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$values</em>&nbsp;</td><td>array Log fields parsed by caller function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$line</em>&nbsp;</td><td>string Current log line needed to search for keywords </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$daystats</em>&nbsp;</td><td>array Statistics data set collected </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01814">1814</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l01870">CollectMinuteStats()</a>, and <a class="el" href="model_8php-source.html#l01824">IncStats()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01781">CollectDayStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01815"></a>01815     {
<a name="l01816"></a>01816         $hourstats= &amp;$daystats['Hours'][$hour];
<a name="l01817"></a>01817         $this-&gt;<a class="code" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values.">IncStats</a>($line, $values, $statsdefs, $hourstats);
<a name="l01818"></a>01818 
<a name="l01819"></a>01819         $this-&gt;<a class="code" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector.">CollectMinuteStats</a>($statsdefs, $min, $values, $line, $hourstats);
<a name="l01820"></a>01820     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_eee718dc90c3fc97b8e613e5f5a0a302_cgraph.png" border="0" usemap="#classModel_eee718dc90c3fc97b8e613e5f5a0a302_cgraph_map" alt=""></center>
<map name="classModel_eee718dc90c3fc97b8e613e5f5a0a302_cgraph_map">
<area shape="rect" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector." alt="" coords="233,5,423,32"><area shape="rect" href="classModel.html#da770adbe085197a1fc3b64fc3fde31d" title="Increments stats for the given values." alt="" coords="268,56,388,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_eee718dc90c3fc97b8e613e5f5a0a302_icgraph.png" border="0" usemap="#classModel_eee718dc90c3fc97b8e613e5f5a0a302_icgraph_map" alt=""></center>
<map name="classModel_eee718dc90c3fc97b8e613e5f5a0a302_icgraph_map">
<area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="232,31,405,57"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="455,31,604,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="655,31,780,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="829,5,971,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1019,31,1125,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="da770adbe085197a1fc3b64fc3fde31d"></a><!-- doxytag: member="Model::IncStats" ref="da770adbe085197a1fc3b64fc3fde31d" args="($line, $values, $statsdefs, &amp;$stats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::IncStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>stats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Increments stats for the given values. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01824">1824</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="logsreport_8php-source.html#l00172">$stats</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01781">CollectDayStats()</a>, and <a class="el" href="model_8php-source.html#l01814">CollectHourStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01825"></a>01825     {
<a name="l01826"></a>01826         <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>['Sum']+= 1;
<a name="l01827"></a>01827 
<a name="l01828"></a>01828         <span class="keywordflow">if</span> (isset($statsdefs['Total']['Counters'])) {
<a name="l01829"></a>01829             <span class="keywordflow">foreach</span> ($statsdefs['Total']['Counters'] as $counter =&gt; $conf) {
<a name="l01830"></a>01830                 $value= $values[$conf['Field']];
<a name="l01831"></a>01831                 <span class="keywordflow">if</span> (isset($value)) {
<a name="l01832"></a>01832                     <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>[$counter]['Sum']+= $value;
<a name="l01833"></a>01833 
<a name="l01834"></a>01834                     <span class="keywordflow">foreach</span> ($conf['NVPs'] as $name =&gt; $title) {
<a name="l01835"></a>01835                         <span class="keywordflow">if</span> (isset($values[$name])) {
<a name="l01836"></a>01836                             <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>[$counter][$name][$values[$name]]+= $value;
<a name="l01837"></a>01837                         }
<a name="l01838"></a>01838                     }
<a name="l01839"></a>01839                 }
<a name="l01840"></a>01840             }
<a name="l01841"></a>01841         }
<a name="l01842"></a>01842 
<a name="l01843"></a>01843         <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $conf) {
<a name="l01844"></a>01844             <span class="keywordflow">if</span> (isset($conf['Needle'])) {
<a name="l01845"></a>01845                 <span class="keywordflow">if</span> (preg_match(<span class="charliteral">'/'</span>.$conf['Needle'].<span class="charliteral">'/'</span>, $line)) {
<a name="l01846"></a>01846                     <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>[$stat]['Sum']+= 1;
<a name="l01847"></a>01847 
<a name="l01848"></a>01848                     <span class="keywordflow">foreach</span> ($conf['NVPs'] as $name =&gt; $title) {
<a name="l01849"></a>01849                         <span class="keywordflow">if</span> (isset($values[$name])) {
<a name="l01850"></a>01850                             <a class="code" href="logsreport_8php.html#c61adefb58583938c9b820405ddfa018">$stats</a>[$stat][$name][$values[$name]]+= 1;
<a name="l01851"></a>01851                         }
<a name="l01852"></a>01852                     }
<a name="l01853"></a>01853                 }
<a name="l01854"></a>01854             }
<a name="l01855"></a>01855         }
<a name="l01856"></a>01856     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_da770adbe085197a1fc3b64fc3fde31d_icgraph.png" border="0" usemap="#classModel_da770adbe085197a1fc3b64fc3fde31d_icgraph_map" alt=""></center>
<map name="classModel_da770adbe085197a1fc3b64fc3fde31d_icgraph_map">
<area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="403,31,576,57"><area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="176,56,355,83"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="625,31,775,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="825,31,951,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="1000,5,1141,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1189,31,1296,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="d11bfed931dee6dcda7576ab5a0d950a"></a><!-- doxytag: member="Model::CollectMinuteStats" ref="d11bfed931dee6dcda7576ab5a0d950a" args="($statsdefs, $min, $values, $line, &amp;$hourstats)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::CollectMinuteStats           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>statsdefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>hourstats</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Minute statistics collector. 
<p>
$statsdefs has all the information to collect what data.<p>
$hourstats is the subsection of the $stats array for the current hour.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$statsdefs</em>&nbsp;</td><td>array Module stats section of $Modules </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$min</em>&nbsp;</td><td>string Min to collect stats for, passed to <a class="el" href="classModel.html#d11bfed931dee6dcda7576ab5a0d950a" title="Minute statistics collector.">CollectMinuteStats()</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$values</em>&nbsp;</td><td>array Log fields parsed by caller function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$line</em>&nbsp;</td><td>string Current log line needed to search for keywords </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$hourstats</em>&nbsp;</td><td>array Statistics data set collected </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01870">1870</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01814">CollectHourStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01871"></a>01871     {
<a name="l01872"></a>01872         $minstats= &amp;$hourstats['Mins'][$min];
<a name="l01873"></a>01873         $minstats['Sum']+= 1;
<a name="l01874"></a>01874 
<a name="l01875"></a>01875         <span class="keywordflow">if</span> (isset($statsdefs['Total']['Counters'])) {
<a name="l01876"></a>01876             <span class="keywordflow">foreach</span> ($statsdefs['Total']['Counters'] as $counter =&gt; $conf) {
<a name="l01877"></a>01877                 <span class="keywordflow">if</span> (isset($values[$conf['Field']])) {
<a name="l01878"></a>01878                     $minstats[$counter]+= $values[$conf['Field']];
<a name="l01879"></a>01879                 }
<a name="l01880"></a>01880             }
<a name="l01881"></a>01881         }
<a name="l01882"></a>01882 
<a name="l01883"></a>01883         <span class="keywordflow">foreach</span> ($statsdefs as $stat =&gt; $conf) {
<a name="l01884"></a>01884             <span class="keywordflow">if</span> (isset($conf['Needle'])) {
<a name="l01885"></a>01885                 <span class="keywordflow">if</span> (preg_match(<span class="charliteral">'/'</span>.$conf['Needle'].<span class="charliteral">'/'</span>, $line)) {
<a name="l01886"></a>01886                     $minstats[$stat]+= 1;
<a name="l01887"></a>01887                 }
<a name="l01888"></a>01888             }
<a name="l01889"></a>01889         }
<a name="l01890"></a>01890     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_d11bfed931dee6dcda7576ab5a0d950a_icgraph.png" border="0" usemap="#classModel_d11bfed931dee6dcda7576ab5a0d950a_icgraph_map" alt=""></center>
<map name="classModel_d11bfed931dee6dcda7576ab5a0d950a_icgraph_map">
<area shape="rect" href="classModel.html#eee718dc90c3fc97b8e613e5f5a0a302" title="Hour statistics collector." alt="" coords="245,31,424,57"><area shape="rect" href="classModel.html#d94e185c4edbac25ceabb66fe5c7f4db" title="Day statistics collector." alt="" coords="472,31,645,57"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="695,31,844,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="895,31,1020,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="1069,5,1211,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1259,31,1365,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="580c841570e910e36dbf9879e96ec7c7"></a><!-- doxytag: member="Model::ParseLogLine" ref="580c841570e910e36dbf9879e96ec7c7" args="($logline, &amp;$cols)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::ParseLogLine           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>cols</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Log parser. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logline</em>&nbsp;</td><td>string Log line </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$cols</em>&nbsp;</td><td>array Parsed fields </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if log line is parsed </dd></dl>

<p>Reimplemented in <a class="el" href="classApache.html#e19dcac31ffb3970b0f513692d953e60">Apache</a>, <a class="el" href="classApachelogs.html#ce114fa7c97b8948b923637bed3f0409">Apachelogs</a>, <a class="el" href="classBlacklists.html#96bcbb8626c5175740fa36da1a893595">Blacklists</a>, <a class="el" href="classClamd.html#f54f6d626a59d8524c215b3cf2264cfa">Clamd</a>, <a class="el" href="classCwlogs.html#b3b1175f336c116258cd4fdb649f128b">Cwlogs</a>, <a class="el" href="classDansguardianlogs.html#615476276d32b326a0ca376272cb8e03">Dansguardianlogs</a>, <a class="el" href="classFreshclam.html#023b7ded8c18d0f1fb5698ea39cfb1a6">Freshclam</a>, <a class="el" href="classFtpproxy.html#38abdac0728054d105e43486f989f900">Ftpproxy</a>, <a class="el" href="classImlogs.html#dfb95a0723d9cd1b151b9ffa82479b30">Imlogs</a>, <a class="el" href="classNamed.html#42160cc99499d230b030b8de19702b3b">Named</a>, <a class="el" href="classOpenssh.html#db5e84034ebebb45694ac84d93acd711">Openssh</a>, <a class="el" href="classP3scan.html#53638375c1f2fb2af9fbbbc1811cfdbb">P3scan</a>, <a class="el" href="classPf.html#cecbdd6035cd3b36d7011c349102f9e7">Pf</a>, <a class="el" href="classSmtpgated.html#bcc7264e68e4df1e3272b17e27adfd19">Smtpgated</a>, <a class="el" href="classSnortalerts.html#739692605a8e36136d3a418780db4a6c">Snortalerts</a>, <a class="el" href="classSnortips.html#f72b7171f32c82b16cd0c36a96de71b7">Snortips</a>, <a class="el" href="classSpamassassin.html#6c0da9efffeb5bd6a1777eff90487a02">Spamassassin</a>, <a class="el" href="classSpamd.html#297c05afc82c12cd113cb56eae47c13b">Spamd</a>, and <a class="el" href="classSquid.html#9f2f5a8669182bf3a1d9d3bfa6594ab7">Squid</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l01898">1898</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>References <a class="el" href="model_8php-source.html#l01910">ParseSyslogLine()</a>.</p>

<p>Referenced by <a class="el" href="model_8php-source.html#l01513">UpdateStats()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01899"></a>01899     {
<a name="l01900"></a>01900         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line.">ParseSyslogLine</a>($logline, $cols);
<a name="l01901"></a>01901     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_580c841570e910e36dbf9879e96ec7c7_cgraph.png" border="0" usemap="#classModel_580c841570e910e36dbf9879e96ec7c7_cgraph_map" alt=""></center>
<map name="classModel_580c841570e910e36dbf9879e96ec7c7_cgraph_map">
<area shape="rect" href="classModel.html#f0db0d28b44c9a296eea592c5c551969" title="Parses standard syslog line." alt="" coords="212,5,385,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_580c841570e910e36dbf9879e96ec7c7_icgraph.png" border="0" usemap="#classModel_580c841570e910e36dbf9879e96ec7c7_icgraph_map" alt=""></center>
<map name="classModel_580c841570e910e36dbf9879e96ec7c7_icgraph_map">
<area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="212,31,361,57"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="412,31,537,57"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="587,5,728,32"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="776,31,883,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f0db0d28b44c9a296eea592c5c551969"></a><!-- doxytag: member="Model::ParseSyslogLine" ref="f0db0d28b44c9a296eea592c5c551969" args="($logline, &amp;$cols)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::ParseSyslogLine           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>logline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>cols</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parses standard syslog line. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>$logline</em>&nbsp;</td><td>string Log line </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>$cols</em>&nbsp;</td><td>array Parsed fields</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if log line is a syslog line, thus parsed </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l01910">1910</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

<p>Referenced by <a class="el" href="squid_8php-source.html#l00118">Squid::ParseLogLine()</a>, <a class="el" href="spamd_8php-source.html#l00114">Spamd::ParseLogLine()</a>, <a class="el" href="spamassassin_8php-source.html#l00137">Spamassassin::ParseLogLine()</a>, <a class="el" href="snortips_8php-source.html#l00336">Snortips::ParseLogLine()</a>, <a class="el" href="snortalerts_8php-source.html#l00044">Snortalerts::ParseLogLine()</a>, <a class="el" href="smtp-gated_8php-source.html#l00066">Smtpgated::ParseLogLine()</a>, <a class="el" href="p3scan_8php-source.html#l00129">P3scan::ParseLogLine()</a>, <a class="el" href="openssh_8php-source.html#l00061">Openssh::ParseLogLine()</a>, <a class="el" href="named_8php-source.html#l00094">Named::ParseLogLine()</a>, <a class="el" href="model_8php-source.html#l01898">ParseLogLine()</a>, <a class="el" href="ftp-proxy_8php-source.html#l00054">Ftpproxy::ParseLogLine()</a>, <a class="el" href="freshclam_8php-source.html#l00083">Freshclam::ParseLogLine()</a>, <a class="el" href="dansguardianlogs_8php-source.html#l00048">Dansguardianlogs::ParseLogLine()</a>, <a class="el" href="cwlogs_8php-source.html#l00044">Cwlogs::ParseLogLine()</a>, <a class="el" href="clamd_8php-source.html#l00061">Clamd::ParseLogLine()</a>, <a class="el" href="apachelogs_8php-source.html#l00048">Apachelogs::ParseLogLine()</a>, and <a class="el" href="apache_8php-source.html#l00083">Apache::ParseLogLine()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01911"></a>01911     {
<a name="l01912"></a>01912         $re_datetime= '(\w+\s+\d+)\s+(\d+:\d+:\d+)';
<a name="l01913"></a>01913         $re_proc= '((\S+(\[\d+\]|)):|)';
<a name="l01914"></a>01914         
<a name="l01915"></a>01915         $re= <span class="stringliteral">"/^$re_datetime\s+(\S+|)\s+$re_proc\s*(.*|)$/"</span>;
<a name="l01916"></a>01916         <span class="keywordflow">if</span> (preg_match($re, $logline, $match)) {
<a name="l01917"></a>01917             $cols['Date']= $match[1];
<a name="l01918"></a>01918             $cols['Time']= $match[2];
<a name="l01919"></a>01919             $cols['Process']= $match[5];
<a name="l01920"></a>01920             $cols['Log']= $match[7];
<a name="l01921"></a>01921             <span class="keywordflow">return</span> TRUE;
<a name="l01922"></a>01922         }
<a name="l01923"></a>01923         <span class="keywordflow">return</span> FALSE;
<a name="l01924"></a>01924     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="classModel_f0db0d28b44c9a296eea592c5c551969_icgraph.png" border="0" usemap="#classModel_f0db0d28b44c9a296eea592c5c551969_icgraph_map" alt=""></center>
<map name="classModel_f0db0d28b44c9a296eea592c5c551969_icgraph_map">
<area shape="rect" href="classSquid.html#9f2f5a8669182bf3a1d9d3bfa6594ab7" title="Log parser." alt="" coords="269,5,421,32"><area shape="rect" href="classSpamd.html#297c05afc82c12cd113cb56eae47c13b" title="Log parser." alt="" coords="264,56,427,83"><area shape="rect" href="classSpamassassin.html#6c0da9efffeb5bd6a1777eff90487a02" title="Log parser." alt="" coords="241,107,449,133"><area shape="rect" href="classSnortips.html#f72b7171f32c82b16cd0c36a96de71b7" title="Parses snortips IPS logs." alt="" coords="260,157,431,184"><area shape="rect" href="classSnortalerts.html#739692605a8e36136d3a418780db4a6c" title="Log parser." alt="" coords="251,208,440,235"><area shape="rect" href="classSmtpgated.html#bcc7264e68e4df1e3272b17e27adfd19" title="Log parser." alt="" coords="251,259,440,285"><area shape="rect" href="classP3scan.html#53638375c1f2fb2af9fbbbc1811cfdbb" title="Log parser." alt="" coords="264,309,427,336"><area shape="rect" href="classOpenssh.html#db5e84034ebebb45694ac84d93acd711" title="Log parser." alt="" coords="259,360,432,387"><area shape="rect" href="classNamed.html#42160cc99499d230b030b8de19702b3b" title="Log parser." alt="" coords="263,411,428,437"><area shape="rect" href="classModel.html#580c841570e910e36dbf9879e96ec7c7" title="Log parser." alt="" coords="268,461,423,488"><area shape="rect" href="classFtpproxy.html#38abdac0728054d105e43486f989f900" title="Log parser." alt="" coords="257,512,433,539"><area shape="rect" href="classFreshclam.html#023b7ded8c18d0f1fb5698ea39cfb1a6" title="Freshclam::ParseLogLine" alt="" coords="253,563,437,589"><area shape="rect" href="classDansguardianlogs.html#615476276d32b326a0ca376272cb8e03" title="Log parser." alt="" coords="229,613,461,640"><area shape="rect" href="classCwlogs.html#b3b1175f336c116258cd4fdb649f128b" title="Log parser." alt="" coords="264,664,427,691"><area shape="rect" href="classClamd.html#f54f6d626a59d8524c215b3cf2264cfa" title="Clamd::ParseLogLine" alt="" coords="265,715,425,741"><area shape="rect" href="classApachelogs.html#ce114fa7c97b8948b923637bed3f0409" title="Log parser." alt="" coords="251,765,440,792"><area shape="rect" href="classApache.html#e19dcac31ffb3970b0f513692d953e60" title="Log parser." alt="" coords="263,816,428,843"><area shape="rect" href="classSpamassassin.html#c2fe7f0398515200232f71f0dc8b45e2" title="Gets logs for live logs pages." alt="" coords="509,81,712,108"><area shape="rect" href="classSpamassassin.html#8a7106a1f0bdc04ac7cbda30de170945" title="Gets lines in file." alt="" coords="523,132,699,159"><area shape="rect" href="classOpenssh.html#684a7bae74bc190a59ffbb1cc957dd03" title="Gets logs for live logs pages." alt="" coords="528,335,693,361"><area shape="rect" href="classOpenssh.html#a2522838624ccdf57da6c8dc8b3dcfff" title="Gets lines in file." alt="" coords="541,385,680,412"><area shape="rect" href="classModel.html#2de95faa4fc211f54fcc882609ca4d7f" title="Updates statistics incrementally, both brief and full." alt="" coords="536,461,685,488"><area shape="rect" href="classModel.html#ffd6bba4698ad739939497598cadde66" title="Main statistics collector, as module data set." alt="" coords="761,461,887,488"><area shape="rect" href="classModel.html#a2edac23e52476f8e5c70d9893bc1fcb" title="Returns both brief and full statistics." alt="" coords="936,436,1077,463"><area shape="rect" href="classModel.html#e3b375de5f6df4faf74a95d64748e048" title="Model::Model" alt="" coords="1125,461,1232,488"></map>
</div>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="b36f902ed1a1e77d4318d579fed718bc"></a><!-- doxytag: member="Model::$Name" ref="b36f902ed1a1e77d4318d579fed718bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$Name = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#d9e31dee6882f67b0b3f449615c1a543">Apache</a>, <a class="el" href="classApachelogs.html#71f084fa15e3c3c811cd73a5516fcd15">Apachelogs</a>, <a class="el" href="classBlacklists.html#f520f4f5b56d03520fdd823b64b51335">Blacklists</a>, <a class="el" href="classClamd.html#ccb8a065a4803086e42c1c8b54cf9564">Clamd</a>, <a class="el" href="classDansguardian.html#bb99f6618d96e1f4aa985ee00d823568">Dansguardian</a>, <a class="el" href="classDansguardianlogs.html#0a24b81a44a3c75b1b2e0f74f4f72e85">Dansguardianlogs</a>, <a class="el" href="classDante.html#0bc665846f6a98e2330f43ee268959d5">Dante</a>, <a class="el" href="classDhcpd.html#8da8234dabbdfd29a14486de31c10a70">Dhcpd</a>, <a class="el" href="classFreshclam.html#ec24e5e128cd295f925033cd63ba427a">Freshclam</a>, <a class="el" href="classFtpproxy.html#f33c556c990a2b0e2cb2216d57b0ebd3">Ftpproxy</a>, <a class="el" href="classImspector.html#bcae9293136b68dafc0e95300b5651e2">Imspector</a>, <a class="el" href="classNamed.html#0360df991384f97cbe8310a11540f36e">Named</a>, <a class="el" href="classOpenssh.html#857b92a2ba779d708e3831f1fea52df4">Openssh</a>, <a class="el" href="classOpenvpn.html#6936c87cd10a480a1ad7e9004d607897">Openvpn</a>, <a class="el" href="classP3scan.html#c5169633ac1449ce622721f3d62a3418">P3scan</a>, <a class="el" href="classPf.html#83a2d36a2154713c60d2ce139bca73b2">Pf</a>, <a class="el" href="classPmacct.html#06f16bb723253daf0c0ebfc51fbdefdb">Pmacct</a>, <a class="el" href="classSmtpgated.html#9b070dd3cc01885ad6dad808afd6a8fd">Smtpgated</a>, <a class="el" href="classSnort.html#ad16d92942e059f20e32c5e0cb083634">Snort</a>, <a class="el" href="classSnortalerts.html#acb6c44afd739f25beb48c5423cf2f97">Snortalerts</a>, <a class="el" href="classSnortips.html#599d932f66d5426d1f42327cbdfc81e8">Snortips</a>, <a class="el" href="classSpamassassin.html#5dcbc1213419ce5a5f9758427f4de775">Spamassassin</a>, <a class="el" href="classSpamd.html#e1a6591467ce0c6cc0a463cb20bb8a56">Spamd</a>, <a class="el" href="classSquid.html#dd430e1acfdcda137d4096fc60d290b0">Squid</a>, <a class="el" href="classSymon.html#7b8aa1af6cdd4ce303b6a390a6438adc">Symon</a>, <a class="el" href="classSymux.html#ffc23bc37867ac081e48fb6860f78909">Symux</a>, and <a class="el" href="classSystem.html#4dda7c9150d17bf272e8c8809f25b8f5">System</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00042">42</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="dba4944c66dd108992af2cb507665c0e"></a><!-- doxytag: member="Model::$User" ref="dba4944c66dd108992af2cb507665c0e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$User = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#8fdef8f95533ba674b187b5e272fdba2">Apache</a>, <a class="el" href="classClamd.html#88231550dd7a194dde69f9797483e327">Clamd</a>, <a class="el" href="classDansguardian.html#08fe60c69059e4389c9160101aede888">Dansguardian</a>, <a class="el" href="classDante.html#e657f881501388dc7d8e9001f80dad70">Dante</a>, <a class="el" href="classDhcpd.html#8212c5868545bc048244a811e32a0284">Dhcpd</a>, <a class="el" href="classFreshclam.html#5805a6c79f7a8e2ddbd665b11af2bccc">Freshclam</a>, <a class="el" href="classFtpproxy.html#4e9d764bcf8ca7b5d594a9eb89037d62">Ftpproxy</a>, <a class="el" href="classImspector.html#42f00a51fdf7760d990f8e80a182185a">Imspector</a>, <a class="el" href="classNamed.html#42b26f1691389caa2ec37ac1444fde04">Named</a>, <a class="el" href="classOpenssh.html#19117c4d7cee7746a0b020bd22476d3e">Openssh</a>, <a class="el" href="classOpenvpn.html#c899929497fca169cb982baea2ea8bca">Openvpn</a>, <a class="el" href="classP3scan.html#bfa15f4e6f313728b61094efd97e062c">P3scan</a>, <a class="el" href="classPmacct.html#af233766fb5da618677fccf5184c30b6">Pmacct</a>, <a class="el" href="classSmtpgated.html#840cda8a900ce107b2bfc67f39a37f86">Smtpgated</a>, <a class="el" href="classSnort.html#16554bdff70bd2f2a6f3afd3b92eb533">Snort</a>, <a class="el" href="classSnortips.html#b86365766a77acc35e3ed40bf59fb0f3">Snortips</a>, <a class="el" href="classSpamassassin.html#4fddb0be5c5d337369281e5387eccf97">Spamassassin</a>, <a class="el" href="classSpamd.html#fe072bb7790222c87df432264d275e5a">Spamd</a>, <a class="el" href="classSquid.html#440f4f7fb8e58c693a963228275a87c6">Squid</a>, <a class="el" href="classSymon.html#31960f0692416ed37d4a012501eeaaca">Symon</a>, <a class="el" href="classSymux.html#ef9e5dd6e1326e081cf1ce886071c072">Symux</a>, and <a class="el" href="classSystem.html#a0f8f1f890a6067cb6e08c8ad7e0d6bf">System</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00043">43</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="5e090e5f9335929f5d55d6b1d7a631af"></a><!-- doxytag: member="Model::$Proc" ref="5e090e5f9335929f5d55d6b1d7a631af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$Proc = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="attention" compact><dt><b>Attention:</b></dt><dd>Should be updated in constructors of children </dd></dl>

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00046">46</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="79553c4d5567284cae411eb24f02fb62"></a><!-- doxytag: member="Model::$NVPS" ref="79553c4d5567284cae411eb24f02fb62" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$NVPS = '='          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#b69c86c55894e53fc5fb4d68c979c309">Apache</a>, <a class="el" href="classClamd.html#cc7d652354e72e45e3e84a1ce48401d4">Clamd</a>, <a class="el" href="classDansguardian.html#4551e4977d2c87a50109318e75d03eac">Dansguardian</a>, <a class="el" href="classFreshclam.html#9340f222b3610ff5898ff2018e45ddaa">Freshclam</a>, <a class="el" href="classOpenssh.html#e8e1fc9041092e32490c8f97cbb06b27">Openssh</a>, <a class="el" href="classOpenvpn.html#a2f59dffc4a2dff0b9bfcfcd479fc767">Openvpn</a>, <a class="el" href="classP3scan.html#c7ccdb0ee6ab721a5c4440b388390dab">P3scan</a>, <a class="el" href="classPf.html#9dada26c5faa6122f4ecbf912c0f3363">Pf</a>, <a class="el" href="classSmtpgated.html#c314f116ddc954845a04bf4875d96379">Smtpgated</a>, <a class="el" href="classSnort.html#f28312cf50bb17dd246b0ead2d858dc1">Snort</a>, <a class="el" href="classSnortips.html#115b0b5d194575dddeebbe7d32763a46">Snortips</a>, <a class="el" href="classSpamassassin.html#5a07855499da2e03d97307b0b19fe346">Spamassassin</a>, and <a class="el" href="classSquid.html#a4aade958f7ad602d0f35fe85e132d30">Squid</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00048">48</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="c89bbfa238d98b1caade5ce37a974d35"></a><!-- doxytag: member="Model::$COMC" ref="c89bbfa238d98b1caade5ce37a974d35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$COMC = '#'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00049">49</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="ffbf15b1c593584d9fc04185d70670d8"></a><!-- doxytag: member="Model::$ConfFile" ref="ffbf15b1c593584d9fc04185d70670d8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$ConfFile = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#8bf69821e7ada208d93a4a42e0cc42c1">Apache</a>, <a class="el" href="classClamd.html#601a05fffd3a1ed9fc92e2d69686fd3a">Clamd</a>, <a class="el" href="classDansguardian.html#8dd2c349b9b85f4e08ea905854dbabbb">Dansguardian</a>, <a class="el" href="classDante.html#cae3ea05e708e50de674c6e81476a845">Dante</a>, <a class="el" href="classDhcpd.html#7e1f0db31d1779535ed8725037cd966e">Dhcpd</a>, <a class="el" href="classFreshclam.html#a2a84c5b684c7ccb1cdf0c39d82af844">Freshclam</a>, <a class="el" href="classImspector.html#7bca53848b39eec8dbf7a430c62fe015">Imspector</a>, <a class="el" href="classNamed.html#65d269d69d7a2f77c693e250a45a6a71">Named</a>, <a class="el" href="classOpenssh.html#f2f20cbe8d1f00a662cdb07049734639">Openssh</a>, <a class="el" href="classP3scan.html#0e9d9dd69e8cef7044e3b7c5e7143afd">P3scan</a>, <a class="el" href="classPf.html#46fda7c181ba04c6cfcd14eacdebdaec">Pf</a>, <a class="el" href="classSmtpgated.html#ffb0a48d27996b08501f31f17ff95b72">Smtpgated</a>, <a class="el" href="classSnort.html#9a7ce6991e09922f8ab251be5c58e339">Snort</a>, <a class="el" href="classSnortips.html#ad3ea84e052bfcefc9f926dae1c3c424">Snortips</a>, <a class="el" href="classSpamassassin.html#e2c2207ecbb0665a8c3b0cf1fa2753d6">Spamassassin</a>, and <a class="el" href="classSquid.html#4d148749fa30907e90036e532e2395e7">Squid</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00050">50</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="7829b0e83a1ea86feed9cc9c7991c6ee"></a><!-- doxytag: member="Model::$Config" ref="7829b0e83a1ea86feed9cc9c7991c6ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$<a class="el" href="snort_2conf_8php.html#2bd9cf561282f599025ff7907d78f427">Config</a> = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00051">51</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="13a81d956649e70801f3f3a1781df1ab"></a><!-- doxytag: member="Model::$LogFile" ref="13a81d956649e70801f3f3a1781df1ab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$LogFile = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#fe01aa85ca55dc2c29f2523abb0dce78">Apache</a>, <a class="el" href="classApachelogs.html#f6126a5b3bab3dcda4296803b0f5d995">Apachelogs</a>, <a class="el" href="classBlacklists.html#caa72f2081892df8b2ce1b8ccdbbdd78">Blacklists</a>, <a class="el" href="classClamd.html#b3232cb84d403273dc2d2fe8c6061cc2">Clamd</a>, <a class="el" href="classCwc.html#92638e95a5d6a3d74c666b85faf46162">Cwc</a>, <a class="el" href="classCwwui.html#3da6b416b1744c4f30b4499783a1a50e">Cwwui</a>, <a class="el" href="classDansguardian.html#8ebfb81216f8268a9c6eb9608f723e84">Dansguardian</a>, <a class="el" href="classDansguardianlogs.html#4986aaa7642e2312b9796a8130c6b193">Dansguardianlogs</a>, <a class="el" href="classDante.html#5b0cc7ef7a2289e6f781d3dfa1532aa8">Dante</a>, <a class="el" href="classDhcpd.html#08fac733c6f56c0427b2fe4ba5863e8e">Dhcpd</a>, <a class="el" href="classDocs.html#69826fba1dcc182854f93b8b61dde6b1">Docs</a>, <a class="el" href="classFreshclam.html#15aebfc16e1d8045664098e967da7298">Freshclam</a>, <a class="el" href="classFtpproxy.html#50af80db9eda9c44d5624423585f5301">Ftpproxy</a>, <a class="el" href="classImspector.html#f9501be968bcfe05ad52f6aee4600b64">Imspector</a>, <a class="el" href="classMonitoring.html#bd84849134ad5fe71e2934814c1e6f46">Monitoring</a>, <a class="el" href="classNamed.html#a73fa2d706b026b32470f03dbde07529">Named</a>, <a class="el" href="classOpenssh.html#9077ca04acfe7d7c3afdeca855c295fa">Openssh</a>, <a class="el" href="classOpenvpn.html#981d3b61d553bc3d1b93931c2b21598c">Openvpn</a>, <a class="el" href="classP3scan.html#7771d84ad94060dd1f566cb8a1bf1d07">P3scan</a>, <a class="el" href="classPf.html#3304f0ddbb27a80367aa415b8764f9e1">Pf</a>, <a class="el" href="classSmtpgated.html#9d90be20e53a8a5fd4002e05bc90328b">Smtpgated</a>, <a class="el" href="classSnort.html#179a76e6e230d62ffffc473651298e46">Snort</a>, <a class="el" href="classSnortalerts.html#6b1e130857d20038772565cc55915a25">Snortalerts</a>, <a class="el" href="classSnortips.html#3eef29e66f38e908c10186ab4b0ff5bb">Snortips</a>, <a class="el" href="classSpamassassin.html#2678cdc06361b3087c490b8eac76ebc3">Spamassassin</a>, <a class="el" href="classSpamd.html#ea79aa08ee3916bffdb899434c1f7959">Spamd</a>, <a class="el" href="classSquid.html#6c23c1627146d714b82dacdec6e3ef97">Squid</a>, and <a class="el" href="classSystem.html#040bd462def858a0fbb20d16fd6e4df8">System</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00053">53</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="ff07a2406d3ec8292cbba44852e4ee6e"></a><!-- doxytag: member="Model::$psCmd" ref="ff07a2406d3ec8292cbba44852e4ee6e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$psCmd = '/bin/ps arwwx -o pid,start,%cpu,time,%mem,rss,vsz,stat,pri,nice,tty,user,group,command | /usr/bin/grep -E &lt;PROC&gt;'<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00055">55</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="3ba349aefdae544f17c56d9c3a1c5039"></a><!-- doxytag: member="Model::PROC_STAT_TIMEOUT" ref="3ba349aefdae544f17c56d9c3a1c5039" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classModel.html#3ba349aefdae544f17c56d9c3a1c5039">Model::PROC_STAT_TIMEOUT</a> = 100          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Max number of iterations to try while starting or stopping processes. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00058">58</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="f3d21f5d44702b4acc73ecf8b03ce61c"></a><!-- doxytag: member="Model::$passwdFile" ref="f3d21f5d44702b4acc73ecf8b03ce61c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$passwdFile = '/var/www/conf/.htpasswd'<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="classApache.html">Apache</a> password file pathname. 
<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00063">63</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="8abff66b55e247f682f88c00e8f672a1"></a><!-- doxytag: member="Model::$CmdLogStart" ref="8abff66b55e247f682f88c00e8f672a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$CmdLogStart = '/usr/bin/head -1 &lt;LF&gt;'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00065">65</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="40a24e5aafaaedbcfec96fabe72948c0"></a><!-- doxytag: member="Model::$VersionCmd" ref="40a24e5aafaaedbcfec96fabe72948c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$VersionCmd = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classApache.html#022b0b73b1569fa557502914557b89fd">Apache</a>, <a class="el" href="classClamd.html#80d860df435030d83f5ad80051b38fae">Clamd</a>, <a class="el" href="classDansguardian.html#1e22467754c33e9cbfaaf3f6592ffe80">Dansguardian</a>, <a class="el" href="classDante.html#053a2393d4bc3805991fac36aab51182">Dante</a>, <a class="el" href="classNamed.html#cf6f6b4d8def42d82490d516a86efdcd">Named</a>, <a class="el" href="classOpenssh.html#012669b5fd715707e9a2d147a8836592">Openssh</a>, <a class="el" href="classOpenvpn.html#4be55d75f498e6b24d536462405d89cd">Openvpn</a>, <a class="el" href="classP3scan.html#0164c1d9c4ca1df73fafb7ea570e68cd">P3scan</a>, <a class="el" href="classPmacct.html#1173be0614ed4ec1eaee7e19cbcaa4b7">Pmacct</a>, <a class="el" href="classSmtpgated.html#8be21d39d8c4d12d0089a14b59e3cf05">Smtpgated</a>, <a class="el" href="classSnort.html#d267cb9261e831a75b292d6d728d1fb5">Snort</a>, <a class="el" href="classSnortips.html#2a23abcd38f9f74f2eb1a779c1979f73">Snortips</a>, <a class="el" href="classSpamassassin.html#df38986ee4bd4e0eb1d596b31576ac56">Spamassassin</a>, <a class="el" href="classSquid.html#122df76e259bfa8c4c27f59faa8c1b36">Squid</a>, <a class="el" href="classSymon.html#c1eca2991623e3436cbccc410db39717">Symon</a>, and <a class="el" href="classSymux.html#391089477303ca970b3408ac7c45dfcd">Symux</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00067">67</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="ab3d4a12e5551e969b1b6a0e41963cd0"></a><!-- doxytag: member="Model::$StartCmd" ref="ab3d4a12e5551e969b1b6a0e41963cd0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$StartCmd = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classSpamassassin.html#f712a23f026c233694a806a9a72500b1">Spamassassin</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00069">69</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="4dc0ebdad4164197e5e8f30f1befea10"></a><!-- doxytag: member="Model::$PidFile" ref="4dc0ebdad4164197e5e8f30f1befea10" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$PidFile = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented in <a class="el" href="classClamd.html#f8915cf2cd9a0c4ad01624629e9fd38e">Clamd</a>, <a class="el" href="classDansguardian.html#eb1157e81c12174abd370ebd40fbe000">Dansguardian</a>, <a class="el" href="classDante.html#27ddfbaca16380572bab8a94211809a3">Dante</a>, <a class="el" href="classFreshclam.html#115b712f949332549bce86f7079faf9b">Freshclam</a>, <a class="el" href="classImspector.html#39c673810380be687d5ea093df503f08">Imspector</a>, <a class="el" href="classNamed.html#fb7e40eb1705bac026d805df609bf022">Named</a>, <a class="el" href="classOpenssh.html#2b925601aa5365f309518f515122ccd0">Openssh</a>, <a class="el" href="classP3scan.html#05ea2c9021a2a5d6d08fafc23e78e6b3">P3scan</a>, <a class="el" href="classSmtpgated.html#eb9ce26a99c4c577fa7d7a7d5ab8dd39">Smtpgated</a>, <a class="el" href="classSnortips.html#0372705da0b2221044b8991d1e29faad">Snortips</a>, <a class="el" href="classSpamassassin.html#5bc18f14d4f3298f7868d715fa59a5c7">Spamassassin</a>, and <a class="el" href="classSquid.html#908734ce79fc3f895c5c56e01cca4604">Squid</a>.</p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00070">70</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="679e45c31619091fa5373874a18d201b"></a><!-- doxytag: member="Model::$TmpLogsDir" ref="679e45c31619091fa5373874a18d201b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$TmpLogsDir = ''          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00072">72</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="ac4f5362135543524c2c4012aaa55630"></a><!-- doxytag: member="Model::$newSyslogConf" ref="ac4f5362135543524c2c4012aaa55630" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$newSyslogConf = '/etc/newsyslog.conf'<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00074">74</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="2696bf46a626c73cf6952b40ac5fcea5"></a><!-- doxytag: member="Model::$rcConfLocal" ref="2696bf46a626c73cf6952b40ac5fcea5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$rcConfLocal = '/etc/rc.conf.local'<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00075">75</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="3234e8f3250cb93c8ec12a31d6557dc7"></a><!-- doxytag: member="Model::$PfRulesFile" ref="3234e8f3250cb93c8ec12a31d6557dc7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$PfRulesFile = '/etc/pf.conf'          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="model_8php-source.html#l00078">78</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="06e22b4cd51d43fdd86c29712451b18e"></a><!-- doxytag: member="Model::$Commands" ref="06e22b4cd51d43fdd86c29712451b18e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Model::$Commands = array()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Argument lists and descriptions of commands. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>argv</em>&nbsp;</td><td>Array of arg types in order </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>desc</em>&nbsp;</td><td>Description of the shell function</td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd>$Commands should be implemented with Interfaces in OOP? </dd></dl>

<p>Definition at line <a class="el" href="model_8php-source.html#l00087">87</a> of file <a class="el" href="model_8php-source.html">model.php</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>Model/<a class="el" href="model_8php-source.html">model.php</a></ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Dec 8 14:11:27 2009 for ComixWall ISG Administration Interface by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
