<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ComixWall ISG Administration Interface: options Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li class="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>options Class Reference</h1><!-- doxytag: class="options" --><!-- doxytag: inherits="rules" --><div class="dynheader">
Inheritance diagram for options:</div>
<div class="dynsection">
<p><center><img src="classoptions__inherit__graph.png" border="0" usemap="#options__inherit__map" alt="Inheritance graph"></center>
<map name="options__inherit__map">
<area shape="rect" href="classrules.html" title="pfw&#39;s parent rule class." alt="" coords="13,7,64,33"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>
<div class="dynheader">
Collaboration diagram for options:</div>
<div class="dynsection">
<p><center><img src="classoptions__coll__graph.png" border="0" usemap="#options__coll__map" alt="Collaboration graph"></center>
<map name="options__coll__map">
<area shape="rect" href="classrules.html" title="pfw&#39;s parent rule class." alt="" coords="13,7,64,33"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classoptions-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoptions.html#b9551aa21295c9b5915a765f2411b132">parse</a> ($rule_string)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoptions.html#db09825676c833fdc21f7d7d83f602e2">generate</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoptions.html#8a0893c2f86a83a25e25c6e4b49a5439">addComment</a> ($comment=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a comment-rule to the ruleset.  <a href="#8a0893c2f86a83a25e25c6e4b49a5439"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a> = array()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="options_8class_8php-source.html#l00034">34</a> of file <a class="el" href="options_8class_8php-source.html">options.class.php</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b9551aa21295c9b5915a765f2411b132"></a><!-- doxytag: member="options::parse" ref="b9551aa21295c9b5915a765f2411b132" args="($rule_string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">options::parse           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>rule_string</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="options_8class_8php-source.html#l00038">38</a> of file <a class="el" href="options_8class_8php-source.html">options.class.php</a>.</p>

<p>References <a class="el" href="altqedit_8php-source.html#l00037">$rule</a>, <a class="el" href="options_8class_8php-source.html#l00036">$rules</a>, and <a class="el" href="rules_8class_8php-source.html#l00217">rules::parseItem()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00039"></a>00039     {
<a name="l00040"></a>00040         $data = array();
<a name="l00041"></a>00041         <span class="keywordflow">if</span> (strpos($rule_string, <span class="stringliteral">"#"</span>)) {
<a name="l00042"></a>00042             $data['comment'] = substr($rule_string, strpos($rule_string, <span class="stringliteral">"#"</span>) + <span class="charliteral">'1'</span>);
<a name="l00043"></a>00043             $rule_string =  substr($rule_string, <span class="charliteral">'0'</span>, strpos($rule_string, <span class="charliteral">'#'</span>));
<a name="l00044"></a>00044         }
<a name="l00045"></a>00045 
<a name="l00046"></a>00046         <span class="comment">/*</span>
<a name="l00047"></a>00047 <span class="comment">         * Sanitize the rule string so that we can deal with '{foo' as '{ foo' in </span>
<a name="l00048"></a>00048 <span class="comment">         * the code further down without any special treatment</span>
<a name="l00049"></a>00049 <span class="comment">         */</span>
<a name="l00050"></a>00050         $rule_string = preg_replace(<span class="stringliteral">"/{/"</span>, <span class="stringliteral">" { "</span>,   $rule_string);
<a name="l00051"></a>00051         $rule_string = preg_replace(<span class="stringliteral">"/}/"</span>, <span class="stringliteral">" } "</span>,   $rule_string);
<a name="l00052"></a>00052         $rule_string = preg_replace(<span class="stringliteral">"/\(/"</span>, <span class="stringliteral">" \( "</span>, $rule_string);
<a name="l00053"></a>00053         $rule_string = preg_replace(<span class="stringliteral">"/\)/"</span>, <span class="stringliteral">" \) "</span>, $rule_string);
<a name="l00054"></a>00054         $rule_string = preg_replace(<span class="stringliteral">"/,/"</span>, <span class="stringliteral">" , "</span>,   $rule_string);
<a name="l00055"></a>00055         $rule_string = preg_replace(<span class="stringliteral">"/\"/"</span>, <span class="stringliteral">" \" "</span>, $rule_string);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057         <span class="comment">/*</span>
<a name="l00058"></a>00058 <span class="comment">        * Need to handle fingerprints differently since we're</span>
<a name="l00059"></a>00059 <span class="comment">        * expecting a dot (.) in the filename</span>
<a name="l00060"></a>00060 <span class="comment">        */</span>
<a name="l00061"></a>00061         <span class="keywordflow">foreach</span> (preg_split(<span class="stringliteral">"/[\s,\t]+/"</span>, $rule_string) as <a class="code" href="altqedit_8php.html#85b0fb17593555da65ddd33db4ad8444">$rule</a>) {
<a name="l00062"></a>00062             <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[] = $rule;
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     <span class="comment">// Currently, there's some weird thing going on where everything</span>
<a name="l00066"></a>00066     <span class="comment">// works if there's parsing of this twice (see above) but things</span>
<a name="l00067"></a>00067     <span class="comment">// break if either is removed.</span>
<a name="l00068"></a>00068         <span class="keywordflow">foreach</span> (preg_split(<span class="stringliteral">"/[\s,\t.]+/"</span>, $rule_string) as $rule) {
<a name="l00069"></a>00069             <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[] = $rule;
<a name="l00070"></a>00070         }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072         <span class="keywordflow">for</span> ($i = <span class="charliteral">'0'</span>; $i &lt; count(<a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>); $i++) {
<a name="l00073"></a>00073             <span class="keywordflow">switch</span> (<a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[$i]) {
<a name="l00074"></a>00074             <span class="keywordflow">case</span> <span class="stringliteral">"timeout"</span>:
<a name="l00075"></a>00075                 <span class="keywordflow">break</span>;
<a name="l00076"></a>00076             <span class="keywordflow">case</span> <span class="stringliteral">"loginterface"</span>:
<a name="l00077"></a>00077                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['loginterface'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i];
<a name="l00078"></a>00078                 <span class="keywordflow">break</span>;
<a name="l00079"></a>00079             <span class="keywordflow">case</span> <span class="stringliteral">"block-policy"</span>:
<a name="l00080"></a>00080                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['block-policy'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i];
<a name="l00081"></a>00081                 <span class="keywordflow">break</span>;
<a name="l00082"></a>00082             <span class="keywordflow">case</span> <span class="stringliteral">"state-policy"</span>:
<a name="l00083"></a>00083                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['state-policy'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i];
<a name="l00084"></a>00084                 <span class="keywordflow">break</span>;
<a name="l00085"></a>00085             <span class="keywordflow">case</span> <span class="stringliteral">"require-order"</span>:
<a name="l00086"></a>00086                 <span class="comment">// This really does not makes sense for a web based interface</span>
<a name="l00087"></a>00087                 <span class="comment">// Instead, we'll bring order to chaos so don't parse this</span>
<a name="l00088"></a>00088                 <span class="keywordflow">break</span>;
<a name="l00089"></a>00089             <span class="keywordflow">case</span> <span class="stringliteral">"fingerprints"</span>:
<a name="l00090"></a>00090                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['fingerprints'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[<span class="charliteral">'3'</span>];
<a name="l00091"></a>00091                 <span class="keywordflow">break</span>;
<a name="l00092"></a>00092             <span class="keywordflow">case</span> <span class="stringliteral">"optimization"</span>:
<a name="l00093"></a>00093                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['optimization'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i];
<a name="l00094"></a>00094                 <span class="keywordflow">break</span>;
<a name="l00095"></a>00095             <span class="keywordflow">case</span> <span class="stringliteral">"debug"</span>:
<a name="l00096"></a>00096                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['debug'] = <a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i];
<a name="l00097"></a>00097                 <span class="keywordflow">break</span>;
<a name="l00098"></a>00098             <span class="keywordflow">case</span> <span class="stringliteral">"tcp"</span>:
<a name="l00099"></a>00099             <span class="keywordflow">case</span> <span class="stringliteral">"udp"</span>:
<a name="l00100"></a>00100             <span class="keywordflow">case</span> <span class="stringliteral">"icmp"</span>:
<a name="l00101"></a>00101             <span class="keywordflow">case</span> <span class="stringliteral">"other"</span>:
<a name="l00102"></a>00102                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>[<a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[$i]][<a class="code" href="classoptions.html#2c5a2449b12e35ca74ce95a9cd23e015">$rules</a>[++$i]] = $rules[++$i];
<a name="l00103"></a>00103                 <span class="keywordflow">break</span>;
<a name="l00104"></a>00104             <span class="keywordflow">case</span> <span class="stringliteral">"states"</span>:
<a name="l00105"></a>00105                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['states'] = $rules[++$i];
<a name="l00106"></a>00106                 <span class="keywordflow">break</span>;
<a name="l00107"></a>00107             <span class="keywordflow">case</span> <span class="stringliteral">"frags"</span>:
<a name="l00108"></a>00108                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['frags'] = $rules[++$i];
<a name="l00109"></a>00109                 <span class="keywordflow">break</span>;
<a name="l00110"></a>00110             <span class="keywordflow">case</span> <span class="stringliteral">"src-nodes"</span>:
<a name="l00111"></a>00111                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['src-nodes'] = $rules[++$i];
<a name="l00112"></a>00112                 <span class="keywordflow">break</span>;
<a name="l00113"></a>00113             <span class="keywordflow">case</span> <span class="stringliteral">"start"</span>:
<a name="l00114"></a>00114                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['start'] = $rules[++$i];
<a name="l00115"></a>00115                 <span class="keywordflow">break</span>;
<a name="l00116"></a>00116             <span class="keywordflow">case</span> <span class="stringliteral">"end"</span>:
<a name="l00117"></a>00117                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['end'] = $rules[++$i];
<a name="l00118"></a>00118                 <span class="keywordflow">break</span>;
<a name="l00119"></a>00119             <span class="keywordflow">case</span> <span class="stringliteral">"tables"</span>:
<a name="l00120"></a>00120               $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tables'] = $rules[++$i];
<a name="l00121"></a>00121               <span class="keywordflow">break</span>;
<a name="l00122"></a>00122             <span class="keywordflow">case</span> <span class="stringliteral">"table-entries"</span>:
<a name="l00123"></a>00123               $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['table_entries'] = $rules[++$i];
<a name="l00124"></a>00124               <span class="keywordflow">break</span>;
<a name="l00125"></a>00125             <span class="keywordflow">case</span> <span class="stringliteral">"skip"</span>:
<a name="l00126"></a>00126               list($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['skip'], $i) = $this-&gt;<a class="code" href="classrules.html#24924dce39632d9693586001475059b6">parseItem</a>($rules, ++$i);
<a name="l00127"></a>00127               <span class="keywordflow">break</span>;
<a name="l00128"></a>00128             }
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130     }
</pre></div>
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="classoptions_b9551aa21295c9b5915a765f2411b132_cgraph.png" border="0" usemap="#classoptions_b9551aa21295c9b5915a765f2411b132_cgraph_map" alt=""></center>
<map name="classoptions_b9551aa21295c9b5915a765f2411b132_cgraph_map">
<area shape="rect" href="classrules.html#24924dce39632d9693586001475059b6" title="rules::parseItem" alt="" coords="167,5,292,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="db09825676c833fdc21f7d7d83f602e2"></a><!-- doxytag: member="options::generate" ref="db09825676c833fdc21f7d7d83f602e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">options::generate           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="options_8class_8php-source.html#l00132">132</a> of file <a class="el" href="options_8class_8php-source.html">options.class.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00133"></a>00133     {
<a name="l00134"></a>00134         $data = <span class="stringliteral">""</span>;
<a name="l00135"></a>00135         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>) {
<a name="l00136"></a>00136             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['comment']) {
<a name="l00137"></a>00137                 $lines = preg_split(<span class="stringliteral">"/\n/"</span>, stripslashes($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['comment']));
<a name="l00138"></a>00138                 $data .= <span class="stringliteral">"\n"</span>;
<a name="l00139"></a>00139                 <span class="keywordflow">foreach</span> ($lines as $line) {
<a name="l00140"></a>00140                     $data .= <span class="stringliteral">"# "</span>. $line. <span class="stringliteral">"\n"</span>;
<a name="l00141"></a>00141                 }
<a name="l00142"></a>00142             }
<a name="l00143"></a>00143             <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tcp'])) {
<a name="l00144"></a>00144                 <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tcp']) == <span class="charliteral">'1'</span>) {
<a name="l00145"></a>00145                     list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tcp']);
<a name="l00146"></a>00146                     $data .= <span class="stringliteral">"set timeout tcp.$key $val\n"</span>;
<a name="l00147"></a>00147                 } <span class="keywordflow">else</span> {
<a name="l00148"></a>00148                     $data .= <span class="stringliteral">"set timeout {"</span>;
<a name="l00149"></a>00149                     <span class="keywordflow">while</span> (list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tcp'])) {
<a name="l00150"></a>00150                         $data .= <span class="stringliteral">" tcp.$key $val,"</span>;
<a name="l00151"></a>00151                     }
<a name="l00152"></a>00152                     $data = rtrim($data, <span class="stringliteral">", "</span>);
<a name="l00153"></a>00153                     $data .= <span class="stringliteral">" }\n"</span>;
<a name="l00154"></a>00154                 }
<a name="l00155"></a>00155             }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157             <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['udp'])) {
<a name="l00158"></a>00158                 <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['udp']) == <span class="charliteral">'1'</span>) {
<a name="l00159"></a>00159                     list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['udp']);
<a name="l00160"></a>00160                     $data .= <span class="stringliteral">"set timeout udp.$key $val\n"</span>;
<a name="l00161"></a>00161                 } <span class="keywordflow">else</span> {
<a name="l00162"></a>00162                     $data .= <span class="stringliteral">"set timeout {"</span>;
<a name="l00163"></a>00163                     <span class="keywordflow">while</span> (list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['udp'])) {
<a name="l00164"></a>00164                         $data .= <span class="stringliteral">" udp.$key $val,"</span>;
<a name="l00165"></a>00165                     }
<a name="l00166"></a>00166                     $data = rtrim($data, <span class="stringliteral">", "</span>);
<a name="l00167"></a>00167                     $data .= <span class="stringliteral">" }\n"</span>;
<a name="l00168"></a>00168                 }
<a name="l00169"></a>00169             }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171             <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['icmp'])) {
<a name="l00172"></a>00172                 <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['icmp']) == <span class="charliteral">'1'</span>) {
<a name="l00173"></a>00173                     list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['icmp']);
<a name="l00174"></a>00174                     $data .= <span class="stringliteral">"set timeout icmp.$key $val\n"</span>;
<a name="l00175"></a>00175                 } <span class="keywordflow">else</span> {
<a name="l00176"></a>00176                     $data .= <span class="stringliteral">"set timeout {"</span>;
<a name="l00177"></a>00177                     <span class="keywordflow">while</span> (list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['icmp'])) {
<a name="l00178"></a>00178                         $data .= <span class="stringliteral">" icmp.$key $val,"</span>;
<a name="l00179"></a>00179                     }
<a name="l00180"></a>00180                     $data = rtrim($data, <span class="stringliteral">", "</span>);
<a name="l00181"></a>00181                     $data .= <span class="stringliteral">" }\n"</span>;
<a name="l00182"></a>00182                 }
<a name="l00183"></a>00183             }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 
<a name="l00186"></a>00186             <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['other'])) {
<a name="l00187"></a>00187                 <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['other']) == <span class="charliteral">'1'</span>) {
<a name="l00188"></a>00188                     list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['other']);
<a name="l00189"></a>00189                     $data .= <span class="stringliteral">"set timeout other.$key $val\n"</span>;
<a name="l00190"></a>00190                 } <span class="keywordflow">else</span> {
<a name="l00191"></a>00191                     $data .= <span class="stringliteral">"set timeout {"</span>;
<a name="l00192"></a>00192                     <span class="keywordflow">while</span> (list($key,$val) = each ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['other'])) {
<a name="l00193"></a>00193                         $data .= <span class="stringliteral">" other.$key $val,"</span>;
<a name="l00194"></a>00194                     }
<a name="l00195"></a>00195                     $data = rtrim($data, <span class="stringliteral">", "</span>);
<a name="l00196"></a>00196                     $data .= <span class="stringliteral">" }\n"</span>;
<a name="l00197"></a>00197                 }
<a name="l00198"></a>00198             }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['loginterface']) {
<a name="l00201"></a>00201                 $data .= <span class="stringliteral">"set loginterface "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['loginterface']. <span class="stringliteral">"\n"</span>;
<a name="l00202"></a>00202             }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['optimization']) {
<a name="l00205"></a>00205                 $data .= <span class="stringliteral">"set optimization "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['optimization']. <span class="stringliteral">"\n"</span>;
<a name="l00206"></a>00206             }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['block-policy']) {
<a name="l00209"></a>00209                 $data .= <span class="stringliteral">"set block-policy "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['block-policy']. <span class="stringliteral">"\n"</span>;
<a name="l00210"></a>00210             }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['state-policy']) {
<a name="l00213"></a>00213                 $data .= <span class="stringliteral">"set state-policy "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['state-policy']. <span class="stringliteral">"\n"</span>;
<a name="l00214"></a>00214             }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['debug']) {
<a name="l00217"></a>00217                 $data .= <span class="stringliteral">"set debug "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['debug']. <span class="stringliteral">"\n"</span>;
<a name="l00218"></a>00218             }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['fingerprints']) {
<a name="l00221"></a>00221                 $data .= <span class="stringliteral">"set fingerprints \""</span>. preg_replace(<span class="stringliteral">"/\"/"</span>, <span class="stringliteral">""</span>, $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['fingerprints']). <span class="stringliteral">"\"\n"</span>;
<a name="l00222"></a>00222             }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['states']) {
<a name="l00225"></a>00225                 $data .= <span class="stringliteral">"set limit states "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['states']. <span class="stringliteral">"\n"</span>;
<a name="l00226"></a>00226             }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['frags']) {
<a name="l00229"></a>00229                 $data .= <span class="stringliteral">"set limit frags "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['frags']. <span class="stringliteral">"\n"</span>;
<a name="l00230"></a>00230             }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['src-nodes']) {
<a name="l00233"></a>00233                 $data .= <span class="stringliteral">"set limit src-nodes "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['src-nodes']. <span class="stringliteral">"\n"</span>;
<a name="l00234"></a>00234             }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['start']) {
<a name="l00237"></a>00237                 $data .= <span class="stringliteral">"set adaptive.start "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['start']. <span class="stringliteral">"\n"</span>;
<a name="l00238"></a>00238             }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['end']) {
<a name="l00241"></a>00241                 $data .= <span class="stringliteral">"set adaptive.end "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['adaptive']['end']. <span class="stringliteral">"\n"</span>;
<a name="l00242"></a>00242             }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tables']) {
<a name="l00245"></a>00245                 $data .= <span class="stringliteral">"set limit tables "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['tables']. <span class="stringliteral">"\n"</span>;
<a name="l00246"></a>00246             }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['table_entries']) {
<a name="l00249"></a>00249                 $data .= <span class="stringliteral">"set limit table-entries "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['table_entries']. <span class="stringliteral">"\n"</span>;
<a name="l00250"></a>00250             }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['skip']) {
<a name="l00253"></a>00253         <span class="keywordflow">if</span> (!is_array($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['skip'])) {
<a name="l00254"></a>00254             $data .= <span class="stringliteral">"set skip on "</span>. $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['skip']. <span class="stringliteral">"\n"</span>;
<a name="l00255"></a>00255         } <span class="keywordflow">else</span> {
<a name="l00256"></a>00256             $data .= <span class="stringliteral">"set skip on { "</span>;
<a name="l00257"></a>00257             <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['skip'] as $skip) {
<a name="l00258"></a>00258                 $data .= $skip. <span class="stringliteral">" "</span>;
<a name="l00259"></a>00259             }
<a name="l00260"></a>00260             $data = rtrim($data, <span class="stringliteral">" ,"</span>);
<a name="l00261"></a>00261             $data .= <span class="stringliteral">" }\n"</span>;
<a name="l00262"></a>00262         }          
<a name="l00263"></a>00263       }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 
<a name="l00266"></a>00266             <span class="comment">// This really does not makes sense for a web based interface</span>
<a name="l00267"></a>00267             <span class="comment">//</span>
<a name="l00268"></a>00268             <span class="comment">// if (isset($this-&gt;rules['require-order'])) {</span>
<a name="l00269"></a>00269             <span class="comment">//  $data .= "set require-order "</span>
<a name="l00270"></a>00270             <span class="comment">//  if ($this-&gt;rules['require-order']) {</span>
<a name="l00271"></a>00271             <span class="comment">//      $data .= "yes\n";</span>
<a name="l00272"></a>00272             <span class="comment">// } else {</span>
<a name="l00273"></a>00273             <span class="comment">//      $data .= "no\n";</span>
<a name="l00274"></a>00274             <span class="comment">// }</span>
<a name="l00275"></a>00275             <span class="comment">//}     </span>
<a name="l00276"></a>00276             $data .= <span class="stringliteral">"\n"</span>;
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         <span class="keywordflow">return</span> $data;
<a name="l00279"></a>00279     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8a0893c2f86a83a25e25c6e4b49a5439"></a><!-- doxytag: member="options::addComment" ref="8a0893c2f86a83a25e25c6e4b49a5439" args="($comment=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">options::addComment           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>comment</em> = <code>false</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a comment-rule to the ruleset. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$comment The comment to be added. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Reimplemented from <a class="el" href="classrules.html#f81dabfbd8372c1d2e28f48cbb2d7454">rules</a>.</p>

<p>Definition at line <a class="el" href="options_8class_8php-source.html#l00281">281</a> of file <a class="el" href="options_8class_8php-source.html">options.class.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00282"></a>00282     {
<a name="l00283"></a>00283         <span class="keywordflow">if</span> ($comment) {
<a name="l00284"></a>00284             <span class="keywordflow">if</span> (isset($this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['comment'])) {
<a name="l00285"></a>00285                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['comment'] .= <span class="stringliteral">"\n"</span>. $comment;
<a name="l00286"></a>00286             } <span class="keywordflow">else</span> {
<a name="l00287"></a>00287                 $this-&gt;<a class="code" href="classrules.html" title="pfw&amp;#39;s parent rule class.">rules</a>['comment'] = $comment;
<a name="l00288"></a>00288             }
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="2c5a2449b12e35ca74ce95a9cd23e015"></a><!-- doxytag: member="options::$rules" ref="2c5a2449b12e35ca74ce95a9cd23e015" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">options::$<a class="el" href="classrules.html">rules</a> = array()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented from <a class="el" href="classrules.html#f844ce79d751573a3cfb4e6467667d35">rules</a>.</p>

<p>Definition at line <a class="el" href="options_8class_8php-source.html#l00036">36</a> of file <a class="el" href="options_8class_8php-source.html">options.class.php</a>.</p>

<p>Referenced by <a class="el" href="options_8class_8php-source.html#l00038">parse()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>View/pf/lib/packetfilter/<a class="el" href="options_8class_8php-source.html">options.class.php</a></ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Dec 8 14:11:34 2009 for ComixWall ISG Administration Interface by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
